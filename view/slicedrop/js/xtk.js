/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/closure-library/LICENSE
 * 
 *  - the JSXCompressor library (http://jsxgraph.uni-bayreuth.de/wp/jsxcompressor/)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/JXG/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function j(a){throw a;}var k=void 0,p=!0,r=null,s=!1;function aa(){return function(){}}function ea(a){return function(b){this[a]=b}}function t(a){return function(){return this[a]}}var v,fa=this;function ha(){}
function ia(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ja(a){return a!==k}function A(a){return"array"==ia(a)}function ka(a){var b=ia(a);return"array"==b||"object"==b&&"number"==typeof a.length}function la(a){return"string"==typeof a}function D(a){return"number"==typeof a}function ma(a){return"function"==ia(a)}function oa(a){a=ia(a);return"object"==a||"array"==a||"function"==a}function pa(a){return a[qa]||(a[qa]=++ra)}
var qa="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),ra=0;function sa(a,b,c){return a.call.apply(a.bind,arguments)}function ta(a,b,c){a||j(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function ua(a,b,c){ua=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?sa:ta;return ua.apply(r,arguments)}function wa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var xa=Date.now||function(){return+new Date};
function E(a,b){var c=a.split("."),d=fa;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ja(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function G(a,b){function c(){}c.prototype=b.prototype;a.j=b.prototype;a.prototype=new c;a.prototype.constructor=a};function ya(a,b,c){this.Ea=this.Da=this.Ca=0;3==arguments.length?(this.Ca=Number(a),this.Da=Number(b),this.Ea=Number(c)):a instanceof ya?(this.Ca=Number(a.x()),this.Da=Number(a.y()),this.Ea=Number(a.b())):(this.Ca=Number(a[0]),this.Da=Number(a[1]),this.Ea=Number(a[2]))}ya.prototype={f:function(){return new ya(this.Ca,this.Da,this.Ea)},length:function(){return Math.sqrt(za(this,this))},x:t("Ca"),y:t("Da"),b:t("Ea")};
function Aa(a,b){return new ya(a.Da*b.b()-a.Ea*b.y(),a.Ea*b.x()-a.Ca*b.b(),a.Ca*b.y()-a.Da*b.x())}function Ba(a){var b=a.length();return new ya(a.Ca/b,a.Da/b,a.Ea/b)}function za(a,b){return a.Ca*b.x()+a.Da*b.y()+a.Ea*b.b()}function Ca(a,b){return new ya(a.Ca*b,a.Da*b,a.Ea*b)}function Da(a,b){return new ya(a.Ca-b.x(),a.Da-b.y(),a.Ea-b.b())}function Fa(a,b){return new ya(a.Ca+b.x(),a.Da+b.y(),a.Ea+b.b())}function Ga(a){return new ya(-a.Ca,-a.Da,-a.Ea)};var I=I||{};I.tj=p;I.La=function(a){eval("X.DEV === undefined")||window.console.time(a)};I.Fa=function(a){eval("X.DEV === undefined")||window.console.timeEnd(a)};window["X.counter"]=new function(){this.ah=0;this.oj=function(){return this.ah++}};function Ha(a,b){for(var c in b){var d=b.__lookupGetter__(c),e=b.__lookupSetter__(c);d||e?(d&&a.__defineGetter__(c,d),e&&a.__defineSetter__(c,e)):a[c]=b[c]}}var Ia=window.Sg;
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&j(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});
for(var Ja=0,Ka=["ms","moz","webkit","o"],La=0;La<Ka.length&&!window.requestAnimationFrame;++La)window.requestAnimationFrame=window[Ka[La]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[Ka[La]+"CancelAnimationFrame"]||window[Ka[La]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var b=Date.now(),c=Math.max(0,16-(b-Ja)),d=window.setTimeout(function(){a(b+c)},c);Ja=b+c;return d});
window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});
"slice"in ArrayBuffer.prototype||(ArrayBuffer.prototype.slice=function(a,b){a===k&&j(Error("Not enough arguments."));var c=b||this.byteLength;0>a&&(a=this.byteLength+a);0>c&&(c=this.byteLength+c);c<a&&(c=a=0);0>a&&(a=0);0>c&&(c=0);a>this.byteLength&&(a=this.byteLength);c>this.byteLength&&(c=this.byteLength);for(var d=new ArrayBuffer(c-a),e=new Uint8Array(this),f=new Uint8Array(d),g=a,h=0;g<c;++g,++h)f[h]=e[g];return d});E("$",Ia);E("Function.prototype.bind",Function.prototype.bind);
E("window.requestAnimationFrame",window.requestAnimationFrame);E("window.cancelAnimationFrame",window.cancelAnimationFrame);function Ma(a){if(!Na.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Oa,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Pa,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Qa,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ra,"&quot;"));return a}var Oa=/&/g,Pa=/</g,Qa=/>/g,Ra=/\"/g,Na=/[&<>\"]/;var Sa,Ta,Va,Xa,Ya,Za,$a;function ab(){return fa.navigator?fa.navigator.userAgent:r}function bb(){return fa.navigator}Ya=Xa=Va=Ta=Sa=s;var cb;if(cb=ab()){var db=bb();Sa=0==cb.indexOf("Opera");Ta=!Sa&&-1!=cb.indexOf("MSIE");Xa=(Va=!Sa&&-1!=cb.indexOf("WebKit"))&&-1!=cb.indexOf("Mobile");Ya=!Sa&&!Va&&"Gecko"==db.product}var eb=Sa,J=Ta,gb=Ya,hb=Va,ib=Xa,jb,kb=bb();jb=kb&&kb.platform||"";Za=-1!=jb.indexOf("Mac");$a=-1!=jb.indexOf("Win");var lb=!!bb()&&-1!=(bb().appVersion||"").indexOf("X11"),nb;
a:{var ob="",pb;if(eb&&fa.opera)var qb=fa.opera.version,ob="function"==typeof qb?qb():qb;else if(gb?pb=/rv\:([^\);]+)(\)|;)/:J?pb=/MSIE\s+([^\);]+)(\)|;)/:hb&&(pb=/WebKit\/(\S+)/),pb)var rb=pb.exec(ab()),ob=rb?rb[1]:"";if(J){var sb,tb=fa.document;sb=tb?tb.documentMode:k;if(sb>parseFloat(ob)){nb=String(sb);break a}}nb=ob}var ub={};
function vb(a){var b;if(!(b=ub[a])){b=0;for(var c=String(nb).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",m=RegExp("(\\d*)(\\D*)","g"),l=RegExp("(\\d*)(\\D*)","g");do{var n=m.exec(g)||["","",""],q=l.exec(h)||["","",""];if(0==n[0].length&&0==q[0].length)break;b=((0==n[1].length?0:parseInt(n[1],10))<(0==q[1].length?0:parseInt(q[1],10))?-1:(0==n[1].length?0:parseInt(n[1],
10))>(0==q[1].length?0:parseInt(q[1],10))?1:0)||((0==n[2].length)<(0==q[2].length)?-1:(0==n[2].length)>(0==q[2].length)?1:0)||(n[2]<q[2]?-1:n[2]>q[2]?1:0)}while(0==b)}b=ub[a]=0<=b}return b}var wb={};function xb(a){return wb[a]||(wb[a]=J&&document.documentMode&&document.documentMode>=a)};function yb(a,b){for(var c in a)b.call(k,a[c],c,a)}function zb(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function Ab(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}var Bb="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Cb(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Bb.length;f++)c=Bb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var Db=Array.prototype,Eb=Db.indexOf?function(a,b,c){return Db.indexOf.call(a,b,c)}:function(a,b,c){c=c==r?0:0>c?Math.max(0,a.length+c):c;if(la(a))return!la(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Fb=Db.forEach?function(a,b,c){Db.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=la(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Gb=Db.map?function(a,b,c){return Db.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
la(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Hb=Db.some?function(a,b,c){return Db.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=la(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return p;return s},Ib=Db.every?function(a,b,c){return Db.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=la(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return s;return p};function Jb(a,b){var c=Eb(a,b);0<=c&&Db.splice.call(a,c,1)}
function Kb(a){return Db.concat.apply(Db,arguments)}function Lb(a){if(A(a))return Kb(a);for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}function Mb(a,b,c){return 2>=arguments.length?Db.slice.call(a,b):Db.slice.call(a,b,c)};function Nb(a){if("function"==typeof a.ab)a=a.ab();else if(ka(a)||la(a))a=a.length;else{var b=0,c;for(c in a)b++;a=b}return a}function Ob(a){if("function"==typeof a.Sa)return a.Sa();if(la(a))return a.split("");if(ka(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return zb(a)}
function Pb(a,b){if("function"==typeof a.every)return a.every(b,k);if(ka(a)||la(a))return Ib(a,b,k);var c;if("function"==typeof a.Zc)c=a.Zc();else if("function"!=typeof a.Sa)if(ka(a)||la(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=Ab(a);else c=k;for(var d=Ob(a),e=d.length,f=0;f<e;f++)if(!b.call(k,d[f],c&&c[f],a))return s;return p};var Qb="StopIteration"in fa?fa.StopIteration:Error("StopIteration");function Rb(){}Rb.prototype.next=function(){j(Qb)};Rb.prototype.zc=function(){return this};function Sb(a){if(a instanceof Rb)return a;if("function"==typeof a.zc)return a.zc(s);if(ka(a)){var b=0,c=new Rb;c.next=function(){for(;;){b>=a.length&&j(Qb);if(b in a)return a[b++];b++}};return c}j(Error("Not implemented"))};function Tb(a,b){this.D={};this.v=[];var c=arguments.length;if(1<c){c%2&&j(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.xe(a)}v=Tb.prototype;v.N=0;v.hd=0;v.ab=t("N");v.Sa=function(){Ub(this);for(var a=[],b=0;b<this.v.length;b++)a.push(this.D[this.v[b]]);return a};v.Zc=function(){Ub(this);return this.v.concat()};v.Fe=function(a){for(var b=0;b<this.v.length;b++){var c=this.v[b];if(Wb(this.D,c)&&this.D[c]==a)return p}return s};
v.Vc=function(a,b){if(this===a)return p;if(this.N!=a.ab())return s;var c=b||Xb;Ub(this);for(var d,e=0;d=this.v[e];e++)if(!c(this.get(d),a.get(d)))return s;return p};function Xb(a,b){return a===b}v.clear=function(){this.D={};this.hd=this.N=this.v.length=0};v.remove=function(a){return Wb(this.D,a)?(delete this.D[a],this.N--,this.hd++,this.v.length>2*this.N&&Ub(this),p):s};
function Ub(a){if(a.N!=a.v.length){for(var b=0,c=0;b<a.v.length;){var d=a.v[b];Wb(a.D,d)&&(a.v[c++]=d);b++}a.v.length=c}if(a.N!=a.v.length){for(var e={},c=b=0;b<a.v.length;)d=a.v[b],Wb(e,d)||(a.v[c++]=d,e[d]=1),b++;a.v.length=c}}v.get=function(a,b){return Wb(this.D,a)?this.D[a]:b};v.set=function(a,b){Wb(this.D,a)||(this.N++,this.v.push(a),this.hd++);this.D[a]=b};v.xe=function(a){var b;a instanceof Tb?(b=a.Zc(),a=a.Sa()):(b=Ab(a),a=zb(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};v.f=function(){return new Tb(this)};
v.zc=function(a){Ub(this);var b=0,c=this.v,d=this.D,e=this.hd,f=this,g=new Rb;g.next=function(){for(;;){e!=f.hd&&j(Error("The map has changed since the iterator was created"));b>=c.length&&j(Qb);var g=c[b++];return a?g:d[g]}};return g};function Wb(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Yb(a){this.D=new Tb;a&&this.xe(a)}function Zb(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+pa(a):b.substr(0,1)+a}v=Yb.prototype;v.ab=function(){return this.D.ab()};v.add=function(a){this.D.set(Zb(a),a)};v.xe=function(a){a=Ob(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])};v.Vd=function(a){a=Ob(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};v.remove=function(a){return this.D.remove(Zb(a))};v.clear=function(){this.D.clear()};
v.contains=function(a){a=Zb(a);return Wb(this.D.D,a)};v.kg=function(a){var b=new Yb;a=Ob(a);for(var c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};v.Sa=function(){return this.D.Sa()};v.f=function(){return new Yb(this)};
v.Vc=function(a){var b;if(b=this.ab()==Nb(a)){var c=a;a=Nb(c);this.ab()>a?b=s:(!(c instanceof Yb)&&5<a&&(c=new Yb(c)),b=Pb(this,function(a){if("function"==typeof c.contains)a=c.contains(a);else if("function"==typeof c.Fe)a=c.Fe(a);else if(ka(c)||la(c))a=0<=Eb(c,a);else a:{for(var b in c)if(c[b]==a){a=p;break a}a=s}return a}))}return b};v.zc=function(){return this.D.zc(s)};function $b(){}$b.prototype.Wf=s;$b.prototype.Ra=function(){this.Wf||(this.Wf=p,this.O())};$b.prototype.O=function(){this.vh&&ac.apply(r,this.vh)};function bc(a){a&&"function"==typeof a.Ra&&a.Ra()}function ac(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];ka(d)?ac.apply(r,d):bc(d)}};function cc(a,b){this.qg=b;this.Yc=[];a>this.qg&&j(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.Yc.push(this.Fd())}G(cc,$b);v=cc.prototype;v.Sf=r;v.Vf=r;function dc(a,b){a.Yc.length<a.qg?a.Yc.push(b):a.Ke(b)}v.Fd=function(){return this.Sf?this.Sf():{}};v.Ke=function(a){if(this.Vf)this.Vf(a);else if(oa(a))if(ma(a.Ra))a.Ra();else for(var b in a)delete a[b]};v.O=function(){cc.j.O.call(this);for(var a=this.Yc;a.length;)this.Ke(a.pop());delete this.Yc};function ec(){this.Wc=[];this.af=new Tb;this.Lg=this.Mg=this.Ng=this.Ig=0;this.gd=new Tb;this.Of=this.Kg=0;this.We=1;this.Le=new cc(0,4E3);this.Le.Fd=function(){return new fc};this.Jg=new cc(0,50);this.Jg.Fd=function(){return new gc};var a=this;this.Oe=new cc(0,2E3);this.Oe.Fd=function(){return String(a.We++)};this.Oe.Ke=aa();this.uh=3}function gc(){this.of=this.time=this.count=0}
gc.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");this.of&&a.push(" [VarAlloc = ",this.of,"]");return a.join("")};function fc(){}function hc(a,b,c,d){var e=[];-1==c?e.push("    "):e.push(ic(a.Xf-c));e.push(" ",jc(a.Xf-b));0==a.Me?e.push(" Start        "):1==a.Me?(e.push(" Done "),e.push(ic(a.sk-a.startTime)," ms ")):e.push(" Comment      ");e.push(d,a);0<a.kj&&e.push("[VarAlloc ",a.kj,"] ");return e.join("")}
fc.prototype.toString=function(){return this.type==r?this.comment:"["+this.type+"] "+this.comment};ec.prototype.reset=function(a){this.uh=a;for(a=0;a<this.Wc.length;a++){var b=this.Le.id;b&&dc(this.Oe,b);dc(this.Le,this.Wc[a])}this.Wc.length=0;this.af.clear();this.Ig=xa();this.Of=this.Kg=this.Lg=this.Mg=this.Ng=0;b=this.gd.Zc();for(a=0;a<b.length;a++){var c=this.gd.get(b[a]);c.count=0;c.time=0;c.of=0;dc(this.Jg,c)}this.gd.clear()};
ec.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.Wc.length;d++){var e=this.Wc[d];1==e.Me&&c.pop();a.push(" ",hc(e,this.Ig,b,c.join("")));b=e.Xf;a.push("\n");0==e.Me&&c.push("|  ")}if(0!=this.af.ab()){var f=xa();a.push(" Unstopped timers:\n");d=this.af;b=function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",jc(b.startTime),")\n")};if(ka(d))try{Fb(d,b,k)}catch(g){g!==Qb&&j(g)}else{d=Sb(d);try{for(;;)b.call(k,d.next())}catch(h){h!==Qb&&j(h)}}}b=this.gd.Zc();for(d=0;d<b.length;d++)c=
this.gd.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",this.Kg,"\n","Total comments created ",this.Of,"\n","Overhead start: ",this.Ng," ms\n","Overhead end: ",this.Mg," ms\n","Overhead comment: ",this.Lg," ms\n");return a.join("")};function ic(a){a=Math.round(a);var b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function jc(a){a=Math.round(a);return String(100+a/1E3%60).substring(1,3)+"."+String(1E3+a%1E3).substring(1,4)}new ec;function kc(){}var lc=0;v=kc.prototype;v.key=0;v.wc=s;v.De=s;v.ia=function(a,b,c,d,e,f){ma(a)?this.lg=p:a&&a.handleEvent&&ma(a.handleEvent)?this.lg=s:j(Error("Invalid listener argument"));this.ad=a;this.Fg=b;this.src=c;this.type=d;this.capture=!!e;this.Ne=f;this.De=s;this.key=++lc;this.wc=s};v.handleEvent=function(a){return this.lg?this.ad.call(this.Ne||this.src,a):this.ad.handleEvent.call(this.ad,a)};!J||xb(9);var mc=!J||xb(9),nc=J&&!vb("8");!hb||vb("528");gb&&vb("1.9b")||J&&vb("8")||eb&&vb("9.5")||hb&&vb("528");!gb||vb("8");function oc(a,b){this.type=a;this.currentTarget=this.target=b}G(oc,$b);v=oc.prototype;v.O=function(){delete this.type;delete this.target;delete this.currentTarget};v.gc=s;v.ed=p;v.stopPropagation=function(){this.gc=p};v.preventDefault=function(){this.ed=s};function pc(a){pc[" "](a);return a}pc[" "]=ha;function qc(a,b){a&&this.ia(a,b)}G(qc,oc);v=qc.prototype;v.target=r;v.relatedTarget=r;v.offsetX=0;v.offsetY=0;v.clientX=0;v.clientY=0;v.screenX=0;v.screenY=0;v.button=0;v.keyCode=0;v.charCode=0;v.ctrlKey=s;v.altKey=s;v.shiftKey=s;v.metaKey=s;v.Ei=s;v.Ha=r;
v.ia=function(a,b){var c=this.type=a.type;oc.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(gb){var e;a:{try{pc(d.nodeName);e=p;break a}catch(f){}e=s}e||(d=r)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=hb||a.offsetX!==k?a.offsetX:a.layerX;this.offsetY=hb||a.offsetY!==k?a.offsetY:a.layerY;this.clientX=a.clientX!==k?a.clientX:a.pageX;this.clientY=a.clientY!==k?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.Ei=Za?a.metaKey:a.ctrlKey;this.state=a.state;this.Ha=a;delete this.ed;delete this.gc};v.stopPropagation=function(){qc.j.stopPropagation.call(this);this.Ha.stopPropagation?this.Ha.stopPropagation():this.Ha.cancelBubble=p};
v.preventDefault=function(){qc.j.preventDefault.call(this);var a=this.Ha;if(a.preventDefault)a.preventDefault();else if(a.returnValue=s,nc)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};v.Hh=t("Ha");v.O=function(){qc.j.O.call(this);this.relatedTarget=this.currentTarget=this.target=this.Ha=r};var rc={},sc={},tc={},uc={};
function K(a,b,c,d,e){if(b){if(A(b)){for(var f=0;f<b.length;f++)K(a,b[f],c,d,e);return r}d=!!d;var g=sc;b in g||(g[b]={N:0,Ja:0});g=g[b];d in g||(g[d]={N:0,Ja:0},g.N++);var g=g[d],h=pa(a),m;g.Ja++;if(g[h]){m=g[h];for(f=0;f<m.length;f++)if(g=m[f],g.ad==c&&g.Ne==e){if(g.wc)break;return m[f].key}}else m=g[h]=[],g.N++;var l=vc,n=mc?function(a){return l.call(n.src,n.key,a)}:function(a){a=l.call(n.src,n.key,a);if(!a)return a},f=n;f.src=a;g=new kc;g.ia(c,f,a,b,d,e);c=g.key;f.key=c;m.push(g);rc[c]=g;tc[h]||
(tc[h]=[]);tc[h].push(g);a.addEventListener?(a==fa||!a.Uf)&&a.addEventListener(b,f,d):a.attachEvent(b in uc?uc[b]:uc[b]="on"+b,f);return c}j(Error("Invalid event type"))}function wc(a,b,c,d,e){if(A(b))for(var f=0;f<b.length;f++)wc(a,b[f],c,d,e);else a=K(a,b,c,d,e),rc[a].De=p}
function xc(a,b,c,d,e){if(A(b))for(var f=0;f<b.length;f++)xc(a,b[f],c,d,e);else{d=!!d;a:{f=sc;if(b in f&&(f=f[b],d in f&&(f=f[d],a=pa(a),f[a]))){a=f[a];break a}a=r}if(a)for(f=0;f<a.length;f++)if(a[f].ad==c&&a[f].capture==d&&a[f].Ne==e){yc(a[f].key);break}}}
function yc(a){if(!rc[a])return s;var b=rc[a];if(b.wc)return s;var c=b.src,d=b.type,e=b.Fg,f=b.capture;c.removeEventListener?(c==fa||!c.Uf)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in uc?uc[d]:uc[d]="on"+d,e);c=pa(c);e=sc[d][f][c];if(tc[c]){var g=tc[c];Jb(g,b);0==g.length&&delete tc[c]}b.wc=p;e.ug=p;zc(d,f,c,e);delete rc[a];return p}
function zc(a,b,c,d){if(!d.Rd&&d.ug){for(var e=0,f=0;e<d.length;e++)d[e].wc?d[e].Fg.src=r:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.ug=s;0==f&&(delete sc[a][b][c],sc[a][b].N--,0==sc[a][b].N&&(delete sc[a][b],sc[a].N--),0==sc[a].N&&delete sc[a])}}function Ac(a,b,c,d,e){var f=1;b=pa(b);if(a[b]){a.Ja--;a=a[b];a.Rd?a.Rd++:a.Rd=1;try{for(var g=a.length,h=0;h<g;h++){var m=a[h];m&&!m.wc&&(f&=Bc(m,e)!==s)}}finally{a.Rd--,zc(c,d,b,a)}}return Boolean(f)}
function Bc(a,b){var c=a.handleEvent(b);a.De&&yc(a.key);return c}
function vc(a,b){if(!rc[a])return p;var c=rc[a],d=c.type,e=sc;if(!(d in e))return p;var e=e[d],f,g;if(!mc){var h;if(!(h=b))a:{h=["window","event"];for(var m=fa;f=h.shift();)if(m[f]!=r)m=m[f];else{h=r;break a}h=m}f=h;h=p in e;m=s in e;if(h){if(0>f.keyCode||f.returnValue!=k)return p;a:{var l=s;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(n){l=p}if(l||f.returnValue==k)f.returnValue=p}}l=new qc;l.ia(f,this);f=p;try{if(h){for(var q=[],w=l.currentTarget;w;w=w.parentNode)q.push(w);g=e[p];g.Ja=g.N;for(var u=
q.length-1;!l.gc&&0<=u&&g.Ja;u--)l.currentTarget=q[u],f&=Ac(g,q[u],d,p,l);if(m){g=e[s];g.Ja=g.N;for(u=0;!l.gc&&u<q.length&&g.Ja;u++)l.currentTarget=q[u],f&=Ac(g,q[u],d,s,l)}}else f=Bc(c,l)}finally{q&&(q.length=0),l.Ra()}return f}d=new qc(b,this);try{f=Bc(c,d)}finally{d.Ra()}return f}var Cc=0;function Dc(a){return a+"_"+Cc++};function Ec(){}G(Ec,$b);v=Ec.prototype;v.Uf=p;v.Td=r;v.df=ea("Td");v.addEventListener=function(a,b,c,d){K(this,a,b,c,d)};v.removeEventListener=function(a,b,c,d){xc(this,a,b,c,d)};
v.dispatchEvent=function(a){var b=a.type||a,c=sc;if(b in c){if(la(a))a=new oc(a,this);else if(a instanceof oc)a.target=a.target||this;else{var d=a;a=new oc(b,this);Cb(a,d)}var d=1,e,c=c[b],b=p in c,f;if(b){e=[];for(f=this;f;f=f.Td)e.push(f);f=c[p];f.Ja=f.N;for(var g=e.length-1;!a.gc&&0<=g&&f.Ja;g--)a.currentTarget=e[g],d&=Ac(f,e[g],a.type,p,a)&&a.ed!=s}if(s in c)if(f=c[s],f.Ja=f.N,b)for(g=0;!a.gc&&g<e.length&&f.Ja;g++)a.currentTarget=e[g],d&=Ac(f,e[g],a.type,s,a)&&a.ed!=s;else for(e=this;!a.gc&&e&&
f.Ja;e=e.Td)a.currentTarget=e,d&=Ac(f,e,a.type,s,a)&&a.ed!=s;a=Boolean(d)}else a=p;return a};v.O=function(){Ec.j.O.call(this);var a,b=0,c=a==r;a=!!a;if(this==r)yb(tc,function(d){for(var e=d.length-1;0<=e;e--){var f=d[e];if(c||a==f.capture)yc(f.key),b++}});else{var d=pa(this);if(tc[d])for(var d=tc[d],e=d.length-1;0<=e;e--){var f=d[e];if(c||a==f.capture)yc(f.key),b++}}this.Td=r};function L(){this.c="base";this.ua=window["X.counter"].oj();this.e=s}G(L,Ec);L.prototype.__defineGetter__("classname",t("c"));L.prototype.__defineGetter__("id",t("ua"));E("X.base",L);function Fc(a,b){this.sa=new ya(a);this.ba=new ya(b)}Fc.prototype={f:function(){return new Fc(this.sa.f(),this.ba.f())},dc:function(){this.ba=Ga(this.ba)}};function Gc(a,b){this.ba=a;this.jd=b}Gc.prototype={f:function(){return new Gc(this.ba.f(),this.jd)},dc:function(){this.ba=Ga(this.ba);this.jd=-this.jd}};function Hc(a,b){this.ob=a;this.Zd=b;var c=a[0].sa,d=a[2].sa,d=Ba(Aa(Da(a[1].sa,c),Da(d,c)));this.Ba=new Gc(d,za(d,c))}Hc.prototype={f:function(){var a=this.ob.map(function(a){return a.f()});return new Hc(a,this.Zd)},dc:function(){this.ob.reverse().map(function(a){a.dc()});this.Ba.dc()}};
function Ic(a,b,c,d,e,f){for(var g=0,h=[],m=0;m<a.ob.length;m++){var l=za(b.ba,a.ob[m].sa)-b.jd,l=-1E-5>l?2:1E-5<l?1:0,g=g|l;h.push(l)}switch(g){case 0:(0<za(b.ba,a.Ba.ba)?c:d).push(a);break;case 1:e.push(a);break;case 2:f.push(a);break;case 3:c=[];d=[];for(m=0;m<a.ob.length;m++){var n=(m+1)%a.ob.length,l=h[m],q=h[n],g=a.ob[m],n=a.ob[n];2!=l&&c.push(g);1!=l&&d.push(2!=l?g.f():g);3==(l|q)&&(l=(b.jd-za(b.ba,g.sa))/za(b.ba,Da(n.sa,g.sa)),l=new Fc(Fa(g.sa,Ca(Da(n.sa,g.sa),l)),Fa(g.ba,Ca(Da(n.ba,g.ba),
l))),c.push(l),d.push(l.f()))}3<=c.length&&e.push(new Hc(c,a.Zd));3<=d.length&&f.push(new Hc(d,a.Zd))}};function Jc(a){this.ga=this.ha=this.Ba=r;this.z=[];a&&Kc(this,a)}Jc.prototype={f:function(){var a=new Jc,b=this.Ba&&this.Ba.f();a.Ba=b;b=this.ha&&this.ha.f();a.ha=b;b=this.ga&&this.ga.f();a.ga=b;a.Xd(this.z.map(function(a){return a.f()}));return a},aa:function(){for(var a=0;a<this.z.length;a++)this.z[a].dc();this.Ba.dc();this.ha&&this.ha.aa();this.ga&&this.ga.aa();a=this.ha;this.ha=this.ga;this.ga=a},Xd:ea("z")};
function Kc(a,b){if(b.length){a.Ba||(a.Ba=b[0].Ba.f());for(var c=[],d=[],e=0;e<b.length;e++)Ic(b[e],a.Ba,a.z,a.z,c,d);c.length&&(a.ha||(a.ha=new Jc),Kc(a.ha,c));d.length&&(a.ga||(a.ga=new Jc),Kc(a.ga,d))}}function Lc(a){var b=a.z.slice();a.ha&&(b=b.concat(Lc(a.ha)));a.ga&&(b=b.concat(Lc(a.ga)));return b}function Mc(a,b){a.z=Nc(b,a.z);a.ha&&Mc(a.ha,b);a.ga&&Mc(a.ga,b)}
function Nc(a,b){if(!a.Ba)return b.slice();for(var c=[],d=[],e=0;e<b.length;e++)Ic(b[e],a.Ba,c,d,c,d);a.ha&&(c=Nc(a.ha,c));d=a.ga?Nc(a.ga,d):[];return c.concat(d)};function Oc(){this.z=[]}function Pc(a){var b=new Oc;b.Xd(a);return b}
Oc.prototype={f:function(){var a=new Oc;a.Xd(this.z.map(function(a){return a.f()}));return a},mf:function(a){var b=new Jc(this.f().z);a=new Jc(a.f().z);Mc(b,a);Mc(a,b);a.aa();Mc(a,b);a.aa();Kc(b,Lc(a));return Pc(Lc(b))},Wa:function(a){var b=new Jc(this.f().z);a=new Jc(a.f().z);b.aa();Mc(b,a);Mc(a,b);a.aa();Mc(a,b);a.aa();Kc(b,Lc(a));b.aa();return Pc(Lc(b))},Qe:function(a){var b=new Jc(this.f().z);a=new Jc(a.f().z);b.aa();Mc(a,b);a.aa();Mc(b,a);Mc(a,b);Kc(b,Lc(a));b.aa();return Pc(Lc(b))},inverse:function(){var a=
this.f();a.z.map(function(a){a.dc()});return a},Xd:ea("z")};function Qc(){L.call(this);this.c="indexer";this.ve=[];this.gk=[];this.wb={}}G(Qc,L);Qc.prototype.add=function(a){a==r&&j(Error("Invalid object."));var b=window.JSON.stringify(a);b in this.wb||(this.wb[b]=this.ve.length,this.ve.push(a));return this.wb[b]};Qc.prototype.unique=t("ve");function Rc(a){L.call(this);this.c="file";this.td=a;this.e=p}G(Rc,L);function Sc(){this.Lb=this.p=r}Sc.prototype.__defineSetter__("file",function(a){this.p=a==r||A(a)&&0==a.length?r:A(a)?1==a.length?new Rc(a[0]):Gb(a,function(a){var c=new M;c.p=new Rc(a);return c}):new Rc(a)});Sc.prototype.__defineGetter__("file",function(){return!this.p?"":A(this.p)?this.p.map(function(a){return a.p.td}):this.p.td});Sc.prototype.__defineGetter__("filedata",t("Lb"));
Sc.prototype.__defineSetter__("filedata",function(a){if(a==r||A(a)&&0==a.length)this.Lb=r;if(A(a))if(1==a.length)this.Lb=a[0];else{var b=this.p.length,c;for(c=0;c<b;c++)this.p[c].Lb=a[c]}else this.Lb=a});function Tc(){L.call(this);this.c="colortable";this.wb=new Tb;Ha(this,new Sc)}G(Tc,L);Tc.prototype.add=function(a,b,c,d,e,f){(!D(a)||!D(c)||!D(d)||!D(e)||!D(f))&&j(Error("Invalid color table entry."));this.wb.set(a,[b,c,d,e,f]);this.e=p};function Uc(a,b,c){this.x=ja(a)?a:0;this.y=ja(b)?b:0;this.b=ja(c)?c:0}Uc.prototype.f=function(){return new Uc(this.x,this.y,this.b)};Uc.prototype.kf=function(){return[this.x,this.y,this.b]};function N(a,b,c){this.x=a;this.y=b;this.b=c}G(N,Uc);v=N.prototype;v.f=function(){return new N(this.x,this.y,this.b)};v.fc=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.b*this.b)};v.scale=function(a){this.x*=a;this.y*=a;this.b*=a;return this};v.aa=function(){this.x=-this.x;this.y=-this.y;this.b=-this.b;return this};v.normalize=function(){return this.scale(1/this.fc())};v.add=function(a){this.x+=a.x;this.y+=a.y;this.b+=a.b;return this};
v.Wa=function(a){this.x-=a.x;this.y-=a.y;this.b-=a.b;return this};v.Vc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y&&this.b==a.b};function Vc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.b-b.b;return Math.sqrt(c*c+d*d+e*e)}function Wc(a,b){return new N(a.x+b.x,a.y+b.y,a.b+b.b)}function Xc(a,b){return new N(a.y*b.b-a.b*b.y,a.b*b.x-a.x*b.b,a.x*b.y-a.y*b.x)};function Yc(a,b){this.x=ja(a)?a:0;this.y=ja(b)?b:0}Yc.prototype.f=function(){return new Yc(this.x,this.y)};function Zc(a,b){return new Yc(a.x-b.x,a.y-b.y)};function $c(a,b){this.x=a;this.y=b}G($c,Yc);v=$c.prototype;v.f=function(){return new $c(this.x,this.y)};v.fc=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};v.scale=function(a){this.x*=a;this.y*=a;return this};v.aa=function(){this.x=-this.x;this.y=-this.y;return this};v.normalize=function(){return this.scale(1/this.fc())};v.add=function(a){this.x+=a.x;this.y+=a.y;return this};v.Wa=function(a){this.x-=a.x;this.y-=a.y;return this};
v.rotate=function(a){var b=Math.cos(a);a=Math.sin(a);var c=this.y*b+this.x*a;this.x=this.x*b-this.y*a;this.y=c;return this};v.Vc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y};function ad(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d};function bd(a,b){this.width=a;this.height=b}function cd(a,b){return a==b?p:!a||!b?s:a.width==b.width&&a.height==b.height}bd.prototype.f=function(){return new bd(this.width,this.height)};bd.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};bd.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};bd.prototype.scale=function(a){this.width*=a;this.height*=a;return this};function dd(a,b){if(a instanceof dd)this.X=a.kf();else{var c;if(c=ka(a))a:{for(var d=c=0;d<a.length;d++){if(!ka(a[d])||0<c&&a[d].length!=c){c=s;break a}for(var e=0;e<a[d].length;e++)if(!D(a[d][e])){c=s;break a}0==c&&(c=a[d].length)}c=0!=c}c?this.X=Lb(a):a instanceof bd?this.X=ed(a.height,a.width):D(a)&&D(b)&&0<a&&0<b?this.X=ed(a,b):j(Error("Invalid argument(s) for Matrix contructor"))}this.F=new bd(this.X[0].length,this.X.length)}
function fd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new dd(b)}function gd(a,b,c){for(var d=0;d<a.za().height;d++)for(var e=0;e<a.za().width;e++)b.call(c,a.X[d][e],d,e,a)}function hd(a,b){var c=new dd(a.za());gd(a,function(d,e,f){c.X[e][f]=b.call(k,d,e,f,a)});return c}function ed(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var e=0;e<b;e++)c[d][e]=0}return c}v=dd.prototype;
v.add=function(a){cd(this.F,a.za())||j(Error("Matrix summation is only supported on arrays of equal size"));return hd(this,function(b,c,d){return b+a.X[c][d]})};v.Vc=function(a,b){if(this.F.width!=a.F.width||this.F.height!=a.F.height)return s;for(var c=b||0,d=0;d<this.F.height;d++)for(var e=0;e<this.F.width;e++)if(!(Math.abs(this.X[d][e]-a.X[d][e])<=(c||1E-6)))return s;return p};v.za=t("F");v.Y=function(a,b){return!(0<=a&&a<this.F.height&&0<=b&&b<this.F.width)?r:this.X[a][b]};
v.k=function(a,b,c){0<=a&&a<this.F.height&&0<=b&&b<this.F.width||j(Error("Index out of bounds when setting matrix value, ("+a+","+b+") in size ("+this.F.height+","+this.F.width+")"));this.X[a][b]=c};
v.multiply=function(a){if(a instanceof dd){this.F.width!=a.za().height&&j(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns."));var b=new dd(this.F.height,a.za().width);gd(b,function(c,d,e){for(var f=c=0;f<this.F.width;f++)c+=this.Y(d,f)*a.Y(f,e);b.k(d,e,c)},this);return b}if(D(a))return hd(this,function(b){return b*a});j(Error("A matrix can only be multiplied by a number or another matrix."))};
v.Wa=function(a){cd(this.F,a.za())||j(Error("Matrix subtraction is only supported on arrays of equal size."));return hd(this,function(b,c,d){return b-a.X[c][d]})};v.kf=t("X");function id(a,b){dd.call(this,a,b);this.c="matrix"}G(id,dd);function jd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new id(b)}v=id.prototype;v.Ia=function(){var a=[],b=this.za(),c,d;for(d=0;d<b.height;d++)for(c=0;c<b.width;c++)a.push(this.Y(c,d));return a};
v.translate=function(a){this.F.width!=this.F.height&&j(Error("Can not translate non-square matrix."));var b=this.za(),c=fd(b.height);a instanceof $c&&3==b.height?(c.k(0,2,a.x),c.k(1,2,a.y)):a instanceof N&&4==b.height?(c.k(0,3,a.x),c.k(1,3,a.y),c.k(2,3,a.b)):j(Error("Translation failed."));return new id(this.multiply(c))};
v.rotate=function(a,b){(4!=this.za().height||this.F.width!=this.F.height)&&j(Error("Only 4x4 matrices can be rotated."));(b==r||!(b instanceof N))&&j(Error("Invalid axis vector."));D(a)||j(Error("Invalid angle."));var c=b.normalize(),d=Math.cos(a),e=Math.sin(a),f=fd(4);f.k(0,0,d+c.x*c.x*(1-d));f.k(0,1,c.x*c.y*(1-d)-c.b*e);f.k(0,2,c.x*c.b*(1-d)+c.y*e);f.k(1,0,c.y*c.x*(1-d)+c.b*e);f.k(1,1,d+c.y*c.y*(1-d));f.k(1,2,c.y*c.b*(1-d)-c.x*e);f.k(2,0,c.b*c.x*(1-d)-c.y*e);f.k(2,1,c.b*c.y*(1-d)+c.x*e);f.k(2,2,
d+c.b*c.b*(1-d));return new id(this.multiply(f))};v.Ua=function(a){var b=this.za(),c=Array(b.width),d;for(d=0;d<c.length;d++)c[d]=Array(1),c[d][0]=1;a instanceof N&&3<=b.width?(c[0][0]=a.x,c[1][0]=a.y,c[2][0]=a.b):j(Error("Multiplication by vector failed."));a=new dd(c);a=this.multiply(a);return new N(parseFloat(a.Y(0,0)),parseFloat(a.Y(1,0)),parseFloat(a.Y(2,0)))};v.ij=function(a,b){var c=this.X[a];this.X[a]=this.X[b];this.X[b]=c};
v.hj=function(a,b){for(var c=this.za(),d=0,d=0;d<c.height;d++){var e=this.Y(d,a);e||(e=0);var f=this.Y(d,b);f||(f=0);this.k(d,a,f);this.k(d,b,e)}};E("X.matrix",id);E("X.matrix.createIdentityMatrix",jd);E("X.matrix.prototype.flatten",id.prototype.Ia);E("X.matrix.prototype.translate",id.prototype.translate);E("X.matrix.prototype.rotate",id.prototype.rotate);E("X.matrix.prototype.toArray",id.prototype.kf);E("X.matrix.prototype.getValueAt",id.prototype.Y);E("X.matrix.prototype.setValueAt",id.prototype.k);
E("X.matrix.prototype.multiplyByVector",id.prototype.Ua);E("X.matrix.prototype.swapRows",id.prototype.ij);E("X.matrix.prototype.swapCols",id.prototype.hj);function kd(){L.call(this);this.c="transform";this.C=jd(4);this.wf=new Float32Array(this.C.Ia())}G(kd,L);kd.prototype.__defineGetter__("matrix",t("C"));kd.prototype.__defineSetter__("matrix",function(a){(a==r||!(a instanceof id))&&j(Error("Invalid matrix."));this.C=a;this.o()});v=kd.prototype;v.Ri=function(a){(!D(a)||-360>a||360<a)&&j(Error("Invalid angle."));this.C=this.C.rotate(a*Math.PI/180,new N(0,1,0));this.o()};
v.Si=function(a){(!D(a)||-360>a||360<a)&&j(Error("Invalid angle."));this.C=this.C.rotate(a*Math.PI/180,new N(1,0,0));this.o()};v.Ti=function(a){(!D(a)||-360>a||360<a)&&j(Error("Invalid angle."));this.C=this.C.rotate(a*Math.PI/180,new N(0,0,1));this.o()};v.lj=function(a){D(a)||j(Error("Invalid distance."));this.C=this.C.translate(new N(a,0,0));this.o()};v.mj=function(a){D(a)||j(Error("Invalid distance."));this.C=this.C.translate(new N(0,a,0));this.o()};
v.nj=function(a){D(a)||j(Error("Invalid distance."));this.C=this.C.translate(new N(0,0,a));this.o()};function ld(a,b,c){var d=a.C.Y(b,c);d||(d=0);a.C.k(b,c,-1*d);a.o()}v.Dh=function(){ld(this,0,0)};v.Eh=function(){ld(this,1,1)};v.Fh=function(){ld(this,2,2)};v.o=function(){this.wf=new Float32Array(this.C.Ia());this.e=p};E("X.transform",kd);E("X.transform.prototype.rotateX",kd.prototype.Ri);E("X.transform.prototype.rotateY",kd.prototype.Si);E("X.transform.prototype.rotateZ",kd.prototype.Ti);
E("X.transform.prototype.translateX",kd.prototype.lj);E("X.transform.prototype.translateY",kd.prototype.mj);E("X.transform.prototype.translateZ",kd.prototype.nj);E("X.transform.prototype.flipX",kd.prototype.Dh);E("X.transform.prototype.flipY",kd.prototype.Eh);E("X.transform.prototype.flipZ",kd.prototype.Fh);E("X.transform.prototype.modified",kd.prototype.o);function md(){L.call(this);this.c="texture";this.xa=this.qb=this.p=r;this.Db=this.Eb=0;Ha(this,new Sc)}G(md,L);E("X.texture",md);function P(a,b){L.call(this);this.c="triplets";this.Sb=Infinity;this.Pb=-Infinity;this.Tb=Infinity;this.Qb=-Infinity;this.Ub=Infinity;this.Rb=-Infinity;this.kd=[0,0,0];this.vf=p;this.A=0;this.L=new Float32Array(a);b!=r&&(this.L=b.L.subarray(0,b.L.length),this.A=this.L.length,this.Sb=b.Sb,this.Pb=b.Pb,this.Tb=b.Tb,this.Qb=b.Qb,this.Ub=b.Ub,this.Rb=b.Rb,this.kd=b.kd.slice(),this.vf=s)}G(P,L);v=P.prototype;
v.add=function(a,b,c){this.Sb=Math.min(this.Sb,a);this.Pb=Math.max(this.Pb,a);this.Tb=Math.min(this.Tb,b);this.Qb=Math.max(this.Qb,b);this.Ub=Math.min(this.Ub,c);this.Rb=Math.max(this.Rb,c);this.kd=[(this.Sb+this.Pb)/2,(this.Tb+this.Qb)/2,(this.Ub+this.Rb)/2];this.vf=s;this.e=p;this.L[this.A++]=a;this.L[this.A++]=b;this.L[this.A++]=c;return this.A/3};v.mb=function(){if(this.A!=this.L.length){var a=new Float32Array(this.A);a.set(this.L.subarray(0,this.A));this.L=a}};
v.get=function(a){a*=3;return[this.L[a],this.L[a+1],this.L[a+2]]};v.remove=function(){j(Error("Not implemented."))};v.clear=function(){this.L=new Float32Array(this.L.length);this.e=p};P.prototype.__defineGetter__("count",function(){this.mb();return this.L.length/3});P.prototype.__defineGetter__("length",function(){this.mb();return this.L.length});E("X.triplets",P);E("X.triplets.prototype.add",P.prototype.add);E("X.triplets.prototype.resize",P.prototype.mb);E("X.triplets.prototype.get",P.prototype.get);
E("X.triplets.prototype.remove",P.prototype.remove);E("X.triplets.prototype.clear",P.prototype.clear);function nd(){this.ma=od;this.$b=new kd;this.Jb=[1,1,1];this.Zb=this.w=this.Z=this.h=this.g=r;this.pc=[];this.Oa=p;this.oc=this.Mc=1;this.kc=r;this.Fc=s;this.$=1;this.K=0}var od="TRIANGLES";nd.prototype.__defineSetter__("type",function(a){return this.ma=a});nd.prototype.__defineGetter__("type",t("ma"));nd.prototype.__defineGetter__("texture",function(){this.w||(this.w=new md);return this.w});nd.prototype.__defineGetter__("transform",t("$b"));nd.prototype.__defineGetter__("points",t("g"));
nd.prototype.__defineSetter__("points",ea("g"));nd.prototype.__defineGetter__("normals",t("h"));nd.prototype.__defineSetter__("normals",ea("h"));nd.prototype.__defineGetter__("colors",t("Z"));nd.prototype.__defineSetter__("colors",ea("Z"));nd.prototype.__defineGetter__("color",t("Jb"));nd.prototype.__defineSetter__("color",function(a){(a==r||!A(a)||3!=a.length)&&j(Error("Invalid color."));for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].color=a;this.Jb=a;this.e=p});
nd.prototype.__defineGetter__("opacity",t("$"));nd.prototype.__defineSetter__("opacity",function(a){(!D(a)||1<a||0>a)&&j(Error("Invalid opacity."));for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].opacity=a;this.$=a;this.e=p});nd.prototype.__defineGetter__("caption",t("kc"));nd.prototype.__defineSetter__("caption",function(a){this.kc=a;this.e=p});nd.prototype.__defineGetter__("visible",t("Oa"));
nd.prototype.__defineSetter__("visible",function(a){for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].visible=a;this.Oa=a;this.e=p});nd.prototype.__defineGetter__("pointsize",t("Mc"));nd.prototype.__defineSetter__("pointsize",function(a){D(a)||j(Error("Invalid point size."));this.Mc=a;this.e=p});nd.prototype.__defineGetter__("magicmode",t("Fc"));nd.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&j(Error("Invalid magic mode setting."));this.Fc=a;this.e=p});
nd.prototype.__defineGetter__("linewidth",t("oc"));nd.prototype.__defineSetter__("linewidth",function(a){D(a)||j(Error("Invalid line width."));this.oc=a;this.e=p});function pd(){this.Na=Infinity;this.R=this.Ga=-Infinity;this.U=Infinity;this.zb=[0,0,0];this.xb=[1,1,1]}pd.prototype.__defineGetter__("lowerThreshold",t("R"));pd.prototype.__defineSetter__("lowerThreshold",ea("R"));pd.prototype.__defineGetter__("upperThreshold",t("U"));pd.prototype.__defineSetter__("upperThreshold",ea("U"));pd.prototype.__defineGetter__("min",t("Na"));pd.prototype.__defineGetter__("max",t("Ga"));pd.prototype.__defineGetter__("minColor",t("zb"));
pd.prototype.__defineSetter__("minColor",function(a){(a==r||!A(a)||3!=a.length)&&j(Error("Invalid min. color."));this.zb=a});pd.prototype.__defineGetter__("maxColor",t("xb"));pd.prototype.__defineSetter__("maxColor",function(a){(a==r||!A(a)||3!=a.length)&&j(Error("Invalid max. color."));this.xb=a});function qd(){L.call(this);this.c="scalars";this.Ac=this.u=r;this.Hf=p;this.de=0;Ha(this,new Sc);Ha(this,new pd);this.zb=[0,1,0];this.xb=[1,0,0]}G(qd,L);qd.prototype.__defineGetter__("array",t("u"));qd.prototype.__defineSetter__("array",function(a){this.Ac=this.u=a;this.e=p});qd.prototype.__defineGetter__("interpolation",t("de"));qd.prototype.__defineSetter__("interpolation",ea("de"));E("X.scalars",qd);function T(a){L.call(this);this.c="object";this.d=[];this.t=this.ca=r;Ha(this,new nd);a!=r&&this.ac(a)}G(T,L);
T.prototype.ac=function(a){this.ma=a.ma;this.$b=new kd;this.$b.C=new id(a.$b.C.X);this.Jb=a.Jb.slice();a.g&&(this.g=new P(a.g.length,a.g));a.h&&(this.h=new P(a.h.length,a.h));a.Z&&(this.Z=new P(a.Z.length,a.Z));this.w=a.w;this.Zb=a.Zb;a.p&&(this.p=new Rc((new String(a.p.td)).toString()));this.$=a.$;this.d.length=0;var b=a.d;if(b)for(var c=b.length,d=0,d=0;d<c;d++)this.d.push(new I[b[d].c](b[d]));this.Oa=a.Oa;this.Mc=a.Mc;this.oc=a.oc;a.kc&&(this.kc=(new String(a.kc)).toString());this.Fc=a.Fc;this.pc=
a.pc.slice();this.e=p};T.prototype.__defineGetter__("colortable",function(){this.ca||(this.ca=new Tc);return this.ca});T.prototype.__defineGetter__("scalars",function(){this.t||(this.t=new qd);return this.t});T.prototype.__defineGetter__("children",t("d"));T.prototype.o=function(){var a=new rd;a.fa=this;this.dispatchEvent(a)};
function sd(a,b){(a==r||b==r||!(a instanceof T)||!(b instanceof T))&&j(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.$?-1:1==b.$?1:a.K!=r&&b.K!=r&&a.K>b.K?-1:1}E("X.object",T);E("X.object.prototype.modified",T.prototype.o);function td(){}function ud(a){for(var b=a.g.count,c=[],d=0,d=0;d<b;d+=3){var e=a.g.get(d),f=a.g.get(d+1),g=a.g.get(d+2),h=a.h.get(d),m=a.h.get(d+1),l=a.h.get(d+2),n=a.Jb;a.Z&&0<a.Z.length&&(n=a.Z.get(d));var q=[];q.push(new Fc(e,h));q.push(new Fc(f,m));q.push(new Fc(g,l));c.push(new Hc(q,n))}return Pc(c)}
function vd(a,b){(b==r||!(b instanceof Oc))&&j(Error("Invalid CSG object."));var c=new Qc,d=[];Gb(b.z,function(a){var b=[],g=a.Zd,b=Gb(a.ob,function(a){a.color=g;return c.add(a)});for(a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.$g=Gb(c.unique(),function(a){return[a.sa.x(),a.sa.y(),a.sa.b()]});a.Zg=Gb(c.unique(),function(a){return[a.ba.x(),a.ba.y(),a.ba.b()]});a.Yg=Gb(c.unique(),function(a){return!a.color?r:[a.color[0],a.color[1],a.color[2]]});a.g=new P(9*d.length);a.h=new P(9*d.length);
a.Z=new P(9*d.length);Gb(d,function(a){var b=a[0],c=a[1];a=a[2];var d=this.$g,m=this.Zg,l=this.Yg;this.g.add(d[b][0],d[b][1],d[b][2]);this.g.add(d[c][0],d[c][1],d[c][2]);this.g.add(d[a][0],d[a][1],d[a][2]);this.h.add(m[b][0],m[b][1],m[b][2]);this.h.add(m[c][0],m[c][1],m[c][2]);this.h.add(m[a][0],m[a][1],m[a][2]);l[b]&&this.Z.add(l[b][0],l[b][1],l[b][2]);l[c]&&this.Z.add(l[c][0],l[c][1],l[c][2]);l[a]&&this.Z.add(l[a][0],l[a][1],l[a][2])}.bind(a));0==a.Z.A&&(a.Z=r);a.ma=od}
td.prototype.mf=function(a){(a==r||!(a instanceof Oc)&&!(a instanceof T))&&j(Error("Invalid object."));var b=a;a instanceof T&&(b=ud(b));a=new T;Ha(a,new td);vd(a,ud(this).mf(b));return a};td.prototype.Wa=function(a){(a==r||!(a instanceof Oc)&&!(a instanceof T))&&j(Error("Invalid object."));var b=a;a instanceof T&&(b=ud(b));a=new T;Ha(a,new td);vd(a,ud(this).Wa(b));return a};
td.prototype.Qe=function(a){(a==r||!(a instanceof Oc)&&!(a instanceof T))&&j(Error("Invalid object."));var b=a;a instanceof T&&(b=ud(b));a=new T;Ha(a,new td);vd(a,ud(this).Qe(b));return a};td.prototype.inverse=function(){var a=new T;Ha(a,new td);vd(a,ud(this).inverse());return a};E("X.constructable",td);E("X.constructable.prototype.intersect",td.prototype.Qe);E("X.constructable.prototype.inverse",td.prototype.inverse);E("X.constructable.prototype.subtract",td.prototype.Wa);
E("X.constructable.prototype.union",td.prototype.mf);function wd(a){oc.call(this,a);this.c="event"}G(wd,oc);var xd=Dc("pan"),yd=Dc("rotate"),zd=Dc("zoom"),Ad=Dc("scroll");Dc("render");var Bd=Dc("resetview"),Cd=Dc("windowlevel"),Dd=Dc("modified"),Ed=Dc("progress"),Fd=Dc("hover"),Gd=Dc("hover_end");function Hd(){wd.call(this,Cd);this.je=this.we=0}G(Hd,wd);function Id(){wd.call(this,xd);this.K=new $c(0,0)}G(Id,wd);function Jd(){wd.call(this,yd);this.K=new $c(0,0)}G(Jd,wd);function Kd(){wd.call(this,zd);this.Ma=this.Za=s}G(Kd,wd);
function Ld(){wd.call(this,Ad);this.J=s}G(Ld,wd);function Md(){wd.call(this,Fd);this.Cd=this.Bd=0}G(Md,wd);function Nd(){wd.call(this,Gd)}G(Nd,wd);function Od(){wd.call(this,Bd)}G(Od,wd);function rd(){wd.call(this,Dd);this.s=this.fa=r}G(rd,wd);function Pd(){wd.call(this,Ed);this.Jf=0}G(Pd,wd);function U(){L.call(this);this.c="parser";this.da=r;this.A=0;this.dh=0<(new Int8Array((new Int16Array([1])).buffer))[0];this.pd=p;this.ik=-Infinity;this.hk=Infinity}G(U,L);U.prototype.parse=function(){j(Error("The function parse() should be overloaded."))};function Qd(a){for(var b=Infinity,c=-Infinity,d=a.length,e=0,e=0;e<d;e++)var f=a[e],b=Math.min(b,f),c=Math.max(c,f);return[b,c]}
function Rd(a,b,c){b===k&&(b=0);c===k&&(c=a.length);for(var d="",e=0,e=b;e<c;++e)d+=String.fromCharCode(a[e]);return d}
function W(a,b,c){c!=r||(c=1);var d=1,e=Uint8Array;switch(b){case "schar":e=Int8Array;break;case "ushort":e=Uint16Array;d=2;break;case "sshort":e=Int16Array;d=2;break;case "uint":e=Uint32Array;d=4;break;case "sint":e=Int32Array;d=4;break;case "float":e=Float32Array,d=4}b=new e(a.da.slice(a.A,a.A+=c*d));if(a.dh!=a.pd){a=b;b=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);for(e=0;e<a.byteLength;e+=d)for(var f=e+d-1,g=e;f>g;f--,g++){var h=b[g];b[g]=b[f];b[f]=h}b=a}return 1==c?b[0]:b}
function Sd(a,b,c){I.La(a.c+".reslice");var d=b.ea,e=c.max,f=c.data,g=d[2],h=d[1],d=d[0],m=b.n!=r,l=h*d,n=Array(g),q=Array(g),w=0,u=r;b.ca&&(u=b.ca.wb);for(var x=0,z=0,C=0,F=0,y=4*l,x=0;x<g;x++){n[x]=Array(h);q[x]=Array(h);for(var B=f.subarray(x*l,(x+1)*l),H=new Uint8Array(y),z=F=0;z<h;z++){n[x][z]=new c.data.constructor(d);q[x][z]=new c.data.constructor(d);for(C=0;C<d;C++){var w=B[F],O=0,ba=0,Q=0,R=0;u?(R=u.get(Math.floor(w)),R||(O=u.Sa(),R=O[O.length-1]),O=255*R[1],ba=255*R[2],Q=255*R[3],R=255*
R[4]):(O=ba=Q=255*(w/e),R=255);var ga=4*F;H[ga]=O;H[++ga]=ba;H[++ga]=Q;H[++ga]=R;n[x][z][C]=255*(w/e);q[x][z][C]=w;F++}}w=new md;w.xa=H;w.Eb=d;w.Db=h;B=b.ib.d[x];B.w=w;m&&(B.n=b.n.ib.d[x].w)}b.pe&&(d!=h?m?b.ca?(Td(g,d,h,q,b.ca,b.T,b.n.T,p),Td(g,h,d,q,b.ca,b.S,b.n.S,s)):(Ud(g,d,h,n,b.T,b.n.T,p),Ud(g,h,d,n,b.S,b.n.S,s)):b.ca?(Td(g,d,h,q,b.ca,b.T,r,p),Td(g,h,d,q,b.ca,b.S,r,s)):(Ud(g,d,h,n,b.T,r,p),Ud(g,h,d,n,b.S,r,s)):m?b.ca?Vd(g,d,h,n,b.ca,b.S,b.n.S,b.T,b.n.T):Wd(g,d,h,n,b.S,b.n.S,b.T,b.n.T):b.ca?Vd(g,
d,h,q,b.ca,b.S,r,b.T,r):Wd(g,d,h,n,b.S,r,b.T,r));I.Fa(a.c+".reslice");return q}function Ud(a,b,c,d,e,f,g){for(var h=4*a*b,m=0,m=0;m<c;m++){for(var l=new Uint8Array(h),n=0,q=0,n=0;n<a;n++)for(var w=0,u=d[n],w=0;w<b;w++){var x,z=x=g?u[m][w]:u[w][m],C=x,F=4*q;l[F]=x;l[++F]=z;l[++F]=C;l[++F]=255;q++}n=new md;n.xa=l;n.Eb=b;n.Db=a;l=e.d[m];l.w=n;f&&(l.n=f.d[m].w)}}
function Td(a,b,c,d,e,f,g,h){e=e.wb;for(var m=4*a*b,l=0,l=0;l<c;l++){for(var n=new Uint8Array(m),q=0,w=0,q=0;q<a;q++)for(var u=d[q],x=0,x=0;x<b;x++){var z=e.get(Math.floor(h?u[l][x]:u[x][l]));z||(z=e.Sa(),z=z[z.length-1]);var C=255*z[2],F=255*z[3],y=255*z[4],B=4*w;n[B]=255*z[1];n[++B]=C;n[++B]=F;n[++B]=y;w++}q=new md;q.xa=n;q.Eb=b;q.Db=a;n=f.d[l];n.w=q;g&&(n.n=g.d[l].w)}}
function Wd(a,b,c,d,e,f,g,h){for(var m=4*a*b,l=0,l=0;l<c;l++){for(var n=new Uint8Array(m),q=new Uint8Array(m),w=0,u=0,u=0;u<a;u++)for(var x=d[u],z=0,z=0;z<b;z++){var C=x[z][l],F=C,y=C,B=4*w;n[B]=C;n[++B]=F;n[++B]=y;n[++B]=255;y=F=C=B=x[l][z];B=4*w;q[B]=C;q[++B]=F;q[++B]=y;q[++B]=255;w++}w=new md;w.xa=n;w.Eb=b;w.Db=a;n=e.d[l];n.w=w;f&&(n.n=f.d[l].w);n=new md;n.xa=q;n.Eb=b;n.Db=a;q=g.d[l];q.w=n;h&&(q.n=h.d[l].w)}}
function Vd(a,b,c,d,e,f,g,h,m){e=e.wb;for(var l=4*a*b,n=0,n=0;n<c;n++){for(var q=new Uint8Array(l),w=new Uint8Array(l),u=0,x=0,x=0;x<a;x++)for(var z=d[x],C=0,C=0;C<b;C++){var F=e.get(Math.floor(z[C][n]));if(!F)var y=e.Sa(),F=y[y.length-1];var B=255*F[2],H=255*F[3],O=255*F[4],y=4*u;q[y]=255*F[1];q[++y]=B;q[++y]=H;q[++y]=O;y=e.get(Math.floor(z[n][C]));y||(y=e.Sa(),y=y[y.length-1]);F=255*y[1];B=255*y[2];H=255*y[3];O=255*y[4];y=4*u;w[y]=F;w[++y]=B;w[++y]=H;w[++y]=O;u++}u=new md;u.xa=q;u.Eb=b;u.Db=a;q=
f.d[n];q.w=u;g&&(q.n=g.d[n].w);q=new md;q.xa=w;q.Eb=b;q.Db=a;w=h.d[n];w.w=q;m&&(w.n=m.d[n].w)}};function Xd(){U.call(this);this.c="parserLBL"}G(Xd,U);
Xd.prototype.parse=function(a,b,c){I.La(this.c+".parse");var d=b.pc,e=d.length;0==e&&j(Error("No _pointIndices defined on the X.object."));this.da=c;var f=[],g=W(this,"uchar",c.byteLength),h=g.length,m=s,l=0;for(c=1;c<h;c++)10==g[c-1]?(l=c,m=p):m&&32==g[c]&&(f.push(parseInt(Rd(g,l,c),10)),m=s);g=b.t.u?b.t.u:new Float32Array(e);h=f.length;for(c=0;c<h;c++)g[f[c]]=1;f=new Float32Array(3*e);for(c=h=0;c<e;c++)m=d[c],m>e&&j(Error("Could not find scalar for vertex.")),m=g[m],f[h++]=m,f[h++]=m,f[h++]=m;b.t.u=
g;b.t.Ac=f;b.t.e=p;I.Fa(this.c+".parse");d=new rd;d.fa=b;d.s=a;this.dispatchEvent(d)};E("X.parserLBL",Xd);E("X.parserLBL.prototype.parse",Xd.prototype.parse);function Yd(a){this.q=a;this.pg=K(this.q,gb?"DOMMouseScroll":"mousewheel",this)}G(Yd,Ec);
Yd.prototype.handleEvent=function(a){var b=0,c=0,d=0;a=a.Ha;if("mousewheel"==a.type){c=1;if(J||hb&&($a||vb("532.0")))c=40;d=hb&&Za&&0!=-a.wheelDelta%c?-a.wheelDelta:-a.wheelDelta/c;ja(a.wheelDeltaX)?(b=hb&&Za&&0!=-a.wheelDeltaX%c?-a.wheelDeltaX:-a.wheelDeltaX/c,c=hb&&Za&&0!=-a.wheelDeltaY%c?-a.wheelDeltaY:-a.wheelDeltaY/c):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ja(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;D(this.rg)&&(b=Math.min(Math.max(b,-this.rg),this.rg));D(this.sg)&&(c=Math.min(Math.max(c,
-this.sg),this.sg));b=new Zd(d,a,b,c);try{this.dispatchEvent(b)}finally{b.Ra()}};Yd.prototype.O=function(){Yd.j.O.call(this);yc(this.pg);delete this.pg};function Zd(a,b,c,d){b&&this.ia(b,k);this.type="mousewheel";this.detail=a;this.kk=c;this.sc=d}G(Zd,qc);J||hb&&vb("525");var $d;function ae(a,b){var c;c=(c=a.className)&&"function"==typeof c.split?c.split(/\s+/):[];var d=Mb(arguments,1),e;e=c;for(var f=0,g=0;g<d.length;g++)0<=Eb(e,d[g])||(e.push(d[g]),f++);e=f==d.length;a.className=c.join(" ");return e};var be=!J||xb(9);!gb&&!J||J&&xb(9)||gb&&vb("1.9.1");J&&vb("9");function ce(a){return a?new de(ee(a)):$d||($d=new de)}function fe(a){return la(a)?document.getElementById(a):a}var ge={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};function he(a,b,c){return ie(document,arguments)}
function ie(a,b){var c=b[0],d=b[1];if(!be&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',Ma(d.name),'"');if(d.type){c.push(' type="',Ma(d.type),'"');var e={};Cb(e,d);d=e;delete d.type}c.push(">");c=c.join("")}var f=a.createElement(c);d&&(la(d)?f.className=d:A(d)?ae.apply(r,[f].concat(d)):yb(d,function(a,b){"style"==b?f.style.cssText=a:"class"==b?f.className=a:"for"==b?f.htmlFor=a:b in ge?f.setAttribute(ge[b],a):0==b.lastIndexOf("aria-",0)?f.setAttribute(b,a):f[b]=a}));if(2<b.length){d=function(b){b&&
f.appendChild(la(b)?a.createTextNode(b):b)};for(c=2;c<b.length;c++)if(e=b[c],ka(e)&&!(oa(e)&&0<e.nodeType)){var g=Fb,h;a:{if((h=e)&&"number"==typeof h.length){if(oa(h)){h="function"==typeof h.item||"string"==typeof h.item;break a}if(ma(h)){h="function"==typeof h.item;break a}}h=s}g(h?Lb(e):e,d)}else d(e)}return f}function je(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function ke(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}
function le(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function ee(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function de(a){this.P=a||fa.document||document}v=de.prototype;v.Jd=ce;v.i=function(a){return la(a)?this.P.getElementById(a):a};v.Sg=de.prototype.i;v.qc=function(a,b,c){return ie(this.P,arguments)};v.createElement=function(a){return this.P.createElement(a)};
v.createTextNode=function(a){return this.P.createTextNode(a)};function me(a){return"CSS1Compat"==a.P.compatMode}function ne(a){var b=a.P;a=!hb&&"CSS1Compat"==b.compatMode?b.documentElement:b.body;b=b.parentWindow||b.defaultView;return new Yc(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}v.appendChild=function(a,b){a.appendChild(b)};v.contains=le;function Y(a){(a==r||!(a instanceof Element))&&j(Error("Could not add interactor to the given element."));L.call(this);this.c="interactor";this.ta=a;this.le=this.Af=this.zf=this.Bf=this.yf=this.Cf=r;this.ke=p;this.Fb=this.yb=this.gb=s;this.sd=[0,0];this.fe=new $c(0,0);this.Ec=new $c(0,0);this.mg=0;this.If=this.od=r;this.G={MOUSEWHEEL_ENABLED:p,MOUSECLICKS_ENABLED:p,KEYBOARD_ENABLED:p,HOVERING_ENABLED:p,CONTEXTMENU_ENABLED:s,TOUCH_ENABLED:p,TOUCH_BOUNCING_ENABLED:s}}G(Y,L);
Y.prototype.__defineGetter__("config",t("G"));Y.prototype.__defineGetter__("leftButtonDown",t("gb"));Y.prototype.__defineGetter__("middleButtonDown",t("yb"));Y.prototype.__defineGetter__("rightButtonDown",t("Fb"));
Y.prototype.ia=function(){this.G.MOUSEWHEEL_ENABLED?(this.le=new Yd(this.ta),this.Cf=K(this.le,"mousewheel",this.cd.bind(this))):(yc(this.Cf),this.le=r);this.G.MOUSECLICKS_ENABLED?(this.yf=K(this.ta,"mousedown",this.gi.bind(this)),this.Bf=K(this.ta,"mouseup",this.li.bind(this))):(yc(this.yf),yc(this.Bf));this.ta.oncontextmenu=this.G.CONTEXTMENU_ENABLED?r:function(){return s};window.onkeydown=this.G.KEYBOARD_ENABLED?this.xg.bind(this):r;this.G.TOUCH_ENABLED?(this.G.TOUCH_BOUNCING_ENABLED||document.body.addEventListener("touchmove",
function(a){a.preventDefault()},s),this.hh=K(this.ta,"touchstart",this.zi.bind(this)),this.gh=K(this.ta,"touchmove",this.xi.bind(this)),this.fh=K(this.ta,"touchend",this.ti.bind(this))):(yc(this.hh),yc(this.gh),yc(this.fh));yc(this.zf);yc(this.Af);this.zf=K(this.ta,"mousemove",this.ii.bind(this));this.Af=K(this.ta,"mouseout",this.ji.bind(this))};
Y.prototype.gi=function(a){0==a.button?this.gb=p:1==a.button?this.yb=p:2==a.button&&(this.Fb=p);eval("this.onMouseDown("+this.gb+","+this.yb+","+this.Fb+")");oe(this);a.preventDefault()};Y.prototype.fi=aa();Y.prototype.li=function(a){0==a.button?this.gb=s:1==a.button?this.yb=s:2==a.button&&(this.Fb=s);eval("this.onMouseUp("+this.gb+","+this.yb+","+this.Fb+")");oe(this);a.preventDefault()};Y.prototype.__defineGetter__("mousePosition",t("sd"));v=Y.prototype;v.ki=aa();
v.ji=function(a){this.ke=s;this.G.KEYBOARD_ENABLED&&(window.onkeydown=r);this.Fb=this.yb=this.gb=s;oe(this);this.fe=new $c(0,0);a.preventDefault()};v.hi=aa();v.zi=function(a){a.preventDefault();a.ia(a.Ha.targetTouches[0],a.currentTarget);eval("this.onTouchStart("+a.clientX+","+a.clientY+")");this.Ec=new $c(a.clientX,a.clientY);this.If=setTimeout(this.vi.bind(this,a),500)};v.yi=aa();
v.vi=function(a){eval("this.onTouchHover("+a.clientX+","+a.clientY+")");a=new Kd;a.Za=p;a.Ma=this instanceof pe;this.dispatchEvent(a);this.yd=p};v.ui=aa();function qe(a){clearTimeout(a.If);if(a.yd){var b=new Kd;b.Za=s;b.Ma=a instanceof pe;a.dispatchEvent(b)}a.yd=s}v.ti=function(a){a.preventDefault();eval("this.onTouchEnd()");qe(this)};v.si=aa();
v.xi=function(a){a.preventDefault();this.yd||qe(this);this.touchmoveEvent=a=a.Ha;eval("this.onTouchMove(this['touchmoveEvent'])");var b=a.targetTouches;if(1==b.length){a=b[0];var c=[a.clientX,a.clientY];a=new $c(c[0],c[1]);var b=c[0]>3*this.ta.clientWidth/4,d=c[0]<this.ta.clientWidth/4,e=c[1]<this.ta.clientHeight/4,c=c[1]>3*this.ta.clientHeight/4,c=!b&&!d&&!e&&!c,e=this.Ec.Wa(a);this.Ec=a.f();if(this.yd)a=new Id,5<e.x?e.x=1:-5>e.x&&(e.x=-1),5<e.y?e.y=1:-5>e.y&&(e.y=-1),a.K=e,this.dispatchEvent(a);
else if(this instanceof re&&(b||d))a=new Ld,a.J=0>e.y,this.dispatchEvent(a);else if(this instanceof pe||c)e.scale(3),a=new Jd,a.K=e,this.dispatchEvent(a)}else 2==b.length&&(a=b[0],b=b[1],a=[a.clientX,a.clientY],b=[b.clientX,b.clientY],a=new $c(a[0],a[1]),e=ad(a,new $c(b[0],b[1])),b=e-this.mg,this.mg=e,this.Ec.Wa(a),this.Ec=a.f(),10<Math.abs(b)&&(a=new Kd,a.Za=0<b,a.Ma=this instanceof pe,this.dispatchEvent(a)))};v.wi=aa();
v.ii=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.ke=p;this.G.KEYBOARD_ENABLED&&window.onkeydown==r&&(window.onkeydown=this.xg.bind(this));a.preventDefault();var b=a.shiftKey;this.sd=[a.offsetX,a.offsetY];var c=new $c(this.sd[0],this.sd[1]);a=this.fe.Wa(c);this.fe=c.f();this.G.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.yb||this.gb||this.Fb)&&oe(this),this.od=setTimeout(function(){oe(this);var a=new Md;a.Bd=c.x;a.Cd=c.y;this.dispatchEvent(a);
this.od=r}.bind(this),300));2>Math.abs(a.x)&&(a.x=0);2>Math.abs(a.y)&&(a.y=0);0!=a.fc()&&(this.gb&&!b?(b=new Jd,a.scale(3),b.K=a,this.dispatchEvent(b)):this.yb||this.gb&&b?(b=new Id,5<a.x?a.x=5:-5>a.x&&(a.x=-5),5<a.y?a.y=5:-5>a.y&&(a.y=-5),b.K=a,this.dispatchEvent(b)):this.Fb&&(b=new Kd,b.Za=0<a.y,b.Ma=s,this.dispatchEvent(b)))};function oe(a){a.od&&clearTimeout(a.od);var b=new Nd;a.dispatchEvent(b)}v.mi=aa();
v.cd=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");oe(this);a.preventDefault()};v.di=aa();
v.xg=function(a){if(this.ke){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");oe(this);var b=a.altKey,c=a.ctrlKey,d=a.metaKey,e=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!d&&!e?(a.preventDefault(),a=new Od,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),e?a=new Id:b?a=new Kd:(a=new Jd,this instanceof re&&(a=new Ld)),a&&(c=new $c(0,0),37==f?(c.x=5,a.J=s,b&&(a.J=p,a.Za=p,a.Ma=s)):39==f?(c.x=-5,a.J=p,b&&(a.Za=s,a.Ma=s)):38==f?(c.y=5,a.J=p,b&&(a.Za=p,a.Ma=p)):40==f&&(c.y=-5,a.J=s,b&&(a.Za=s,
a.Ma=p)),a.K=c,this.dispatchEvent(a)))}};E("X.interactor",Y);E("X.interactor.prototype.init",Y.prototype.ia);E("X.interactor.prototype.onMouseDown",Y.prototype.fi);E("X.interactor.prototype.onMouseUp",Y.prototype.ki);E("X.interactor.prototype.onMouseMove",Y.prototype.hi);E("X.interactor.prototype.onMouseWheel",Y.prototype.mi);E("X.interactor.prototype.onKey",Y.prototype.di);E("X.interactor.prototype.onTouchStart",Y.prototype.yi);E("X.interactor.prototype.onTouchMove",Y.prototype.wi);
E("X.interactor.prototype.onTouchEnd",Y.prototype.si);E("X.interactor.prototype.onTouchHover",Y.prototype.ui);function re(a){Y.call(this,a);this.c="interactor2D"}G(re,Y);re.prototype.cd=function(a){re.j.cd.call(this,a);var b=new Ld;a.sc==r&&(a.sc=0);b.J=0>a.sc;this.dispatchEvent(b)};function se(a){T.call(this);this.c="slice";this.l=[0,0,0];this.mc=[0,0,1];this.J=[0,1,0];this.H=this.M=10;this.Zb=[0,1,0,0,1,1,1,1,1,0,0,0];this.n=this.kb=r;this.Ya=p;this.jc=[1,1,1];a!=r&&this.ac(a)}G(se,T);se.prototype.ac=function(a){this.l=a.l.slice();this.mc=a.mc.slice();this.J=a.J.slice();this.M=a.M;this.H=a.H;this.kb=a.kb;this.n=a.n;this.Ya=a.Ya;this.jc=a.jc;this.bh=a.bh;se.j.ac.call(this,a)};
se.prototype.rc=function(){var a=new N(this.mc[0],this.mc[1],this.mc[2]),b=new N(this.J[0],this.J[1],this.J[2]),c=Xc(b,a),d=new N(this.l[0],this.l[1],this.l[2]),e=new N(1,1,1);1==a.x?(e=new N(this.l[0],this.H/2,this.M/2),this.Zb=[0,0,1,0,0,1,0,1,1,1,1,0]):1==a.y?(e=new N(this.M/2,this.l[1],this.H/2),this.Zb=[0,0,0,1,1,0,1,0,1,1,0,1]):1==a.b&&(e=new N(this.M/2,this.H/2,this.l[2]));var f=Wc(c.f().aa(),b.f().aa()),f=new N(f.x*e.x,f.y*e.y,f.b*e.b);f.add(d);var g=Wc(c.f().aa(),b),g=new N(g.x*e.x,g.y*e.y,
g.b*e.b);g.add(d);var h=Wc(c,b.f().aa()),h=new N(h.x*e.x,h.y*e.y,h.b*e.b);h.add(d);var m=h,b=Wc(c,b),b=new N(b.x*e.x,b.y*e.y,b.b*e.b);b.add(d);d=g;this.g=new P(18);this.h=new P(18);this.g.add(f.x,f.y,f.b);this.g.add(g.x,g.y,g.b);this.g.add(h.x,h.y,h.b);this.g.add(m.x,m.y,m.b);this.g.add(b.x,b.y,b.b);this.g.add(d.x,d.y,d.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.Ya&&(a=new T,a.g=new P(24),
a.h=new P(24),a.g.add(f.x,f.y,f.b),a.g.add(g.x,g.y,g.b),a.g.add(g.x,g.y,g.b),a.g.add(b.x,b.y,b.b),a.g.add(b.x,b.y,b.b),a.g.add(h.x,h.y,h.b),a.g.add(h.x,h.y,h.b),a.g.add(f.x,f.y,f.b),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.Jb=[this.jc[0],this.jc[1],this.jc[2]],a.ma="LINES",a.oc=2,this.d.push(a))};E("X.slice",se);function M(a){T.call(this);this.c="volume";this.l=[0,0,0];this.ea=[10,10,10];this.I=[1,1,1];this.qb=[];this.Dc=this.tb=this.Cc=this.sb=this.Bc=this.rb=0;this.S=new T;this.T=new T;this.ib=new T;this.Ad=this.Pa=s;this.Gb=0;this.n=r;this.Ya=p;this.W=Infinity;this.V=-Infinity;this.pe=p;Ha(this,new Sc);Ha(this,new pd);a!=r&&this.ac(a)}G(M,T);
M.prototype.ac=function(a){window.console.log(a);this.l=a.l.slice();this.ea=a.ea.slice();this.I=a.I.slice();this.rb=a.rb;this.Bc=a.Bc;this.sb=a.sb;this.Cc=a.Cc;this.tb=a.tb;this.Dc=a.Dc;this.S=new T(a.S);this.T=new T(a.T);this.ib=new T(a.ib);this.Pa=a.Pa;this.Ad=a.Ad;this.Gb=a.Gb;this.n=a.n;this.Ya=a.Ya;M.j.ac.call(this,a)};
M.prototype.rc=function(){this.d.length=0;this.S.d.length=0;this.T.d.length=0;this.ib.d.length=0;this.d.push(this.S);this.d.push(this.T);this.d.push(this.ib);for(var a=0,a=0;3>a;a++){for(var b=(this.ea[a]-1)/2,c=b,d=0,d=0;d<this.ea[a];d++){var e=-b*this.I[a]+d*this.I[a],f=[[this.l[0]+e,this.l[1],this.l[2]],[this.l[0],this.l[1]+e,this.l[2]],[this.l[0],this.l[1],this.l[2]+e]],e=this.d[a].d,g=0,h=0,m=[1,1,1],l=this.Ya;0==a?(g=this.ea[2]*this.I[2]-this.I[2],h=this.ea[1]*this.I[1]-this.I[1],m=[1,1,0]):
1==a?(g=this.ea[0]*this.I[0]-this.I[0],h=this.ea[2]*this.I[2]-this.I[2],m=[1,0,0]):2==a&&(g=this.ea[0]*this.I[0]-this.I[0],h=this.ea[1]*this.I[1]-this.I[1],m=[0,1,0]);this.kb!=r&&(l=s);var n=new se,q=n,f=f[a],w=[[1,0,0],[0,1,0],[0,0,1]][a],u=[[0,1,0],[0,0,-1],[0,1,0]][a];(f==r||!A(f)||3!=f.length)&&j(Error("Invalid center."));(w==r||!A(w)||3!=w.length)&&j(Error("Invalid front direction."));(u==r||!A(u)||3!=u.length)&&j(Error("Invalid up direction."));D(g)||j(Error("Invalid width."));D(h)||j(Error("Invalid height."));
var x=s;l!=r&&(x=l);l=[1,1,1];m!=r&&(l=m);q.l=f;q.mc=w;q.J=u;q.M=g;q.H=h;q.Ya=x;q.jc=l;q.rc();n.kb=this;n.visible=d==Math.floor(c);e.push(n)}0==a?this.Bc=this.rb=c:1==a?this.Cc=this.sb=c:2==a&&(this.Dc=this.tb=c)}this.e=p};
M.prototype.o=function(a){a="undefined"!==typeof a?a:p;if(0<this.d.length)if(this.Pa!=this.Ad&&(this.Pa?(this.d[0].d[parseInt(this.rb,10)].visible=s,this.d[1].d[parseInt(this.sb,10)].visible=s,this.d[2].d[parseInt(this.tb,10)].visible=s):this.d[this.Gb].visible=s,this.e=p,this.Ad=this.Pa),this.Pa)te(this,this.Gb);else for(var b=0,b=0;3>b;b++){var c=this.d[b],d=0,e=0;0==b?(d=this.rb,e=this.Bc,this.Bc=this.rb):1==b?(d=this.sb,e=this.Cc,this.Cc=this.sb):2==b&&(d=this.tb,e=this.Dc,this.Dc=this.tb);c.d[parseInt(e,
10)].visible=s;c=c.d[parseInt(d,10)];c.visible=p;c.$=1}a&&M.j.o.call(this)};M.prototype.__defineGetter__("dimensions",t("ea"));M.prototype.__defineGetter__("volumeRendering",t("Pa"));M.prototype.__defineSetter__("volumeRendering",function(a){this.Pa=a;this.o(s)});M.prototype.__defineSetter__("visible",ea("Oa"));M.prototype.__defineGetter__("center",t("l"));M.prototype.__defineSetter__("center",function(a){(a==r||!A(a)||3!=a.length)&&j(Error("Invalid center."));this.l=a});
M.prototype.__defineGetter__("image",t("qb"));M.prototype.__defineGetter__("labelmap",function(){this.n||(this.n=new ue(this));return this.n});M.prototype.__defineGetter__("indexX",t("rb"));M.prototype.__defineSetter__("indexX",function(a){D(a)&&(0<=a&&a<this.S.d.length)&&(this.rb=a,this.o(s))});M.prototype.__defineGetter__("indexY",t("sb"));M.prototype.__defineSetter__("indexY",function(a){D(a)&&(0<=a&&a<this.T.d.length)&&(this.sb=a,this.o(s))});M.prototype.__defineGetter__("indexZ",t("tb"));
M.prototype.__defineSetter__("indexZ",function(a){D(a)&&(0<=a&&a<this.ib.d.length)&&(this.tb=a,this.o(s))});M.prototype.__defineGetter__("windowLow",t("W"));M.prototype.__defineSetter__("windowLow",ea("W"));M.prototype.__defineGetter__("windowHigh",t("V"));M.prototype.__defineSetter__("windowHigh",ea("V"));M.prototype.__defineGetter__("borders",t("Ya"));M.prototype.__defineSetter__("borders",ea("Ya"));M.prototype.__defineGetter__("reslicing",t("pe"));M.prototype.__defineSetter__("reslicing",ea("pe"));
function te(a,b){if(a.Pa&&(a.e||b!=a.Gb)){var c=a.d[a.Gb];c.visible=s;var c=a.d[b],d=c.d.length,e;for(e=0;e<d;e++)c.d[e].Oa=p;a.Gb=b;a.e=s}}E("X.volume",M);E("X.volume.prototype.modified",M.prototype.o);function ve(){U.call(this);this.c="parserSTL"}G(ve,U);
ve.prototype.parse=function(a,b,c){I.La(this.c+".parse");this.da=c;var d=b.g,e=b.h;if("solid"==Rd(W(this,"uchar",5))){b.g=d=new P(c.byteLength);b.h=e=new P(c.byteLength);var f=d,d=e,e=W(this,"uchar",c.byteLength-5);c=e.length;var g=s,h=s,m=0,l;for(l=0;l<c;l++)if(10==e[l]){if(g||h){var n=Rd(e,m,l).split(" "),h=parseFloat(n[0]),q=parseFloat(n[1]),n=parseFloat(n[2]);g?(d.add(h,q,n),d.add(h,q,n),d.add(h,q,n)):f.add(h,q,n);h=g=s}}else 32==e[l-1]&&(102==e[l]?(m=l+=13,g=p):118==e[l]&&(m=l+=7,h=p))}else{this.A=
80;f=W(this,"uint");b.g=d=new P(9*f);b.h=e=new P(9*f);for(c=c=0;c<f;c++)g=W(this,"float",12),m=g[0],l=g[1],h=g[2],e.add(m,l,h),e.add(m,l,h),e.add(m,l,h),d.add(g[3],g[4],g[5]),d.add(g[6],g[7],g[8]),d.add(g[9],g[10],g[11]),this.A+=2}I.Fa(this.c+".parse");f=new rd;f.fa=b;f.s=a;this.dispatchEvent(f)};E("X.parserSTL",ve);E("X.parserSTL.prototype.parse",ve.prototype.parse);function we(){U.call(this);this.c="parserDCM"}G(we,U);we.prototype.parse=function(a,b,c){c=this.dd(c,b);if(c.Qd==c.bb){var d=c.gf.length,e,f=0;for(e=0;e<d;e++){var g=c.gf[e];g!==k&&(g*=c.fb,c.data.set(c.Tc.subarray(g,g+c.fb),f*c.fb),f++)}b.ea=[c.ya[0],c.ya[1],c.ya[2]];Infinity==c.na[2]&&(c.na[2]=1);b.I=[c.na[0],c.na[1],c.na[2]];e=Qd(c.data);d=e[0];e=e[1];c.min=b.Na=b.W=d;c.max=b.Ga=b.V=e;-Infinity==b.R&&(b.R=d);Infinity==b.U&&(b.U=e);b.rc();b.qb=Sd(this,b,c)}c=new rd;c.fa=b;c.s=a;this.dispatchEvent(c)};
we.prototype.dd=function(a,b){this.da=a;var c=0;if(b.ic!=r){g=b.ic;h=W(this,"ushort",this.da.byteLength-2*g.fb);m=0;for(l=2;0<l;)if(d=h[m++],32==d)if(f=h[m++],19==f){m++;d=h[m++];for(f=0;f<d/2;f++)n=h[m++],q=n&255,n=(n&65280)>>8,c+=String.fromCharCode(q),c+=String.fromCharCode(n),c=parseInt(c,10);l--}else if(4161==f){m++;for(var d=h[m++],e="",f=0;f<d/2;f++)n=h[m++],q=n&255,n=(n&65280)>>8,e+=String.fromCharCode(q),e+=String.fromCharCode(n);g.na=[g.na[0],g.na[1],Math.min(Math.abs(g.og-e),g.na[2])];
g.og=e;l--}g.ya[2]++}else{var g={rows:0,cols:0,na:r,ye:0,mh:0,bb:1,bi:1,og:r,Qd:0,fb:0,Tc:r,bf:0,gf:[],data:r,min:Infinity,max:-Infinity};g.bb=b.p.length;g.bb==r&&(g.bb=1);for(var h=W(this,"ushort",this.da.byteLength),m=66,d=r,f=r,d=r,l=7;0<l;)if(d=h[m++],40==d)switch(f=h[m++],m++,d=h[m++],f){case 16:g.rows=h[m++];l--;break;case 17:g.cols=h[m++];l--;break;case 256:g.ye=h[m++];l--;break;case 257:g.mh=h[m++];l--;break;case 2:g.bi=h[m++];l--;break;case 48:e="";for(f=f=0;f<d/2;f++)var n=h[m++],q=n&255,
n=(n&65280)>>8,e=e+String.fromCharCode(q),e=e+String.fromCharCode(n);e=e.split("\\");g.na=[+e[0],+e[1],Infinity];l--}else if(32==d&&(f=h[m++],19==f)){m++;d=h[m++];for(f=0;f<d/2;f++)n=h[m++],q=n&255,n=(n&65280)>>8,c+=String.fromCharCode(q),c+=String.fromCharCode(n),c=parseInt(c,10);l--}b.ic=g;g.ya=[g.cols,g.rows,1];g.fb=g.rows*g.cols;switch(g.ye){case 8:g.Tc=new Uint8Array(g.cols*g.rows*g.bb);g.data=new Uint8Array(g.cols*g.rows*g.bb);break;case 16:g.Tc=new Uint16Array(g.cols*g.rows*g.bb);g.data=new Uint16Array(g.cols*
g.rows*g.bb);break;case 32:g.Tc=new Uint32Array(g.cols*g.rows*g.bb),g.data=new Uint32Array(g.cols*g.rows*g.bb)}}this.A=this.da.byteLength-2*g.fb;h=r;switch(g.ye){case 8:h=W(this,"uchar",g.fb);break;case 16:h=W(this,"ushort",g.fb);break;case 32:h=W(this,"uint",g.fb)}g.gf[c]=g.bf;g.Tc.set(h,g.bf*g.fb);g.bf++;++g.Qd;return g};E("X.parserDCM",we);E("X.parserDCM.prototype.parse",we.prototype.parse);function xe(){U.call(this);this.c="parserVTK"}G(xe,U);
xe.prototype.parse=function(a,b,c){I.La(this.c+".parse");var d=b.g,e=b.h,f=new Uint8Array(c),g="";b.g=d=new P(c.byteLength);b.h=e=new P(c.byteLength);c=0;for(var h=f.length;c<h;c+=32768)g+=Rd(f,c,Math.min(c+32768,h));f=g.split("\n");g=f.length;this.Pc=this.Qc=r;this.Mb=[];this.va=od;this.ne=this.Bb=this.pb=this.Cb=s;c=0;for(h=g%8;h--;)ye(this,f[c]),c++;for(h=0.125*g^0;h--;)ye(this,f[c]),c++,ye(this,f[c]),c++,ye(this,f[c]),c++,ye(this,f[c]),c++,ye(this,f[c]),c++,ye(this,f[c]),c++,ye(this,f[c]),c++,
ye(this,f[c]),c++;c=this.Qc;var f=this.Pc,g=f.length,m=h=this.Mb.length;do{var l=this.Mb[h-m],n=l.length,q;for(q=0;q<n&&!("LINES"==this.va&&q+1>=n);q++){var w=parseInt(l[q],10),u=c.get(w);d.add(u[0],u[1],u[2]);var x=w,z=u;"LINES"==this.va?(x=parseInt(l[q+1],10),z=c.get(x),d.add(z[0],z[1],z[2])):"TRIANGLE_STRIPS"==this.va&&(0==q||q==n-1)&&d.add(u[0],u[1],u[2]);w<g?(z=f.get(w),e.add(z[0],z[1],z[2]),"LINES"==this.va?(x=f.get(x),e.add(x[0],x[1],x[2])):"TRIANGLE_STRIPS"==this.va&&(0==q||q==n-1)&&e.add(z[0],
z[1],z[2])):(x=new N(u[0],u[1],u[2]),x.normalize(),e.add(x.x,x.y,x.b),"LINES"==this.va?(x=new N(z[0],z[1],z[2]),x.normalize(),e.add(x.x,x.y,x.b)):"TRIANGLE_STRIPS"==this.va&&(0==q||q==n-1)&&e.add(x.x,x.y,x.b))}m--}while(0<m);b.ma=this.va;I.Fa(this.c+".parse");d=new rd;d.fa=b;d.s=a;this.dispatchEvent(d)};
function ye(a,b){b=b.replace(/^\s+|\s+$/g,"");var c=b.split(" "),d=c.length,e=c[0];switch(e){case "POINTS":a.Cb=p;a.pb=s;a.Bb=s;c=parseInt(c[1],10);a.Qc=new P(3*c);a.Pc=new P(3*c);return;case "VERTICES":a.pb=p;a.Cb=s;a.Bb=s;c=parseInt(c[1],10);3<=c?a.va=od:1==c?a.va="POINTS":j(Error("This VTK file is not supported!"));a.Mb=[];return;case "TRIANGLE_STRIPS":a.pb=p;a.Cb=s;a.Bb=s;a.va="TRIANGLE_STRIPS";a.Mb=[];return;case "LINES":a.pb=p;a.Cb=s;a.Bb=s;a.va="LINES";a.Mb=[];return;case "POLYGONS":a.pb=p;
a.Cb=s;a.Bb=s;a.va="POLYGONS";a.Mb=[];return;case "POINT_DATA":a.Bb=p;a.Cb=s;a.pb=s;return}if(a.Cb)if(1==d||isNaN(parseFloat(e)))a.Cb=s;else{if(3<=d){var e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.Qc.add(e,f,g)}6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Qc.add(e,f,g));9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Qc.add(d,e,c))}else a.pb?1==d||isNaN(parseFloat(e))?a.pb=s:(c=c.slice(1),a.Mb.push(c)):a.Bb&&("NORMALS"==e?a.ne=p:1==d||isNaN(parseFloat(e))?
(a.Bb=s,a.ne=s):a.ne&&(3<=d&&(e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),a.Pc.add(e,f,g)),6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Pc.add(e,f,g)),9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Pc.add(d,e,c))))}E("X.parserVTK",xe);E("X.parserVTK.prototype.parse",xe.prototype.parse);function ze(){U.call(this);this.c="parserFSM";this.pd=s}G(ze,U);
ze.prototype.parse=function(a,b,c){I.La(this.c+".parse");this.da=c;var d=b.g,e=b.h;b.pc=[];var f=b.pc;c=0;var g;do g=W(this,"uchar"),c++;while(200>c&&10!=g);W(this,"uchar");e=W(this,"uint");c=W(this,"uint");var h=W(this,"float",3*e);g=W(this,"uint",3*c);var m=new Uint32Array(e),l=new Float32Array(9*c);b.g=d=new P(9*c);b.h=e=new P(9*c);var n;for(n=0;n<c;n++){var q=3*n,w=g[q],u=g[q+1],x=g[q+2];f.push(w);f.push(u);f.push(x);m[w]+=1;m[u]+=1;m[x]+=1;var q=3*w,z=3*u,C=3*x,F=h[q],y=h[q+1],B=h[q+2],u=h[z],
x=h[z+1],w=h[z+2],H=h[C],O=h[C+1],ba=h[C+2];d.add(F,y,B);d.add(u,x,w);d.add(H,O,ba);F=new N(F,y,B);H=new N(H,O,ba);u=(new N(u,x,w)).f().Wa(F);x=H.f().Wa(F);u=Xc(u,x).normalize();l[q]+=u.x;l[q+1]+=u.y;l[q+2]+=u.b;l[z]+=u.x;l[z+1]+=u.y;l[z+2]+=u.b;l[C]+=u.x;l[C+1]+=u.y;l[C+2]+=u.b}for(n=0;n<c;n++)q=3*n,w=g[q],u=g[q+1],x=g[q+2],q=3*w,z=3*u,C=3*x,f=new N(l[z],l[z+1],l[z+2]),h=new N(l[C],l[C+1],l[C+2]),q=(new N(l[q],l[q+1],l[q+2])).scale(1/m[w]).normalize(),f=f.scale(1/m[u]).normalize(),h=h.scale(1/m[x]).normalize(),
e.add(q.x,q.y,q.b),e.add(f.x,f.y,f.b),e.add(h.x,h.y,h.b);b.ma=od;I.Fa(this.c+".parse");c=new rd;c.fa=b;c.s=a;this.dispatchEvent(c)};E("X.parserFSM",ze);E("X.parserFSM.prototype.parse",ze.prototype.parse);var Ae={Ce:function(a,b,c){return Ae.update(a,0,b,c)},update:function(a,b,c,d){var e=Ae.Ug,f="number"===typeof c?c:c=0;d="number"===typeof d?d:a.length;b^=4294967295;for(f=d&7;f--;++c)b=b>>>8^e[(b^a[c])&255];for(f=d>>3;f--;c+=8)b=b>>>8^e[(b^a[c])&255],b=b>>>8^e[(b^a[c+1])&255],b=b>>>8^e[(b^a[c+2])&255],b=b>>>8^e[(b^a[c+3])&255],b=b>>>8^e[(b^a[c+4])&255],b=b>>>8^e[(b^a[c+5])&255],b=b>>>8^e[(b^a[c+6])&255],b=b>>>8^e[(b^a[c+7])&255];return(b^4294967295)>>>0}};
Ae.Ug=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,
3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,
366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,
3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,
1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,
1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function Be(a){var b=a.length,c=0,d=Number.POSITIVE_INFINITY,e,f,g,h,m,l,n,q,w;for(q=0;q<b;++q)a[q]>c&&(c=a[q]),a[q]<d&&(d=a[q]);e=1<<c;f=new Uint32Array(e);g=1;h=0;for(m=2;g<=c;){for(q=0;q<b;++q)if(a[q]===g){l=0;n=h;for(w=0;w<g;++w)l=l<<1|n&1,n>>=1;for(w=l;w<e;w+=m)f[w]=g<<16|q;++h}++g;h<<=1;m<<=1}return[f,c,d]};function Ce(a,b){this.ze=[];this.Ae=32768;this.Qa=this.Sc=this.ja=this.lf=0;this.input=new Uint8Array(a);this.Lf=s;this.Be=De;this.mb=s;if(b||!(b={}))b.index&&(this.ja=b.index),b.bufferSize&&(this.Ae=b.bufferSize),b.bufferType&&(this.Be=b.bufferType),b.resize&&(this.mb=b.resize);switch(this.Be){case Ee:this.Q=32768;this.Aa=new Uint8Array(32768+this.Ae+258);break;case De:this.Q=0;this.Aa=new Uint8Array(this.Ae);this.cc=this.Ah;this.Pf=this.ph;this.Je=this.th;break;default:j(Error("invalid inflate mode"))}}
var Ee=0,De=1;
Ce.prototype.Uc=function(){for(;!this.Lf;){var a=Fe(this,3);a&1&&(this.Lf=p);a>>>=1;switch(a){case 0:var a=this.input,b=this.ja,c=this.Aa,d=this.Q,e=k,f=k,g=k,h=c.length,e=k;this.Qa=this.Sc=0;e=a[b++];e===k&&j(Error("invalid uncompressed block header: LEN (first byte)"));f=e;e=a[b++];e===k&&j(Error("invalid uncompressed block header: LEN (second byte)"));f|=e<<8;e=a[b++];e===k&&j(Error("invalid uncompressed block header: NLEN (first byte)"));g=e;e=a[b++];e===k&&j(Error("invalid uncompressed block header: NLEN (second byte)"));g|=
e<<8;f===~g&&j(Error("invalid uncompressed block header: length verify"));b+f>a.length&&j(Error("input buffer is broken"));switch(this.Be){case Ee:for(;d+f>c.length;)e=h-d,f-=e,c.set(a.subarray(b,b+e),d),d+=e,b+=e,this.Q=d,c=this.cc(),d=this.Q;break;case De:for(;d+f>c.length;)c=this.cc({$f:2});break;default:j(Error("invalid inflate mode"))}c.set(a.subarray(b,b+f),d);d+=f;this.ja=b+=f;this.Q=d;this.Aa=c;break;case 1:this.Je(Ie,Je);break;case 2:Ke(this);break;default:j(Error("unknown BTYPE: "+a))}}return this.Pf()};
var Le=new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Me=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),Ne=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),Oe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),Pe=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Qe=new Uint8Array(288),
Re,Se;Re=0;for(Se=Qe.length;Re<Se;++Re)Qe[Re]=143>=Re?8:255>=Re?9:279>=Re?7:8;var Ie=Be(Qe),Te=new Uint8Array(30),Ue,Ve;Ue=0;for(Ve=Te.length;Ue<Ve;++Ue)Te[Ue]=5;var Je=Be(Te);function Fe(a,b){for(var c=a.Sc,d=a.Qa,e=a.input,f=a.ja,g;d<b;)g=e[f++],g===k&&j(Error("input buffer is broken")),c|=g<<d,d+=8;g=c&(1<<b)-1;a.Sc=c>>>b;a.Qa=d-b;a.ja=f;return g}
function We(a,b){for(var c=a.Sc,d=a.Qa,e=a.input,f=a.ja,g=b[0],h=b[1],m;d<h;)m=e[f++],m===k&&j(Error("input buffer is broken")),c|=m<<d,d+=8;e=g[c&(1<<h)-1];g=e>>>16;a.Sc=c>>g;a.Qa=d-g;a.ja=f;return e&65535}
function Ke(a){function b(a,b,c){var d,e,f;for(f=0;f<a;)switch(d=We(this,b),d){case 16:for(d=3+Fe(this,2);d--;)c[f++]=e;break;case 17:for(d=3+Fe(this,3);d--;)c[f++]=0;e=0;break;case 18:for(d=11+Fe(this,7);d--;)c[f++]=0;e=0;break;default:e=c[f++]=d}return c}var c=Fe(a,5)+257,d=Fe(a,5)+1,e=Fe(a,4)+4,f=new Uint8Array(Le.length),g;for(g=0;g<e;++g)f[Le[g]]=Fe(a,3);e=Be(f);f=new Uint8Array(c);g=new Uint8Array(d);a.Je(Be(b.call(a,c,e,f)),Be(b.call(a,d,e,g)))}v=Ce.prototype;
v.Je=function(a,b){var c=this.Aa,d=this.Q;this.Tf=a;for(var e=c.length-258,f,g,h;256!==(f=We(this,a));)if(256>f)d>=e&&(this.Q=d,c=this.cc(),d=this.Q),c[d++]=f;else{f-=257;h=Me[f];0<Ne[f]&&(h+=Fe(this,Ne[f]));f=We(this,b);g=Oe[f];0<Pe[f]&&(g+=Fe(this,Pe[f]));d>=e&&(this.Q=d,c=this.cc(),d=this.Q);for(;h--;)c[d]=c[d++-g]}for(;8<=this.Qa;)this.Qa-=8,this.ja--;this.Q=d};
v.th=function(a,b){var c=this.Aa,d=this.Q;this.Tf=a;for(var e=c.length,f,g,h;256!==(f=We(this,a));)if(256>f)d>=e&&(c=this.cc(),e=c.length),c[d++]=f;else{f-=257;h=Me[f];0<Ne[f]&&(h+=Fe(this,Ne[f]));f=We(this,b);g=Oe[f];0<Pe[f]&&(g+=Fe(this,Pe[f]));d+h>e&&(c=this.cc(),e=c.length);for(;h--;)c[d]=c[d++-g]}for(;8<=this.Qa;)this.Qa-=8,this.ja--;this.Q=d};
v.cc=function(){var a=new Uint8Array(this.Q-32768),b=this.Q-32768,c=this.Aa;a.set(c.subarray(32768,a.length));this.ze.push(a);this.lf+=a.length;c.set(c.subarray(b,b+32768));this.Q=32768;return c};v.Ah=function(a){var b=this.input.length/this.ja+1|0,c=this.input,d=this.Aa;a&&("number"===typeof a.$f&&(b=a.$f),"number"===typeof a.ih&&(b+=a.ih));2>b?(a=(c.length-this.ja)/this.Tf[2],a=258*(a/2)|0,a=a<d.length?d.length+a:d.length<<1):a=d.length*b;a=new Uint8Array(a);a.set(d);return this.Aa=a};
v.Pf=function(){var a=0,b=this.Aa,c=this.ze,d,e=new Uint8Array(this.lf+(this.Q-32768)),f,g,h,m;if(0===c.length)return this.Aa.subarray(32768,this.Q);f=0;for(g=c.length;f<g;++f){d=c[f];h=0;for(m=d.length;h<m;++h)e[a++]=d[h]}f=32768;for(g=this.Q;f<g;++f)e[a++]=b[f];this.ze=[];return this.buffer=e};v.ph=function(){var a,b=this.Q;this.mb?(a=new Uint8Array(b),a.set(this.Aa.subarray(0,b))):a=this.Aa.subarray(0,b);return this.buffer=a};new Uint8Array(256);var Xe;for(Xe=0;256>Xe;++Xe)for(var Ye=Xe,Ze=7,Ye=Ye>>>1;Ye;Ye>>>=1)--Ze;var $e=[],af;for(af=0;288>af;af++)switch(p){case 143>=af:$e.push([af+48,8]);break;case 255>=af:$e.push([af-144+400,9]);break;case 279>=af:$e.push([af-256+0,7]);break;case 287>=af:$e.push([af-280+192,8]);break;default:j("invalid literal: "+af)}
function bf(){var a=cf;switch(p){case 3===a:return[257,a-3,0];case 4===a:return[258,a-4,0];case 5===a:return[259,a-5,0];case 6===a:return[260,a-6,0];case 7===a:return[261,a-7,0];case 8===a:return[262,a-8,0];case 9===a:return[263,a-9,0];case 10===a:return[264,a-10,0];case 12>=a:return[265,a-11,1];case 14>=a:return[266,a-13,1];case 16>=a:return[267,a-15,1];case 18>=a:return[268,a-17,1];case 22>=a:return[269,a-19,2];case 26>=a:return[270,a-23,2];case 30>=a:return[271,a-27,2];case 34>=a:return[272,a-
31,2];case 42>=a:return[273,a-35,3];case 50>=a:return[274,a-43,3];case 58>=a:return[275,a-51,3];case 66>=a:return[276,a-59,3];case 82>=a:return[277,a-67,4];case 98>=a:return[278,a-83,4];case 114>=a:return[279,a-99,4];case 130>=a:return[280,a-115,4];case 162>=a:return[281,a-131,5];case 194>=a:return[282,a-163,5];case 226>=a:return[283,a-195,5];case 257>=a:return[284,a-227,5];case 258===a:return[285,a-258,0];default:j("invalid length: "+a)}}var df=[],cf,ef;
for(cf=3;258>=cf;cf++)ef=bf(),df[cf]=ef[2]<<24|ef[1]<<16|ef[0];new Uint32Array(df);function ff(){};function gf(a){this.input=a;this.ja=0;this.member=[]}
gf.prototype.Uc=function(){for(var a=this.input.length;this.ja<a;){var b=new ff,c=k,d=k,e=k,f=c=e=k,g=k,c=c=k,h=this.input,d=this.ja;b.hg=h[d++];b.ig=h[d++];(31!==b.hg||139!==b.ig)&&j(Error("invalid file signature:",b.hg,b.ig));b.Nf=h[d++];switch(b.Nf){case 8:break;default:j(Error("unknown compression method: "+b.Nf))}b.Id=h[d++];c=h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24;b.ok=new Date(1E3*c);b.tk=h[d++];b.pk=h[d++];0<(b.Id&4)&&(b.qj=h[d++]|h[d++]<<8,d+=b.qj);if(0<(b.Id&8)){g=[];for(f=0;0<(c=h[d++]);)g[f++]=
String.fromCharCode(c);b.name=g.join("")}if(0<(b.Id&16)){g=[];for(f=0;0<(c=h[d++]);)g[f++]=String.fromCharCode(c);b.comment=g.join("")}0<(b.Id&2)&&(b.qh=Ae.Ce(h,0,d)&65535,b.qh!==(h[d++]|h[d++]<<8)&&j(Error("invalid header crc16")));c=h[h.length-4]|h[h.length-3]<<8|h[h.length-2]<<16|h[h.length-1]<<24;h.length-d-4-4<512*c&&(e=c);d=new Ce(h,{index:d,bufferSize:e});b.data=e=d.Uc();d=d.ja;b.jk=c=(h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24)>>>0;Ae.Ce(e)!==c&&j(Error("invalid CRC-32 checksum: 0x"+Ae.Ce(e).toString(16)+
" / 0x"+c.toString(16)));b.mk=c=(h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24)>>>0;(e.length&4294967295)!==c&&j(Error("invalid input size: "+(e.length&4294967295)+" / "+c));this.member.push(b);this.ja=d}a=this.member;b=e=d=0;for(h=a.length;b<h;++b)e+=a[b].data.length;e=new Uint8Array(e);for(b=0;b<h;++b)e.set(a[b].data,d),d+=a[b].data.length;return e};function hf(){U.call(this);this.c="parserMGZ";this.pd=s}G(hf,U);hf.prototype.parse=function(a,b,c,d){I.La(this.c+".parse");d&&(c=(new gf(new Uint8Array(c))).Uc(),c=c.buffer);d=this.dd(c);b.ea=[d.Te,d.Ue,d.Ve];b.I=d.Og;c=d.min;var e=d.max;b.Na=b.W=c;b.Ga=b.V=e;-Infinity==b.R&&(b.R=c);Infinity==b.U&&(b.U=e);b.rc();I.Fa(this.c+".parse");b.qb=Sd(this,b,d);d=new rd;d.fa=b;d.s=a;this.dispatchEvent(d)};
hf.prototype.dd=function(a){this.da=a;a={version:0,Xg:0,Vg:0,Gh:0,Wg:0,Te:0,Ue:0,Ve:0,ai:0,type:0,yh:0,Gg:0,vj:r,Tg:r,Og:r,data:r,min:Infinity,max:-Infinity};a.version=W(this,"uint");a.Te=W(this,"uint");a.Ue=W(this,"uint");a.Ve=W(this,"uint");a.ai=W(this,"uint");a.type=W(this,"uint");a.yh=W(this,"uint");a.Gg=W(this,"ushort");if(0<a.Gg){a.Og=W(this,"float",3);var b=[];b.push(W(this,"float",3));b.push(W(this,"float",3));b.push(W(this,"float",3));b.push(W(this,"float",3));a.Tg=b}this.A=284;b=a.Te*a.Ue*
a.Ve;switch(a.type){case 0:a.data=W(this,"uchar",b);break;case 1:a.data=W(this,"uint",b);break;case 3:a.data=W(this,"float",b);break;case 4:a.data=W(this,"ushort",b);break;default:j(Error("Unsupported MGH/MGZ data type: "+a.type))}b=Qd(a.data);a.min=b[0];a.max=b[1];this.A+16<this.da.byteLength&&(a.Xg=W(this,"float"),a.Gh=W(this,"float"),a.Vg=W(this,"float"),a.Wg=W(this,"float"));return a};E("X.parserMGZ",hf);E("X.parserMGZ.prototype.parse",hf.prototype.parse);function jf(){U.call(this);this.c="parserCRV";this.pd=s}G(jf,U);
jf.prototype.parse=function(a,b,c){I.La(this.c+".parse");var d=b.pc;0==d.length&&j(Error("No _pointIndices defined on the X.object."));this.da=c;this.A=3;var e=W(this,"uint");W(this,"uint");W(this,"uint");var f=0,g=0,h=0,m=0,l=0,n=0,q=0,w=0,u=0,x=0,z=0;c=Array(2);var C=Array(2),F=W(this,"float",e),y;for(y=0;y<e;y++){var B=F[y];0==y&&(c[0]=C[0]=B);0<=B?(f++,m+=B):(g++,h+=B);u+=B;z++;C[0]=Math.max(B,C[0]);c[0]=Math.min(B,c[0]);F[y]=B}0!=f&&(l=m/f);0!=g&&(n=h/g);0!=z&&(x=u/z);for(z=u=h=m=0;z<e;z++)B=
F[z],y=0,0<=B?(y=Math.pow(B-l,2),m+=y):(y=Math.pow(B-n,2),h+=y),y=Math.pow(B-x,2),u+=y;1<f&&(q=Math.sqrt(m/(f-1)));1<g&&(w=Math.sqrt(h/(g-1)));c[1]=n-2.5*w;C[1]=l+2.5*q;e=d.length;f=new Float32Array(3*e);for(z=0;z<e;z++)g=F[d[z]],h=3*z,f[h]=g,f[h+1]=g,f[h+2]=g;b.t.Na=c[1];b.t.Ga=C[1];-Infinity==b.t.R&&(b.t.R=c[1]);Infinity==b.t.U&&(b.t.U=C[1]);b.t.u=F;b.t.Ac=f;b.t.e=p;I.Fa(this.c+".parse");d=new rd;d.fa=b;d.s=a;this.dispatchEvent(d)};E("X.parserCRV",jf);E("X.parserCRV.prototype.parse",jf.prototype.parse);function kf(){U.call(this);this.c="parserTRK"}G(kf,U);
kf.prototype.parse=function(a,b,c){I.La(this.c+".parse");var d=b.g,e=b.h,f=b.Z;this.da=c;W(this,"uchar",6);W(this,"ushort",3);var g=W(this,"float",3);W(this,"float",3);var h=W(this,"ushort");W(this,"uchar",200);W(this,"ushort");W(this,"uchar",200);W(this,"float",16);W(this,"uchar",444);W(this,"uchar",4);W(this,"uchar",4);W(this,"float",6);W(this,"uchar",2);W(this,"uchar");W(this,"uchar");W(this,"uchar");W(this,"uchar");W(this,"uchar");W(this,"uchar");var m=W(this,"uint");W(this,"uint");var l=W(this,
"uint"),n=[],q=[];c=Infinity;var w=-Infinity,u=r,x=r,z=r,C=r,e=d=r,F=W(this,"uint",(this.da.byteLength-1E3)/4);this.A=l;for(var y=W(this,"float",(this.da.byteLength-1E3)/4),B=0,l=f=0;l<m;l++){for(var H=F[B],O=new P(3*H),ba=0,Q=0;Q<H;Q++){var R=y[B+3*Q+Q*h+1],ga=y[B+3*Q+Q*h+2],da=y[B+3*Q+Q*h+3],R=R/g[0],ga=ga/g[1],da=da/g[2];O.add(R,ga,da);if(0<Q)var ca=O.get(Q-1),ba=ba+Math.sqrt(Math.pow(R-ca[0],2)+Math.pow(ga-ca[1],2)+Math.pow(da-ca[2],2));Q<H-1&&(f+=6)}B+=3*H+H*h+1;Q=O.Sb;H=O.Pb;R=O.Tb;ga=O.Qb;
da=O.Ub;ca=O.Rb;if(!u||Q<u)u=Q;if(!x||H>x)x=H;if(!z||R<z)z=R;if(!C||ga>C)C=ga;if(!d||da<d)d=da;if(!e||ca>e)e=ca;n.push(O);q.push(ba)}g=(u+x)/2;z=(z+C)/2;h=(d+e)/2;C=new Float32Array(f);b.g=d=new P(f);b.h=e=new P(f);b.Z=f=new P(f);for(l=u=0;l<m;l++){x=n[l];F=x.count;ba=q[l];c=Math.min(c,ba);w=Math.max(w,ba);for(Q=0;Q<F-1;Q++){B=x.get(Q);y=x.get(Q+1);d.add(B[0],B[1],B[2]);d.add(y[0],y[1],y[2]);var O=B[0]-g,H=B[1]-z,R=B[2]-h,ga=Math.sqrt(O*O+H*H+R*R),da=y[0]-g,ca=y[1]-z,Ua=y[2]-h,mb=Math.sqrt(da*da+
ca*ca+Ua*Ua);e.add(O/ga,H/ga,R/ga);e.add(da/mb,ca/mb,Ua/mb);y=[Math.abs(y[0]-B[0]),Math.abs(y[1]-B[1]),Math.abs(y[2]-B[2])];B=Math.sqrt(y[0]*y[0]+y[1]*y[1]+y[2]*y[2]);y[0]/=B;y[1]/=B;y[2]/=B;f.add(y[0],y[1],y[2]);f.add(y[0],y[1],y[2]);C[u++]=ba;C[u++]=ba;C[u++]=ba;C[u++]=ba;C[u++]=ba;C[u++]=ba}}b.ma="LINES";m=new qd;m.Na=c;m.Ga=w;m.R=c;m.U=w;m.Ac=C;m.Hf=s;m.e=p;b.t=m;I.Fa(this.c+".parse");c=new rd;c.fa=b;c.s=a;this.dispatchEvent(c)};E("X.parserTRK",kf);E("X.parserTRK.prototype.parse",kf.prototype.parse);function lf(){U.call(this);this.c="parserIMAGE"}G(lf,U);lf.prototype.parse=function(a,b,c,d){c instanceof ArrayBuffer||j(Error());for(var e=new Uint8Array(c),f=e.length,g=Array(f);f--;)g[f]=String.fromCharCode(e[f]);e=window.btoa(g.join(""));f=new Image;wc(f,"load",this.Di.bind(this,f,a,b,c,d));f.src="data:image/"+d+";base64,"+e};lf.prototype.Di=function(a,b,c){b.qb=a;b.xa=r;a=new rd;a.fa=c;a.s=b;this.dispatchEvent(a)};E("X.parserIMAGE",lf);E("X.parserIMAGE.prototype.parse",lf.prototype.parse);function mf(){U.call(this);this.c="parserLUT"}G(mf,U);
mf.prototype.parse=function(a,b,c){I.La(this.c+".parse");this.da=c;c=W(this,"uchar",c.byteLength);var d=c.length,e=0,f;for(f=0;f<d;f++)if(10==c[f]){var g=Rd(c,e,f),e=f+1,g=g.replace(/^\s+|\s+$/g,"");"#"!=g[0]&&(g=g.split(" "),g=g.filter(function(a){return""!=a}),6==g.length&&(g[2]=parseInt(g[2],10)/255,g[3]=parseInt(g[3],10)/255,g[4]=parseInt(g[4],10)/255,g[5]=parseInt(g[5],10)/255,a.add(parseInt(g[0],10),g[1],g[2],g[3],g[4],g[5],10)))}I.Fa(this.c+".parse");c=new rd;c.fa=b;c.s=a;this.dispatchEvent(c)};
E("X.parserLUT",mf);E("X.parserLUT.prototype.parse",mf.prototype.parse);function nf(){U.call(this);this.c="parserNRRD"}G(nf,U);
nf.prototype.parse=function(a,b,c){I.La(this.c+".parse");this.da=c;c=W(this,"uchar",c.byteLength);var d=c.length,e=r,f=0,g;for(g=1;g<d;g++)if(10==c[g-1]&&10==c[g]){e=Rd(c,0,g-2);f=g+1;break}var h,m,l,n,d=e.split(/\r?\n/),e=0;for(g=d.length;e<g;e++)if(h=d[e],h.match(/NRRD\d+/))this.Wh=p;else if(!h.match(/^#/)&&(n=h.match(/(.*):(.*)/)))m=n[1].trim(),h=n[2].trim(),(l=this.Ch[m])?l.call(this,h):this[m]=h;this.Wh||j(Error("Not an NRRD file"));"raw"!==this.encoding&&("gzip"!==this.encoding&&"gz"!==this.encoding)&&
j(Error("Only raw or gz/gzip encoding is allowed"));if(!this.Ka&&(this.Ka=[new N(1,0,0),new N(0,1,0),new N(0,0,1)],this.hf)){d=[];for(n=0;2>=n;n++)d.push(!isNaN(this.hf[n])?this.Ka[n].scale(this.hf[n]):k)}f=c.subarray(f);if("gzip"==this.encoding||"gz"==this.encoding)f=(new gf(new Uint8Array(f))).Uc();f=f.buffer;c={data:r,min:Infinity,max:-Infinity};c.data=new this.Ib(f);n=Qd(c.data);f=c.min=n[0];n=c.max=n[1];b.ea=[this.ef[0],this.ef[1],this.ef[2]];b.I=[(new N(this.Ka[0][0],this.Ka[0][1],this.Ka[0][2])).fc(),
(new N(this.Ka[1][0],this.Ka[1][1],this.Ka[1][2])).fc(),(new N(this.Ka[2][0],this.Ka[2][1],this.Ka[2][2])).fc()];b.Na=b.W=f;b.Ga=b.V=n;-Infinity==b.R&&(b.R=f);Infinity==b.U&&(b.U=n);b.rc();I.Fa(this.c+".parse");b.qb=Sd(this,b,c);c=new rd;c.fa=b;c.s=a;this.dispatchEvent(c)};
nf.prototype.Ch={type:function(a){switch(a){case "uchar":case "unsigned char":case "uint8":case "uint8_t":this.Ib=Uint8Array;break;case "signed char":case "int8":case "int8_t":this.Ib=Int8Array;break;case "short":case "short int":case "signed short":case "signed short int":case "int16":case "int16_t":this.Ib=Int16Array;break;case "ushort":case "unsigned short":case "unsigned short int":case "uint16":case "uint16_t":this.Ib=Uint16Array;break;case "int":case "signed int":case "int32":case "int32_t":this.Ib=
Int32Array;break;case "uint":case "unsigned int":case "uint32":case "uint32_t":this.Ib=Uint32Array;break;case "float":this.Ib=Float32Array;break;default:j(Error("Unsupported NRRD data type: "+a))}return this.type=a},endian:function(a){return this.lk=a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.ya=parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];b=0;for(c=d.length;b<c;b++)a=d[b],e.push(parseInt(a,10));return this.ef=e},"space directions":function(a){var b,
c;a=a.match(/\(.*?\)/g);var d,e,f;f=[];d=0;for(e=a.length;d<e;d++)c=a[d],f.push(function(){var a,d,e,f;e=c.slice(1,-1).split(/,/);f=[];a=0;for(d=e.length;a<d;a++)b=e[a],f.push(parseFloat(b));return f}());return this.Ka=f},spacings:function(a){var b;b=a.split(/\s+/);var c,d,e;e=[];c=0;for(d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));return this.hf=e}};E("X.parserNRRD",nf);E("X.parserNRRD.prototype.parse",nf.prototype.parse);function of(){U.call(this);this.c="parserNII"}G(of,U);of.prototype.parse=function(a,b,c){I.La(this.c+".parse");var d=c,e=-1,e="undefined"==typeof DataView?(new Int32Array(c,0,1))[0]:(new DataView(c,0)).getInt32(0,p);348!=e&&(d=(new gf(new Uint8Array(d))).Uc(),d=d.buffer);c=this.dd(d);b.ea=[c.ya[1],c.ya[2],c.ya[3]];b.I=[c.na[1],c.na[2],c.na[3]];d=c.min;e=c.max;b.Na=b.W=d;b.Ga=b.V=e;-Infinity==b.R&&(b.R=d);Infinity==b.U&&(b.U=e);b.rc();I.Fa(this.c+".parse");b.qb=Sd(this,b,c);c=new rd;c.fa=b;c.s=a;this.dispatchEvent(c)};
of.prototype.dd=function(a){this.da=a;a={Zi:0,rh:r,sh:r,Bh:0,Wi:0,Ni:0,xh:r,ya:r,Sh:0,Th:0,Uh:0,Qh:0,Ie:0,lh:0,cj:0,na:r,Pg:0,Vi:0,Ui:0,bj:0,$i:r,rj:r,nh:0,oh:0,aj:0,jj:0,Ih:0,Jh:0,wh:r,kh:r,Gi:0,Xi:0,Ki:0,Li:0,Mi:0,Hi:0,Ii:0,Ji:0,dj:r,ej:r,fj:r,Rh:r,Xh:r,data:r,min:Infinity,max:-Infinity};a.Zi=W(this,"uint");a.rh=W(this,"uchar",10);a.sh=W(this,"uchar",18);a.Bh=W(this,"uint");a.Wi=W(this,"ushort");a.Ni=W(this,"uchar");a.xh=W(this,"uchar");a.ya=W(this,"ushort",8);a.Sh=W(this,"float");a.Th=W(this,"float");
a.Uh=W(this,"float");a.Qh=W(this,"ushort");a.Ie=W(this,"ushort");a.lh=W(this,"ushort");a.cj=W(this,"ushort");a.na=W(this,"float",8);a.Pg=W(this,"float");a.Vi=W(this,"float");a.Ui=W(this,"float");a.bj=W(this,"ushort");a.$i=W(this,"uchar");a.rj=W(this,"uchar");a.nh=W(this,"float");a.oh=W(this,"float");a.aj=W(this,"float");a.jj=W(this,"float");a.Ih=W(this,"uint",1);a.Jh=W(this,"uint",1);a.wh=W(this,"uchar",80);a.kh=W(this,"uchar",24);a.Gi=W(this,"ushort");a.Xi=W(this,"ushort");a.Ki=W(this,"float");a.Li=
W(this,"float");a.Mi=W(this,"float");a.Hi=W(this,"float");a.Ii=W(this,"float");a.Ji=W(this,"float");a.dj=W(this,"float",4);a.ej=W(this,"float",4);a.fj=W(this,"float",4);a.Rh=W(this,"uchar",16);a.Xh=W(this,"uchar",4);this.A=parseInt(a.Pg,10);var b=a.ya[1]*a.ya[2]*a.ya[3];switch(a.Ie){case 2:a.data=W(this,"uchar",b);break;case 4:a.data=W(this,"sshort",b);break;case 8:a.data=W(this,"sint",b);break;case 16:a.data=W(this,"float",b);break;case 256:a.data=W(this,"schar",b);break;case 512:a.data=W(this,"ushort",
b);break;case 768:a.data=W(this,"uint",b);break;default:j(Error("Unsupported NII data type: "+a.Ie))}b=Qd(a.data);a.min=b[0];a.max=b[1];return a};E("X.parserNII",of);E("X.parserNII.prototype.parse",of.prototype.parse);function pf(){L.call(this);this.c="loader";this.nc=new Tb;this.Nc=0}G(pf,L);function qf(a,b){a.Nc+=b/a.nc.ab()/3;a.Nc=Math.min(1,a.Nc);var c=new Pd;c.Jf=a.Nc;a.dispatchEvent(c)}function rf(a){a=a.p.td;var b=a.split(".").pop().toUpperCase();b==a.toUpperCase()&&(b="");b in sf||j(Error("The "+b+" file format is not supported."));return[a,b,sf[b][0],sf[b][1],sf[b][2]]}
pf.prototype.load=function(a,b){(!a||!b)&&j(Error("No container or object to load."));if(!Wb(this.nc.D,a.ua)||this.nc.get(a.ua)){this.nc.set(a.ua,s);var c=rf(a)[0];if(a.Lb!=r)this.parse(r,a,b);else{var d=new XMLHttpRequest;K(d,"abort",this.Zf.bind(this,d,a,b));K(d,"error",this.Zf.bind(this,d,a,b));K(d,"load",this.parse.bind(this,d,a,b));d.open("GET",c,p);d.responseType="arraybuffer";d.send(r)}}};
pf.prototype.parse=function(a,b,c){qf(this,1);setTimeout(function(){var d=rf(b),e=d[3],d=new d[2];wc(d,Dd,this.complete.bind(this));var f=b.Lb;f==r&&(f=a.response);d.parse(b,c,f,e)}.bind(this),100)};pf.prototype.complete=function(a){qf(this,1);setTimeout(function(){var b=a.s,c=a.fa;b.p.e=s;b.e=p;c.o();this.nc.set(b.ua,p)}.bind(this),100)};pf.prototype.Zf=function(a,b,c){j(Error("Loading failed: ",b,c))};
var sf={STL:[ve,r],VTK:[xe,r],TRK:[kf,r],FSM:[ze,r],INFLATED:[ze,r],SMOOTHWM:[ze,r],SPHERE:[ze,r],PIAL:[ze,r],ORIG:[ze,r],NRRD:[nf,r],NII:[of,r],GZ:[of,r],DCM:[we,r],DICOM:[we,r],"":[we,r],CRV:[jf,r],LABEL:[Xd,r],MGH:[hf,s],MGZ:[hf,p],TXT:[mf,r],LUT:[mf,r],PNG:[lf,"png"],JPG:[lf,"jpeg"],JPEG:[lf,"jpeg"],GIF:[lf,"gif"]};function tf(a,b){(!D(a)||!D(b))&&j(Error("A camera needs valid width and height values."));L.call(this);this.c="camera";this.wa=new N(0,0,100);this.lc=new N(0,0,0);this.J=new N(0,1,0);this.m=this.Sd(this.wa,this.lc);this.Nb=new Float32Array(this.m.Ia())}G(tf,L);tf.prototype.observe=function(a){(a==r||!(a instanceof Y))&&j(Error("Could not observe the interactor."));K(a,yd,this.qi.bind(this));K(a,xd,this.ni.bind(this));K(a,zd,this.Ci.bind(this))};
tf.prototype.qi=function(a){a instanceof Jd||j(Error("Received no valid rotate event."));this.rotate(a.K)};tf.prototype.Ci=function(a){a instanceof Kd||j(Error("Received no valid zoom event."));a.Za?this.Qg(a.Ma):this.Rg(a.Ma)};tf.prototype.ni=function(a){a instanceof Id||j(Error("Received no valid pan event."));this.Cg(a.K)};tf.prototype.__defineGetter__("view",t("m"));tf.prototype.__defineSetter__("view",function(a){(a==r||!(a instanceof id))&&j(Error("Invalid view matrix."));this.m=a;this.Nb=new Float32Array(this.m.Ia())});
tf.prototype.__defineGetter__("position",function(){return[this.wa.x,this.wa.y,this.wa.b]});tf.prototype.__defineSetter__("position",function(a){(a==r||!A(a)||3!=a.length)&&j(Error("Invalid position."));this.wa=new N(a[0],a[1],a[2]);this.reset()});tf.prototype.__defineGetter__("focus",function(){return[this.lc.x,this.lc.y,this.lc.b]});tf.prototype.__defineSetter__("focus",function(a){(a==r||!A(a)||3!=a.length)&&j(Error("Invalid focus"));this.lc=new N(a[0],a[1],a[2]);this.reset()});
tf.prototype.__defineGetter__("up",function(){return[this.J.x,this.J.y,this.J.b]});tf.prototype.__defineSetter__("up",function(a){(a==r||!A(a)||3!=a.length)&&j(Error("Invalid up vector."));this.J=new N(a[0],a[1],a[2]);this.reset()});v=tf.prototype;v.reset=function(){this.m=this.Sd(this.wa,this.lc);this.Nb=new Float32Array(this.m.Ia())};v.rotate=function(a){A(a)&&2==a.length?a=new $c(a[0],a[1]):a instanceof $c||j(Error("Invalid distance vector for rotate operation."));return a};
v.Cg=function(a){A(a)&&2==a.length?a=new $c(a[0],a[1]):a instanceof $c||j(Error("Invalid distance vector for pan operation."));a=new N(-a.x,a.y,0);a=jd(4).translate(a);this.m=new id(a.multiply(this.m));this.Nb=new Float32Array(this.m.Ia())};v.Qg=function(a){var b=20;a!=r&&!a&&(b=1);a=new N(0,0,b);a=jd(4).translate(a);this.m=new id(a.multiply(this.m));this.Nb=new Float32Array(this.m.Ia())};
v.Rg=function(a){var b=30;a!=r&&!a&&(b=1);a=new N(0,0,-b);a=jd(4).translate(a);this.m=new id(a.multiply(this.m));this.Nb=new Float32Array(this.m.Ia())};v.Sd=function(a,b){(!(a instanceof N)||!(b instanceof N))&&j(Error("3D vectors required for calculating the view."));return jd(4)};E("X.camera",tf);E("X.camera.prototype.pan",tf.prototype.Cg);E("X.camera.prototype.rotate",tf.prototype.rotate);E("X.camera.prototype.zoomIn",tf.prototype.Qg);E("X.camera.prototype.zoomOut",tf.prototype.Rg);function uf(a){function b(a,b,d){b=2*b*Math.PI;b=Fa(Ca(m,Math.cos(b)),Ca(l,Math.sin(b)));a=Fa(Fa(c,Ca(e,a)),Ca(b,f));d=Fa(Ca(b,1-Math.abs(d)),Ca(g,d));return new Fc(a,d)}this.z=[];a=a||{};var c=new ya(a.start||[0,-1,0]),d=new ya(a.end||[0,1,0]),e=Da(d,c),f=a.cb||1;a=a.ff||16;for(var g=Ba(e),h=0.5<Math.abs(g.y()),m=Ba(Aa(new ya(h,!h,0),g)),l=Ba(Aa(m,g)),h=new Fc(c,Ga(g)),d=new Fc(d,Ba(g)),n=[],q=0;q<a;q++){var w=q/a,u=(q+1)/a;n.push(new Hc([h,b(0,w,-1),b(0,u,-1)]));n.push(new Hc([b(0,u,0),b(0,w,0),
b(1,w,0),b(1,u,0)]));n.push(new Hc([d,b(1,u,1),b(1,w,1)]))}return Pc(n)}G(uf,Oc);function vf(){T.call(this);this.c="cylinder";this.ue=[-10,-10,-10];this.be=[10,10,10];this.Vb=10;this.Yb=32;Ha(this,new td)}G(vf,T);vf.prototype.__defineGetter__("start",t("ue"));vf.prototype.__defineSetter__("start",function(a){(a==r||!A(a)||3!=a.length)&&j(Error("Invalid start"));this.ue=a});vf.prototype.__defineGetter__("end",t("be"));vf.prototype.__defineSetter__("end",function(a){(a==r||!A(a)||3!=a.length)&&j(Error("Invalid end"));this.be=a});vf.prototype.__defineGetter__("radius",t("Vb"));
vf.prototype.__defineSetter__("radius",function(a){D(a)||j(Error("Invalid radius."));this.Vb=a});vf.prototype.o=function(){vd(this,new uf({start:this.ue,end:this.be,cb:this.Vb,ff:this.Yb}));vf.j.o.call(this)};E("X.cylinder",vf);E("X.cylinder.prototype.modified",vf.prototype.o);function wf(a){function b(a,b){a*=2*Math.PI;b*=Math.PI;var e=new ya(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new Fc(Fa(c,Ca(e,d)),e))}this.z=[];a=a||{};var c=new ya(a.Ee||[0,0,0]),d=a.cb||1,e=a.ff||16;a=a.gj||8;for(var f=[],g=[],h=0;h<e;h++)for(var m=0;m<a;m++)g=[],b(h/e,m/a),0<m&&b((h+1)/e,m/a),m<a-1&&b((h+1)/e,(m+1)/a),b(h/e,(m+1)/a),f.push(new Hc(g));return Pc(f)}G(wf,Oc);function xf(){T.call(this);this.c="sphere";this.l=[0,0,0];this.Vb=5;this.Yb=32;this.eh=16;Ha(this,new td)}G(xf,T);xf.prototype.__defineGetter__("center",t("l"));xf.prototype.__defineSetter__("center",function(a){(a==r||!A(a)||3!=a.length)&&j(Error("Invalid center"));this.l=a});xf.prototype.__defineGetter__("radius",t("Vb"));xf.prototype.__defineSetter__("radius",function(a){D(a)||j(Error("Invalid radius."));this.Vb=a});
xf.prototype.o=function(){vd(this,new wf({Ee:this.l,cb:this.Vb,ff:this.Yb,gj:this.eh}));xf.j.o.call(this)};E("X.sphere",xf);E("X.sphere.prototype.modified",xf.prototype.o);function ue(a){M.call(this);this.c="labelmap";this.kb=a}G(ue,M);ue.prototype.o=function(){var a=new rd;a.fa=this;this.dispatchEvent(a);this.kb.o()};E("X.labelmap",ue);function yf(a){this.z=[];a=a||{};var b=new ya(a.Ee||[0,0,0]),c=!a.cb?[1,1,1]:a.cb.length?a.cb:[a.cb,a.cb,a.cb];return Pc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new Hc(a[0].map(function(e){e=new ya(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.b()+c[2]*(2*!!(e&4)-1));return new Fc(e,new ya(a[1]))}))}))}G(yf,Oc);function zf(){T.call(this);this.c="cube";this.l=[0,0,0];this.ie=this.he=this.ge=20;this.Zb=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];Ha(this,new td)}G(zf,T);zf.prototype.__defineGetter__("center",t("l"));zf.prototype.__defineSetter__("center",function(a){(a==r||!A(a)||3!=a.length)&&j(Error("Invalid center"));this.l=a});zf.prototype.__defineGetter__("lengthX",t("ge"));
zf.prototype.__defineSetter__("lengthX",function(a){D(a)||j(Error("Invalid lengthX."));this.ge=a});zf.prototype.__defineGetter__("lengthY",t("he"));zf.prototype.__defineSetter__("lengthY",function(a){D(a)||j(Error("Invalid lengthY."));this.he=a});zf.prototype.__defineGetter__("lengthZ",t("ie"));zf.prototype.__defineSetter__("lengthZ",function(a){D(a)||j(Error("Invalid lengthZ."));this.ie=a});zf.prototype.o=function(){vd(this,new yf({Ee:this.l,cb:[this.ge/2,this.he/2,this.ie/2]}));zf.j.o.call(this)};
E("X.cube",zf);E("X.cube.prototype.modified",zf.prototype.o);function pe(a){Y.call(this,a);this.c="interactor3D";this.fk=s}G(pe,Y);pe.prototype.cd=function(a){pe.j.cd.call(this,a);var b=new Kd;a.sc==r&&(a.sc=0);b.Za=0>a.sc;b.Ma=p;this.dispatchEvent(b)};function Af(a){L.call(this);this.c="array";this.u=[];this.rf=a}G(Af,L);Af.prototype.add=function(a){this.u.push(a);return p};Af.prototype.clear=function(){this.u.length=0};function Bf(a,b,c){var d=c-b;if(!(2>d)){d=b+Math.floor(d/2);Bf(a,b,d);for(Bf(a,d,c);b<d;++b)if(0<a.rf(a.u[b],a.u[d])){var e=a.u[b];a.u[b]=a.u[d];for(var f=a,g=d,h=c;g+1<h&&0>f.rf(f.u[g+1],e);){var m=f,l=g+1,n=m.u[g];m.u[g]=m.u[l];m.u[l]=n;++g}f.u[g]=e}}}Af.prototype.sort=function(){Bf(this,0,this.u.length)};function Cf(a,b){tf.call(this,a,b);this.c="camera2D"}G(Cf,tf);Cf.prototype.rotate=function(a){a=Cf.j.rotate.call(this,a);var b=new Hd;0<a.x?b.we--:0>a.x&&b.we++;0<a.y?b.je++:0>a.y&&b.je--;this.dispatchEvent(b)};function Df(a,b){tf.call(this,a,b);this.c="camera3D";this.tf=45;this.Ef=new Float32Array(Ef(this.tf,a/b).Ia())}G(Df,tf);function Ef(a,b){var c=1*Math.tan(a*Math.PI/360),d=-c;return new id([[2/(c*b-d*b),0,(c*b+d*b)/(c*b-d*b),0],[0,2/(c-d),(c+d)/(c-d),0],[0,0,-10001/9999,-2.000200020002],[0,0,-1,0]])}
Df.prototype.rotate=function(a){a=Df.j.rotate.call(this,a);var b=-a.x/5*Math.PI/180;a=-a.y/5*Math.PI/180;var c=jd(4),d=new N(parseFloat(this.m.Y(0,0)),parseFloat(this.m.Y(0,1)),parseFloat(this.m.Y(0,2))),b=c.rotate(b,new N(parseFloat(this.m.Y(1,0)),parseFloat(this.m.Y(1,1)),parseFloat(this.m.Y(1,2))));a=c.rotate(a,d);this.m=new id(this.m.multiply(a.multiply(b)));this.Nb=new Float32Array(this.m.Ia())};
Df.prototype.Sd=function(a,b){Df.j.Sd.call(this,a,b);var c=jd(4),d=new N(a.x-b.x,a.y-b.y,a.b-b.b),d=d.normalize(),e=this.J.f();e.Vc(d)&&(e.b+=1E-6);var f=Xc(e,d),e=Xc(d,f),f=f.normalize(),e=e.normalize();c.k(0,0,f.x);c.k(0,1,f.y);c.k(0,2,f.b);c.k(0,3,0);c.k(1,0,e.x);c.k(1,1,e.y);c.k(1,2,e.b);c.k(1,3,0);c.k(2,0,d.x);c.k(2,1,d.y);c.k(2,2,d.b);c.k(2,3,0);c.k(3,0,0);c.k(3,1,0);c.k(3,2,0);c.k(3,3,1);d=a.f();return c.translate(d.aa())};E("X.camera3D",Df);function Ff(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}Ff.prototype.f=function(){return new Ff(this.top,this.right,this.bottom,this.left)};Ff.prototype.contains=function(a){return!this||!a?s:a instanceof Ff?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};function Gf(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}Gf.prototype.f=function(){return new Gf(this.left,this.top,this.width,this.height)};Gf.prototype.kg=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top);a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,p}return s};
Gf.prototype.contains=function(a){return a instanceof Gf?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};Gf.prototype.za=function(){return new bd(this.width,this.height)};function Hf(a,b){var c=ee(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,r))?c[b]||c.getPropertyValue(b):""}function If(a,b){return a.currentStyle?a.currentStyle[b]:r}function Jf(a,b){return Hf(a,b)||If(a,b)||a.style&&a.style[b]}function Kf(a){a=a?9==a.nodeType?a:ee(a):document;return J&&!xb(9)&&!me(ce(a))?a.body:a.documentElement}
function Lf(a){var b=a.getBoundingClientRect();J&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function Mf(a){if(J&&!xb(8))return a.offsetParent;var b=ee(a),c=Jf(a,"position"),d="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=Jf(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return r}
function Nf(a){for(var b=new Ff(0,Infinity,Infinity,0),c=ce(a),d=c.P.body,e=c.P.documentElement,f=!hb&&"CSS1Compat"==c.P.compatMode?c.P.documentElement:c.P.body;a=Mf(a);)if((!J||0!=a.clientWidth)&&(!hb||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=Jf(a,"overflow")){var g=Of(a),h;h=a;if(gb&&!vb("1.9")){var m=parseFloat(Hf(h,"borderLeftWidth"));if(Pf(h))var l=h.offsetWidth-h.clientWidth-m-parseFloat(Hf(h,"borderRightWidth")),m=m+l;h=new Yc(m,parseFloat(Hf(h,"borderTopWidth")))}else h=new Yc(h.clientLeft,
h.clientTop);g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=c.P.parentWindow||c.P.defaultView||window;e=c.document;hb&&!vb("500")&&!ib?("undefined"==typeof c.innerHeight&&(c=window),e=c.innerHeight,a=c.document.documentElement.scrollHeight,c==c.top&&a<e&&(e-=15),c=new bd(c.innerWidth,e)):(c="CSS1Compat"==
e.compatMode?e.documentElement:e.body,c=new bd(c.clientWidth,c.clientHeight));b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:r}
function Of(a){var b,c=ee(a),d=Jf(a,"position"),e=gb&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Yc(0,0),g=Kf(c);if(a==g)return f;if(a.getBoundingClientRect)b=Lf(a),a=ne(ce(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(hb&&"fixed"==Jf(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(eb||hb&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=Mf(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!eb||"TR"!=b.tagName)f.y-=b.scrollTop}return f}function Qf(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function Rf(a){if("none"!=Jf(a,"display"))return Sf(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=Sf(a);b.display=c;b.position=e;b.visibility=d;return a}function Sf(a){var b=a.offsetWidth,c=a.offsetHeight,d=hb&&!b&&!c;return(!ja(b)||d)&&a.getBoundingClientRect?(a=Lf(a),new bd(a.right-a.left,a.bottom-a.top)):new bd(b,c)}function Tf(a,b){a.style.display=b?"":"none"}function Pf(a){return"rtl"==Jf(a,"direction")}
function Uf(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}var Vf={thin:2,medium:4,thick:6};function Wf(a,b){if("none"==If(a,b+"Style"))return 0;var c=If(a,b+"Width");return c in Vf?Vf[c]:Uf(a,c)};function Xf(a){this.Ta=a;this.v=[]}G(Xf,$b);var Yf=[];function Zf(a,b,c,d,e){A(c)||(Yf[0]=c,c=Yf);for(var f=0;f<c.length;f++){var g=K(b,c[f],d||a,e||s,a.Ta||a);a.v.push(g)}}Xf.prototype.Vd=function(){Fb(this.v,yc);this.v.length=0};Xf.prototype.O=function(){Xf.j.O.call(this);this.Vd()};Xf.prototype.handleEvent=function(){j(Error("EventHandler.handleEvent not implemented"))};function $f(){}$f.ag=function(){return $f.Ph||($f.Ph=new $f)};$f.prototype.We=0;$f.ag();function ag(a){this.lb=a||ce();this.Pi=bg}G(ag,Ec);ag.prototype.Nh=$f.ag();var bg=r;v=ag.prototype;v.jg=r;v.ec=s;v.q=r;v.Pi=r;v.Zh=r;v.uc=r;v.Ed=r;v.Dd=r;v.pj=s;v.i=t("q");v.df=function(a){this.uc&&this.uc!=a&&j(Error("Method not supported"));ag.j.df.call(this,a)};v.Jd=t("lb");v.qc=function(){this.q=this.lb.createElement("div")};v.hc=function(a){this.Hb(a)};
v.Hb=function(a,b){this.ec&&j(Error("Component already rendered"));this.q||this.qc();a?a.insertBefore(this.q,b||r):this.lb.P.body.appendChild(this.q);(!this.uc||this.uc.ec)&&this.Hd()};v.Hd=function(){this.ec=p;cg(this,function(a){!a.ec&&a.i()&&a.Hd()})};v.Xc=function(){cg(this,function(a){a.ec&&a.Xc()});this.Nd&&this.Nd.Vd();this.ec=s};
v.O=function(){ag.j.O.call(this);this.ec&&this.Xc();this.Nd&&(this.Nd.Ra(),delete this.Nd);cg(this,function(a){a.Ra()});!this.pj&&this.q&&je(this.q);this.uc=this.Zh=this.q=this.Dd=this.Ed=r};function cg(a,b){a.Ed&&Fb(a.Ed,b,k)}
v.removeChild=function(a,b){if(a){var c=la(a)?a:a.jg||(a.jg=":"+(a.Nh.We++).toString(36)),d;this.Dd&&c?(d=this.Dd,d=(c in d?d[c]:k)||r):d=r;a=d;c&&a&&(d=this.Dd,c in d&&delete d[c],Jb(this.Ed,a),b&&(a.Xc(),a.q&&je(a.q)),c=a,c==r&&j(Error("Unable to set parent component")),c.uc=r,ag.j.df.call(c,r))}a||j(Error("Child is not in parent component"));return a};function dg(){}G(dg,Ec);v=dg.prototype;v.nf=0;v.bd=0;v.Se=100;v.Yf=0;v.jf=1;v.Vh=s;v.$h=s;v.Yd=function(a){a=fg(this,a);this.nf!=a&&(this.nf=a+this.Yf>this.Se?this.Se-this.Yf:a<this.bd?this.bd:a,!this.Vh&&!this.$h&&this.dispatchEvent("change"))};v.Md=function(){return fg(this,this.nf)};v.Ld=function(){return fg(this,this.bd)};v.Kd=function(){return fg(this,this.Se)};function fg(a,b){return a.jf==r?b:a.bd+Math.round((b-a.bd)/a.jf)*a.jf};function gg(a){ag.call(this,a);this.vc=new dg;K(this.vc,"change",this.Kh,s,this)}G(gg,ag);var hg={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};v=gg.prototype;v.qc=function(){this.Xa=this.Jd().qc("div","progress-bar-thumb");var a=hg[this.Bg];this.q=this.Jd().qc("div",a,this.Xa);ig(this);a=this.Ld();this.i().setAttribute("aria-valuemin",a);a=this.Kd();this.i().setAttribute("aria-valuemax",a)};
v.Hd=function(){gg.j.Hd.call(this);J&&7>nb&&K(this.i(),"resize",this.$d,s,this);this.$d();var a=this.i();a.setAttribute("role","progressbar");a.rk="progressbar";this.i().setAttribute("aria-live","polite")};v.Xc=function(){gg.j.Xc.call(this);jg(this)};function jg(a){J&&7>nb&&xc(a.i(),"resize",a.$d,s,a)}v.Md=function(){return this.vc.Md()};v.Yd=function(a){this.vc.Yd(a);this.i()&&ig(this)};function ig(a){var b=a.Md();a.i().setAttribute("aria-valuenow",b)}v.Ld=function(){return this.vc.Ld()};v.Kd=function(){return this.vc.Kd()};
v.Bg="horizontal";v.Kh=function(){this.$d();this.dispatchEvent("change")};v.$d=function(){if(this.Xa){var a=this.Ld(),b=this.Kd(),a=(this.Md()-a)/(b-a),b=Math.round(100*a);"vertical"==this.Bg?J&&7>nb?(this.Xa.style.top=0,this.Xa.style.height="100%",b=this.Xa.offsetHeight,a=Math.round(a*b),this.Xa.style.top=b-a+"px",this.Xa.style.height=a+"px"):(this.Xa.style.top=100-b+"%",this.Xa.style.height=b+"%"):this.Xa.style.width=b+"%"}};v.O=function(){jg(this);gg.j.O.call(this);this.Xa=r;this.vc.Ra()};function kg(a,b){a==r&&j(Error("No valid parent element."));b==r&&j(Error("Invalid initial value."));gg.call(this);this.c="progressbar";this.oa=a;this.Df="";this.md=this.jb=r;this.Kb=[];var c;c=".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n";c+="  background: white;\n";c+="  padding: 1px;\n";c+="  overflow: hidden;\n";c+="  margin: 2px;\n";c+="  width: 100px;\n";c+="  height: 5px;\n";c+="}";var d;d=".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n";
d+="  overflow: hidden;\n";d+="  width: 0%;\n";d+="  height: 100%;\n";d+="}";var e;e=".progress-bar-thumb-done {\n  background: #57E964;\n}";this.Kb=[c,d,e];this.Yd(b);this.Pe()}G(kg,gg);
kg.prototype.Pe=function(){if("static"==this.oa.style.position||""==this.oa.style.position)this.Df=this.oa.style.position,this.oa.style.position="relative";var a=document.getElementsByTagName("head")[0],b=he("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Kb[0]),d=document.createTextNode(this.Kb[1]),e=document.createTextNode(this.Kb[2]);a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(e);this.jb=b;this.hc(this.oa);a=this.i();a.style.position="absolute";
a.style.top=(this.oa.clientHeight-5)/2+"px";a.style.left=(this.oa.clientWidth-100)/2+"px";a.classList.add("xtk-progress-bar")};function lg(a){var b=a.i().style.top,c=a.i().style.left;je(a.i());var d=new kg(a.oa,100),e=d.i();e.style.position="absolute";e.style.top=b;e.style.left=c;e.classList.add("xtk-progress-bar");(e.firstElementChild!=k?e.firstElementChild:ke(e.firstChild)).classList.add("progress-bar-thumb-done");a.md=d}
kg.prototype.Pd=function(){this.jb&&je(this.jb);this.i()&&je(this.i());this.md&&je(this.md.i());this.md=this.jb=r;this.oa.style.position=this.Df};var mg=fa.window;function ng(a,b,c){ma(a)?c&&(a=ua(a,c)):a&&"function"==typeof a.handleEvent?a=ua(a.handleEvent,a):j(Error("Invalid listener argument"));return 2147483647<b?-1:mg.setTimeout(a,b||0)};function og(){L.call(this);this.c="renderer";this.s=window.document.body;this.M=this.s.clientWidth;this.H=this.s.clientHeight;this.Ob=this.r=this.ka=r;this.hb=new Af(sd);this.$a=[];this.B=r;this.oe=this.qd=this.rd=s;this.a=this.pa=r;this.G={PROGRESSBAR_ENABLED:p,INTERMEDIATE_RENDERING:s};this.pf=-1;window.console.log("XTK release 9 -- 2013-01-14 14:55:00 -- http://www.goXTK.com -- @goXTK")}G(og,L);v=og.prototype;v.oi=function(a){this.pa&&this.pa.Yd(100*a.Jf)};
v.ei=function(a){a!=r&&a instanceof rd&&a.fa&&this.eb(a.fa)};v.Ze=function(a){(a==r||!(a instanceof Md))&&j(Error("Invalid hover event."))};v.pi=function(){var a=fe(this.s);this.M=a.clientWidth;this.H=a.clientHeight;a=fe(this.ka);a.width=this.M;a.height=this.H;"renderer3D"==this.c&&(this.a.viewport(0,0,this.M,this.H),this.r.Ef=new Float32Array(Ef(this.r.tf,this.ka.width/this.ka.height).Ia()));this.xc()};v.$e=function(a){(a==r||!(a instanceof Ld))&&j(Error("Invalid scroll event."))};
og.prototype.__defineGetter__("config",t("G"));og.prototype.__defineGetter__("interactor",t("Ob"));og.prototype.__defineGetter__("camera",t("r"));og.prototype.__defineGetter__("loadingCompleted",t("qd"));og.prototype.__defineGetter__("container",t("s"));og.prototype.__defineSetter__("container",function(a){a==r&&j(Error("An ID to a valid container (<div>..) is required."));var b=a;la(b)&&(b=fe(a));oa(b)&&1==b.nodeType||j(Error("Could not find the given container."));this.s=b});v=og.prototype;
v.xc=function(){this.r.reset()};
v.ia=function(a){var b=he("canvas");this.s.appendChild(b);this.M=this.s.clientWidth;this.H=this.s.clientHeight;b.width=this.M;b.height=this.H;try{var c=b.getContext(a);c||j(Error())}catch(d){var e="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.s.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+e+"</p>";
j(Error(e))}this.B=new pf;K(this.B,Ed,this.oi.bind(this));this.ka=b;this.a=c;b=new pe(this.ka);"2d"==a&&(b=new re(this.ka));b.ia();K(b,Bd,this.xc.bind(this));K(b,Fd,this.Ze.bind(this));K(b,Ad,this.$e.bind(this));this.Ob=b;b=new Df(this.M,this.H);"2d"==a&&(b=new Cf(this.M,this.H));b.observe(this.Ob);this.r=b;K(window,"resize",this.pi,s,this)};v.add=function(a){(a instanceof zf||a instanceof xf||a instanceof vf)&&a.o();this.$a.push(a);this.eb(a)};
v.eb=function(a){(!this.ka||!this.a)&&j(Error("The renderer was not initialized properly."));a==r&&(window.console.log(a),j(Error("Illegal object.")));var b;b=pa(a);var c=tc[b];if(c){var d=ja(Dd),e=ja(k);d&&e?(c=sc[Dd],b=!!c&&!!c[k]&&b in c[k]):b=!d&&!e?p:Hb(c,function(a){return d&&a.type==Dd||e&&a.capture==k})}else b=s;b||K(a,Dd,this.ei.bind(this))};v.get=function(a){a==r&&j(Error("Invalid object id."));for(var b=this.hb.u,c=b.length,d=0,d=0;d<c;d++)if(b[d].ua==a)return b[d];return r};
v.hc=function(){(!this.ka||!this.a)&&j(Error("The renderer was not initialized properly."));if(this.Gf==r){if(this.B.nc.Fe(s)){if(this.G.PROGRESSBAR_ENABLED&&!this.pa&&(this.pa=new kg(this.s,3)),this.oe=this.qd=s,this.Gf=ng(function(){this.Gf=r;this.hc()}.bind(this),100),!this.G.INTERMEDIATE_RENDERING)return}else if(!this.qd&&!this.oe&&(this.oe=p,eval("this.onShowtime()"),this.qd=p),this.pa){this.G.PROGRESSBAR_ENABLED&&(this.pa&&!this.qf)&&(lg(this.pa),this.qf=ng(function(){this.qf=r;this.pa&&(this.pa.Pd(),
this.pa=r);this.hc()}.bind(this),700));return}this.pf=window.requestAnimationFrame(this.hc.bind(this),this.ka);eval("this.onRender()");this.Hb(s,p)}};v.Ag=aa();v.yg=aa();v.Hb=aa();
v.Gd=function(){window.cancelAnimationFrame(this.pf);this.B&&(delete this.B,this.B=r);this.pa&&(this.pa.Pd(),delete this.pa,this.pa=r);this.hb.clear();delete this.hb;this.$a.length=0;delete this.$a;delete this.B;this.B=r;delete this.r;this.r=r;delete this.Ob;this.Ob=r;delete this.a;this.a=r;je(this.ka);delete this.ka;this.ka=r};function pg(){L.call(this);this.c="shaders";this.zd="";var a;a="precision mediump float;\n\n";a+="attribute vec3 vertexPosition;\n";a+="attribute vec3 vertexNormal;\n";a+="attribute vec3 vertexColor;\n";a+="attribute vec2 vertexTexturePos;\n";a+="attribute float vertexScalar;\n";a+="\n";a+="uniform mat4 view;\n";a+="uniform mat4 perspective;\n";a+="uniform vec3 center;\n";a+="uniform mat4 objectTransform;\n";a+="uniform bool useObjectColor;\n";a+="uniform bool useScalars;\n";a+="uniform bool scalarsReplaceMode;\n";
a+="uniform float scalarsMin;\n";a+="uniform float scalarsMax;\n";a+="uniform vec3 scalarsMinColor;\n";a+="uniform vec3 scalarsMaxColor;\n";a+="uniform float scalarsMinThreshold;\n";a+="uniform float scalarsMaxThreshold;\n";a+="uniform int scalarsInterpolation;\n";a+="uniform vec3 objectColor;\n";a+="uniform float pointSize;\n";a+="\n";a+="varying float fDiscardNow;\n";a+="varying vec4 fVertexPosition;\n";a+="varying vec3 fragmentColor;\n";a+="varying vec2 fragmentTexturePos;\n";a+="varying vec3 fVertexNormal;\n";
a+="varying vec3 fTransformedVertexNormal;\n";a+="\n";a+="void main(void) {\n";a+="  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * ";a+="mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * ";a+="vertexNormal;\n";a+="  fVertexNormal = vertexNormal;\n";a+="  fDiscardNow = 0.0;\n";a+="  vec3 vertexPosition2 = vertexPosition - center;\n";a+="  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n";a+="  fragmentTexturePos = vertexTexturePos;\n";
a+="  if (useScalars) {\n";a+="    float scalarValue = vertexScalar;\n";a+="    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n";a+="      if (scalarsReplaceMode) {\n";a+="        fragmentColor = objectColor;\n";a+="      } else {\n";a+="        fDiscardNow = 1.0;\n";a+="      }\n";a+="    } else {\n";a+="      if (scalarsReplaceMode) {\n";a+="        if (scalarsInterpolation == 1) {\n";a+="            vec3 zeroMaxColor;\n";a+="            vec3 zeroMinColor;\n";a+=
"            zeroMaxColor[0] = scalarsMaxColor[0]*0.33;\n";a+="            zeroMaxColor[1] = scalarsMaxColor[1]*0.33;\n";a+="            zeroMaxColor[2] = scalarsMaxColor[2]*0.33;\n";a+="            zeroMinColor[0] = scalarsMinColor[0]*0.33;\n";a+="            zeroMinColor[1] = scalarsMinColor[1]*0.33;\n";a+="            zeroMinColor[2] = scalarsMinColor[2]*0.33;\n";a+="            if(scalarValue < 0.0) {fragmentColor = scalarValue/(scalarsMin) * scalarsMinColor + (1.0 - scalarValue/(scalarsMin)) * (zeroMinColor);}\n";
a+="            else {fragmentColor = scalarValue/(scalarsMax) * scalarsMaxColor + (1.0 - scalarValue/(scalarsMax)) * (zeroMaxColor);}\n";a+="        } else {\n";a+="            fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n";a+="          }\n";a+="      } else {\n";a+="        fragmentColor = vertexColor;\n";a+="      }\n";a+="    }\n";a+="  } else if (useObjectColor) {\n";a+="    fragmentColor = objectColor;\n";a+="  } else {\n";a+="    fragmentColor = vertexColor;\n";
a+="  }\n";a+="  gl_PointSize = pointSize;\n";a+="  gl_Position = perspective * fVertexPosition;\n";this.zd=a+="}\n";this.nd="";a="precision mediump float;\n\n";a+="uniform bool usePicking;\n";a+="uniform bool useTexture;\n";a+="uniform bool volumeTexture;\n";a+="uniform bool useLabelMapTexture;\n";a+="uniform sampler2D textureSampler;\n";a+="uniform sampler2D textureSampler2;\n";a+="uniform float objectOpacity;\n";a+="uniform float labelmapOpacity;\n";a+="uniform float volumeLowerThreshold;\n";a+=
"uniform float volumeUpperThreshold;\n";a+="uniform float volumeScalarMin;\n";a+="uniform float volumeScalarMax;\n";a+="uniform vec3 volumeScalarMinColor;\n";a+="uniform vec3 volumeScalarMaxColor;\n";a+="uniform float volumeWindowLow;\n";a+="uniform float volumeWindowHigh;\n";a+="\n";a+="varying float fDiscardNow;\n";a+="varying vec4 fVertexPosition;\n";a+="varying vec3 fragmentColor;\n";a+="varying vec2 fragmentTexturePos;\n";a+="varying vec3 fVertexNormal;\n";a+="varying vec3 fTransformedVertexNormal;\n";
a+="\n";a+="void main(void) {\n";a+=" if (fDiscardNow > 0.0) {\n";a+="   discard;\n";a+=" }\n";a+=" if (usePicking) {\n";a+="   gl_FragColor = vec4(fragmentColor, 1.0);\n";a+=" } else if (useTexture) {\n";a+="   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n";a+="   vec4 textureSum = texture1;\n";a+="   if (volumeTexture) {\n";a+="     float _windowLow = (volumeWindowLow / volumeScalarMax);\n";a+="     float _windowHigh = (volumeWindowHigh / volumeScalarMax);\n";a+="     vec3 _minrange = vec3(_windowLow,_windowLow,_windowLow);\n";
a+="     vec3 _maxrange = vec3(_windowHigh,_windowHigh,_windowHigh);\n";a+="     vec3 fac = _maxrange - _minrange;\n";a+="     textureSum = vec4((textureSum.r - _minrange)/fac,1);\n";a+="     textureSum = textureSum.r * vec4(volumeScalarMaxColor,1) + (1.0 - textureSum.r) * vec4(volumeScalarMinColor,1);\n";a+="   }\n";a+="   if (useLabelMapTexture) {\n";a+="     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n";a+="     if (texture2.a > 0.0) {\n";a+="       if (labelmapOpacity < 1.0) {\n";
a+="         textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n";a+="       } else {\n";a+="         textureSum = texture2;\n";a+="       }\n";a+="     }\n";a+="   }\n";a+="   if (volumeTexture) {\n";a+="     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n";a+="     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n";a+="     if (texture1.r < _volumeLowerThreshold ||\n";a+="         texture1.r > _volumeUpperThreshold) {\n";a+="       discard;\n";
a+="     };\n";a+="   };\n";a+="   gl_FragColor = textureSum;\n";a+="   gl_FragColor.a = objectOpacity;\n";a+=" } else {\n";a+="   vec3 nNormal = normalize(fTransformedVertexNormal);\n";a+="   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n";a+="     gl_FragColor = vec4(fragmentColor,1.0);\n";a+="     return;\n";a+="   }\n";a+="   vec3 light = vec3(0.0, 0.0, 1.0);\n";a+="   vec3 lightDirection = vec3(0,0,-10);\n";a+="   lightDirection = normalize(lightDirection);\n";a+="   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n";
a+="   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n";a+="   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n";a+="   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n";a+="   float ambient = 0.3;\n";a+="   gl_FragColor = vec4(fragmentColor * ambient +\n";a+="                       fragmentColor * diffuse +\n";a+="                       vec3(0.2, 0.2, 0.2) * specular,\n";a+="                       objectOpacity);\n";a+=" }\n";this.nd=a+="}\n"}
G(pg,L);
var qg={Tj:"vertexPosition",Sj:"vertexNormal",Rj:"vertexColor",Vj:"vertexTexturePos",Uj:"vertexScalar"},rg={Wj:"view",Aj:"perspective",sj:"center",zj:"objectTransform",Nj:"useObjectColor",xj:"objectColor",Pj:"useScalars",Jj:"scalarsReplaceMode",Gj:"scalarsMin",Dj:"scalarsMax",Hj:"scalarsMinColor",Ej:"scalarsMaxColor",Ij:"scalarsMinThreshold",Fj:"scalarsMaxThreshold",Cj:"scalarsInterpolation",Bj:"pointSize",yj:"objectOpacity",wj:"normal",Oj:"usePicking",Qj:"useTexture",Mj:"useLabelMapTexture",uj:"labelmapOpacity",
Kj:"textureSampler",Lj:"textureSampler2",Xj:"volumeLowerThreshold",ck:"volumeUpperThreshold",$j:"volumeScalarMin",Yj:"volumeScalarMax",ak:"volumeScalarMinColor",Zj:"volumeScalarMaxColor",ek:"volumeWindowLow",dk:"volumeWindowHigh",bk:"volumeTexture"};function sg(a,b,c){a==r&&j(Error("Invalid GL Buffer."));b==r&&j(Error("Invalid number of items."));c==r&&j(Error("Invalid item size."));L.call(this);this.c="buffer";this.la=a;this.ub=b;this.vb=c}G(sg,L);function tg(a,b,c,d,e,f,g,h){var m,l=c.offsetParent;if(l){var n="HTML"==l.tagName||"BODY"==l.tagName;if(!n||"static"!=Jf(l,"position"))m=Of(l),n||(m=Zc(m,new Yc(l.scrollLeft,l.scrollTop)))}l=Of(a);n=Rf(a);l=new Gf(l.x,l.y,n.width,n.height);(n=Nf(a))&&l.kg(new Gf(n.left,n.top,n.right-n.left,n.bottom-n.top));var n=ce(a),q=ce(c);if(n.P!=q.P){var w=n.P.body,q=q.P.parentWindow||q.P.defaultView,u=new Yc(0,0),x=ee(w)?ee(w).parentWindow||ee(w).defaultView:window,z=w;do{var C;if(x==q)C=Of(z);else{var F=z;
C=new Yc;if(1==F.nodeType)if(F.getBoundingClientRect)F=Lf(F),C.x=F.left,C.y=F.top;else{var y=ne(ce(F)),F=Of(F);C.x=F.x-y.x;C.y=F.y-y.y}else{var y=ma(F.Hh),B=F;F.targetTouches?B=F.targetTouches[0]:y&&F.Ha.targetTouches&&(B=F.Ha.targetTouches[0]);C.x=B.clientX;C.y=B.clientY}}u.x+=C.x;u.y+=C.y}while(x&&x!=q&&(z=x.frameElement)&&(x=x.parent));w=Zc(u,Of(w));J&&!me(n)&&(w=Zc(w,ne(n)));l.left+=w.x;l.top+=w.y}a=(b&4&&Pf(a)?b^2:b)&-5;b=new Yc(a&2?l.left+l.width:l.left,a&1?l.top+l.height:l.top);m&&(b=Zc(b,
m));e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var H;if(g&&(H=Nf(c))&&m)H.top-=m.y,H.right-=m.x,H.bottom-=m.y,H.left-=m.x;return ug(b,c,d,f,H,g,h)}
function ug(a,b,c,d,e,f,g){a=a.f();var h=0,m=(c&4&&Pf(b)?c^2:c)&-5;c=Rf(b);g=g?g.f():c.f();if(d||0!=m)m&2?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),m&1?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f){if(e){h=a;d=0;if(65==(f&65)&&(h.x<e.left||h.x>=e.right))f&=-2;if(132==(f&132)&&(h.y<e.top||h.y>=e.bottom))f&=-5;h.x<e.left&&f&1&&(h.x=e.left,d|=1);h.x<e.left&&(h.x+g.width>e.right&&f&16)&&(g.width=Math.max(g.width-(h.x+g.width-e.right),0),d|=4);h.x+g.width>e.right&&f&1&&(h.x=Math.max(e.right-g.width,
e.left),d|=1);f&2&&(d|=(h.x<e.left?16:0)|(h.x+g.width>e.right?32:0));h.y<e.top&&f&4&&(h.y=e.top,d|=2);h.y>=e.top&&(h.y+g.height>e.bottom&&f&32)&&(g.height=Math.max(g.height-(h.y+g.height-e.bottom),0),d|=8);h.y+g.height>e.bottom&&f&4&&(h.y=Math.max(e.bottom-g.height,e.top),d|=2);f&8&&(d|=(h.y<e.top?64:0)|(h.y+g.height>e.bottom?128:0));h=d}else h=256;if(h&496)return h}f=a;e=gb&&(Za||lb)&&vb("1.9");f instanceof Yc?(a=f.x,f=f.y):(a=f,f=k);b.style.left=Qf(a,e);b.style.top=Qf(f,e);cd(c,g)||(a=me(ce(ee(b))),
J&&(!a||!vb("8"))?(c=b.style,a?(J?(a=Uf(b,If(b,"paddingLeft")),e=Uf(b,If(b,"paddingRight")),f=Uf(b,If(b,"paddingTop")),d=Uf(b,If(b,"paddingBottom")),a=new Ff(f,e,d,a)):(a=Hf(b,"paddingLeft"),e=Hf(b,"paddingRight"),f=Hf(b,"paddingTop"),d=Hf(b,"paddingBottom"),a=new Ff(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),J?(e=Wf(b,"borderLeft"),f=Wf(b,"borderRight"),d=Wf(b,"borderTop"),b=Wf(b,"borderBottom"),b=new Ff(d,f,b,e)):(e=Hf(b,"borderLeftWidth"),f=Hf(b,"borderRightWidth"),d=Hf(b,"borderTopWidth"),
b=Hf(b,"borderBottomWidth"),b=new Ff(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,gb?b.MozBoxSizing="border-box":hb?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,0)+"px",b.height=Math.max(g.height,0)+"px"));return h};function vg(){}vg.prototype.Va=aa();function wg(a,b){this.element=a;this.Rf=b}G(wg,vg);wg.prototype.Va=function(a,b,c){tg(this.element,this.Rf,a,b,k,c)};function xg(a,b){this.Ta=new Xf(this);this.cf(a||r);b&&(this.yc=b)}G(xg,Ec);v=xg.prototype;v.q=r;v.jh=p;v.Kf=r;v.ra=s;v.Yi=s;v.Re=-1;v.ng=-1;v.Mh=s;v.zh=p;v.yc="toggle_display";v.i=t("q");v.cf=function(a){this.ra&&j(Error("Can not change this state of the popup while showing."));this.q=a};
function yg(a,b){a.fd&&a.fd.stop();a.$c&&a.$c.stop();if(b){if(!a.ra&&a.Xe()){a.q||j(Error("Caller must call setElement before trying to show the popup"));a.Va();var c=ee(a.q);a.Mh&&Zf(a.Ta,c,"keydown",a.ci,p);if(a.jh)if(Zf(a.Ta,c,"mousedown",a.wg,p),J){var d;try{d=c.activeElement}catch(e){}for(;d&&"IFRAME"==d.nodeName;){try{var f=d.contentDocument||d.contentWindow.document}catch(g){break}c=f;d=c.activeElement}Zf(a.Ta,c,"mousedown",a.wg,p);Zf(a.Ta,c,"deactivate",a.vg)}else Zf(a.Ta,c,"blur",a.vg);"toggle_display"==
a.yc?(a.q.style.visibility="visible",Tf(a.q,p)):"move_offscreen"==a.yc&&a.Va();a.ra=p;a.fd?(wc(a.fd,"end",a.zg,s,a),a.fd.play()):a.zg()}}else zg(a)}v.Va=ha;function zg(a,b){if(!a.ra||!a.dispatchEvent({type:"beforehide",target:b}))return s;a.Ta&&a.Ta.Vd();a.$c?(wc(a.$c,"end",wa(a.Qf,b),s,a),a.$c.play()):a.Qf(b);return p}v.Qf=function(a){"toggle_display"==this.yc?this.Yi?ng(this.gg,0,this):this.gg():"move_offscreen"==this.yc&&(this.q.style.left="-200px",this.q.style.top="-200px");this.ra=s;this.Ye(a)};
v.gg=function(){this.q.style.visibility="hidden";Tf(this.q,s)};v.Xe=function(){return this.dispatchEvent("beforeshow")};v.zg=function(){this.Re=xa();this.ng=-1;this.dispatchEvent("show")};v.Ye=function(a){this.ng=xa();this.dispatchEvent({type:"hide",target:a})};v.wg=function(a){a=a.target;!le(this.q,a)&&((!this.Kf||le(this.Kf,a))&&!(150>xa()-this.Re))&&zg(this,a)};v.ci=function(a){27==a.keyCode&&zg(this,a.target)&&(a.preventDefault(),a.stopPropagation())};
v.vg=function(a){if(this.zh){var b=ee(this.q);if(J||eb){if(a=b.activeElement,!a||le(this.q,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>xa()-this.Re||zg(this)}};v.O=function(){xg.j.O.call(this);this.Ta.Ra();bc(this.fd);bc(this.$c);delete this.q;delete this.Ta};function Ag(a,b){this.Ge=a instanceof Yc?a:new Yc(a,b)}G(Ag,vg);Ag.prototype.Va=function(a,b,c,d){tg(Kf(a),0,a,b,this.Ge,c,r,d)};function Bg(a,b){this.Fi=4;this.Ud=b||k;xg.call(this,a)}G(Bg,xg);Bg.prototype.Va=function(){if(this.Ud){var a=!this.ra&&"move_offscreen"!=this.yc,b=this.i();a&&(b.style.visibility="hidden",Tf(b,p));this.Ud.Va(b,this.Fi,this.nk);a&&Tf(b,s)}};function Cg(a,b,c){this.lb=c||(a?ce(fe(a)):ce());Bg.call(this,this.lb.qc("div",{style:"position:absolute;display:none;"}));this.He=new Yc(1,1);this.bc=new Yb;a&&Dg(this,a);if(b!=r)if(a=this.i(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(ee(a).createTextNode(b))}}G(Cg,Bg);var Eg=[];v=Cg.prototype;v.qa=r;v.className="goog-tooltip";
v.Hg=500;v.Lh=0;v.Jd=t("lb");function Dg(a,b){b=fe(b);a.bc.add(b);K(b,"mouseover",a.dg,s,a);K(b,"mouseout",a.Od,s,a);K(b,"mousemove",a.cg,s,a);K(b,"focus",a.bg,s,a);K(b,"blur",a.Od,s,a)}v.detach=function(a){if(a)a=fe(a),Fg(this,a),this.bc.remove(a);else{for(var b=this.bc.Sa(),c=0;a=b[c];c++)Fg(this,a);this.bc.clear()}};function Fg(a,b){xc(b,"mouseover",a.dg,s,a);xc(b,"mouseout",a.Od,s,a);xc(b,"mousemove",a.cg,s,a);xc(b,"focus",a.bg,s,a);xc(b,"blur",a.Od,s,a)}
v.cf=function(a){var b=this.i();b&&je(b);Cg.j.cf.call(this,a);a&&(b=this.lb.P.body,b.insertBefore(a,b.lastChild))};v.Xe=function(){if(!xg.prototype.Xe.call(this))return s;if(this.anchor)for(var a,b=0;a=Eg[b];b++)le(a.i(),this.anchor)||yg(a,s);0<=Eb(Eg,this)||Eg.push(this);a=this.i();a.className=this.className;Gg(this);K(a,"mouseover",this.fg,s,this);K(a,"mouseout",this.eg,s,this);Hg(this);return p};
v.Ye=function(){Jb(Eg,this);for(var a=this.i(),b,c=0;b=Eg[c];c++)b.anchor&&le(a,b.anchor)&&yg(b,s);this.Dg&&Ig(this.Dg);xc(a,"mouseover",this.fg,s,this);xc(a,"mouseout",this.eg,s,this);this.anchor=k;if(0==(this.nb?this.ra?4:1:this.tc?3:this.ra?2:0))this.Wd=s;xg.prototype.Ye.call(this)};v.tg=function(a,b){this.anchor==a&&this.bc.contains(this.anchor)&&(this.Wd||!this.qk?(yg(this,s),this.ra||(this.anchor=a,this.Ud=b||Jg(this,0)||k,this.ra&&this.Va(),yg(this,p))):this.anchor=k);this.nb=k};
v.Yh=function(a){this.tc=k;a==this.anchor&&(this.qa==r||this.qa!=this.i()&&!this.bc.contains(this.qa))&&(!this.Mf||!this.Mf.qa)&&yg(this,s)};function Kg(a,b){var c=ne(a.lb);a.He.x=b.clientX+c.x;a.He.y=b.clientY+c.y}v.dg=function(a){var b=Lg(this,a.target);this.qa=b;Gg(this);b!=this.anchor&&(this.anchor=b,this.nb||(this.nb=ng(ua(this.tg,this,b,k),this.Hg)),Mg(this),Kg(this,a))};function Lg(a,b){try{for(;b&&!a.bc.contains(b);)b=b.parentNode;return b}catch(c){return r}}
v.cg=function(a){Kg(this,a);this.Wd=p};v.bg=function(a){this.qa=a=Lg(this,a.target);this.Wd=p;if(this.anchor!=a){this.anchor=a;var b=Jg(this,1);Gg(this);this.nb||(this.nb=ng(ua(this.tg,this,a,b),this.Hg));Mg(this)}};function Jg(a,b){if(0==b){var c=a.He.f();return new Ng(c)}return new Og(a.qa)}function Mg(a){if(a.anchor)for(var b,c=0;b=Eg[c];c++)le(b.i(),a.anchor)&&(b.Mf=a,a.Dg=b)}
v.Od=function(a){var b=Lg(this,a.target),c=Lg(this,a.relatedTarget);b!=c&&(b==this.qa&&(this.qa=r),Hg(this),this.Wd=s,this.ra&&(!a.relatedTarget||!le(this.i(),a.relatedTarget))?Ig(this):this.anchor=k)};v.fg=function(){var a=this.i();this.qa!=a&&(Gg(this),this.qa=a)};v.eg=function(a){var b=this.i();if(this.qa==b&&(!a.relatedTarget||!le(b,a.relatedTarget)))this.qa=r,Ig(this)};function Hg(a){a.nb&&(mg.clearTimeout(a.nb),a.nb=k)}
function Ig(a){if(2==(a.nb?a.ra?4:1:a.tc?3:a.ra?2:0))a.tc=ng(ua(a.Yh,a,a.anchor),a.Lh)}function Gg(a){a.tc&&(mg.clearTimeout(a.tc),a.tc=k)}v.O=function(){yg(this,s);Hg(this);this.detach();this.i()&&je(this.i());this.qa=r;delete this.lb;Cg.j.O.call(this)};function Ng(a,b){Ag.call(this,a,b)}G(Ng,Ag);Ng.prototype.Va=function(a,b,c){b=Kf(a);b=Nf(b);c=c?new Ff(c.top+10,c.right,c.bottom,c.left+10):new Ff(10,0,0,10);ug(this.Ge,a,4,c,b,9)&496&&ug(this.Ge,a,4,c,b,5)};function Og(a){wg.call(this,a,3)}
G(Og,wg);Og.prototype.Va=function(a,b,c){var d=new Yc(10,0);tg(this.element,this.Rf,a,b,d,c,9)&496&&tg(this.element,2,a,1,d,c,5)};function Pg(a,b,c,d){a==r&&j(Error("No valid parent element."));(!D(b)||!D(c))&&j(Error("Invalid coordinates."));(d==r||!(d instanceof Y))&&j(Error("Invalid interactor."));Cg.call(this);this.c="caption";this.oa=a;this.Bd=b;this.Cd=c;this.Ob=d;this.jb=r;this.Kb=[];a=".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n";a+="  border: 1px solid infotext;\n";a+="  padding: 1px;\n";a+="  font-family: sans-serif;\n";a+="}";this.Kb=[a];wc(d,Gd,this.Pd.bind(this));this.Pe()}G(Pg,Cg);
Pg.prototype.Pe=function(){if("static"==this.oa.style.position||""==this.oa.style.position)this.oa.style.position="relative";var a=document.getElementsByTagName("head")[0],b=he("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Kb[0]);a.appendChild(b);b.appendChild(c);this.jb=b;this.Ud=new Ag(this.Bd,this.Cd)||k;this.ra&&this.Va();yg(this,p);Dg(this,this.oa);this.i().classList.add("x-tooltip")};
Pg.prototype.Pd=function(){yg(this,s);this.jb&&je(this.jb);this.i()&&je(this.i());this.jb=r};function Qg(){og.call(this);this.c="renderer3D";this.Ic=this.Lc=this.Hc=this.Kc=this.Gc=this.Jc=this.qe=this.re=r;this.l=[0,0,0];this.Ff=r;this.ae=new Tb;this.Oc=new Tb;this.Rc=new Tb;this.me=new Tb;this.ld=new Tb;this.vd=new Tb;this.wd=new Tb;this.xd=new Tb;this.G={PROGRESSBAR_ENABLED:p,PICKING_ENABLED:p,ORDERING_ENABLED:p,STATISTICS_ENABLED:s,INTERMEDIATE_RENDERING:s}}G(Qg,og);Qg.prototype.__defineGetter__("config",t("G"));v=Qg.prototype;
v.Oi=function(){this.Ic=this.Lc=this.Hc=this.Kc=this.Gc=this.Jc=r;this.l=[0,0,0]};v.Ze=function(a){Qg.j.Ze.call(this,a);var b=a.Bd;a=a.Cd;var c=this.Eg(b,a);if(c=this.get(c))if(c=c.kc)(new Pg(this.s,this.s.offsetLeft+b+10,this.s.offsetTop+a+10,this.Ob)).i().innerHTML=c};
v.ia=function(){Qg.j.ia.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.M,this.H),this.a.clearColor(0,0,0,0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.G.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();this.a.bindTexture(this.a.TEXTURE_2D,
c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.M,this.H,0,this.a.RGB,this.a.UNSIGNED_BYTE,r);this.a.bindFramebuffer(this.a.FRAMEBUFFER,a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.M,this.H);this.a.bindRenderbuffer(this.a.RENDERBUFFER,r);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,
b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,r);this.Ff=a}}catch(d){j(Error("Exception while accessing GL Context!\n"+d))}a=new pg;(this.ka==r||this.a==r||this.r==r)&&j(Error("Renderer was not initialized properly."));(a==r||!(a instanceof pg))&&j(Error("Could not add shaders."));b=Object.keys(rg);Object.keys(qg).every(function(a){a=qg[a];return-1!=this.zd.search(a)||-1!=this.nd.search(a)}.bind(a))||j(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=rg[a];return-1!=
this.zd.search(a)||-1!=this.nd.search(a)}.bind(a))||j(Error("Could not find all uniforms in the shader sources."));b=this.a.createShader(this.a.FRAGMENT_SHADER);c=this.a.createShader(this.a.VERTEX_SHADER);this.a.shaderSource(b,a.nd);this.a.shaderSource(c,a.zd);this.a.compileShader(b);this.a.compileShader(c);this.a.getShaderParameter(b,this.a.COMPILE_STATUS)||j(Error("Fragement Shader compilation failed!\n"+this.a.getShaderInfoLog(b)));this.a.getShaderParameter(c,this.a.COMPILE_STATUS)||j(Error("Vertex Shader compilation failed!\n"+
this.a.getShaderInfoLog(c)));var e=this.a.createProgram();this.a.attachShader(e,c);this.a.attachShader(e,b);this.a.linkProgram(e);this.a.getProgramParameter(e,this.a.LINK_STATUS)||j(Error("Could not create shader program!\n"+this.a.getShaderInfoLog(b)+"\n"+this.a.getShaderInfoLog(c)+"\n"+this.a.getProgramInfoLog(e)));this.a.useProgram(e);this.qe=e;Object.keys(qg).forEach(function(a){a=qg[a];this.ae.set(a,this.a.getAttribLocation(this.qe,a));this.a.enableVertexAttribArray(this.ae.get(a))}.bind(this));
Object.keys(rg).forEach(function(a){a=rg[a];this.Oc.set(a,this.a.getUniformLocation(this.qe,a))}.bind(this));this.re=a};
v.eb=function(a){Qg.j.eb.call(this,a);var b=s;this.get(a.ua)&&(b=p);var c=a.ua,d=a.g,e=a.h,f=a.Z,g=a.w,h=a.p,m=a.$b,l=a.ca,n=a.n,q=a.t;if(n!=r&&n.p!=r&&n.p.e)this.eb(n);else if(n!=r&&n.e&&this.eb(n),l!=r&&l.p!=r&&l.p.e)this.B.load(l,a);else if(g!=r&&g.p!=r&&g.p.e)this.B.load(g,a);else{if(h!=r&&A(h))if(a.ic!=r){if(a.ic.Qd!=h.length||!a.e)return}else{b=0;c=h.length;for(b=0;b<c;b++)this.B.load(h[b],a);return}else{if(h!=r&&h.e){this.B.load(a,a);return}if(q!=r&&q.p!=r&&q.p.e){this.B.load(q,a);return}}if(0<
a.d.length){h=a.d;l=h.length;for(n=n=0;n<l;n++)this.eb(h[n])}if(d){for(h=0;this.rd;)h++,window.console.log("Possible thread lock avoided: "+h);this.rd=p;l=a instanceof se&&a.kb instanceof ue;b&&(g!=r&&g.e)&&(h=this.wd.get(c),h!=r&&this.a.isBuffer(h.la)&&this.a.deleteBuffer(h.la));h=r;g!=r&&(!b||g.e?(h=a.Zb,h==r&&j(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),n=s,g.xa&&(n=p),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,n),n=this.a.createTexture(),
n.Oh=g.qb,this.xd.set(g.ua,n),this.a.bindTexture(this.a.TEXTURE_2D,n),g.xa?this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,g.Eb,g.Db,0,this.a.RGBA,this.a.UNSIGNED_BYTE,g.xa):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,n.Oh),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE),l?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),
this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,r),n=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,n),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),this.a.STATIC_DRAW),h=new sg(n,h.length,2),g.e=s):h=this.wd.get(c));qf(this.B,0.1);if(l)this.rd=
s,I.Fa(this.c+".update"),qf(this.B,0.9);else{if(!b||d.e||m.e){l=m.C;g=l.Ua(new N(d.Sb,d.Tb,d.Ub));l=l.Ua(new N(d.Pb,d.Qb,d.Rb));if(this.Jc===r||g.x<this.Jc)this.Jc=g.x;if(this.Gc===r||l.x>this.Gc)this.Gc=l.x;if(this.Kc===r||g.y<this.Kc)this.Kc=g.y;if(this.Hc===r||l.y>this.Hc)this.Hc=l.y;if(this.Lc===r||g.b<this.Lc)this.Lc=g.b;if(this.Ic===r||l.b>this.Ic)this.Ic=l.b;this.l=[(this.Jc+this.Gc)/2,(this.Kc+this.Hc)/2,(this.Lc+this.Ic)/2];m.e=s}b&&d.e&&(m=this.Rc.get(c),m!=r&&this.a.isBuffer(m.la)&&this.a.deleteBuffer(m.la));
m=r;!b||d.e?(m=this.a.createBuffer(),d.mb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,m),this.a.bufferData(this.a.ARRAY_BUFFER,d.L,this.a.STATIC_DRAW),m=new sg(m,d.count,3),d.e=s):m=this.Rc.get(c);qf(this.B,0.3);b&&e.e&&(g=this.Rc.get(c),g!=r&&this.a.isBuffer(g.la)&&this.a.deleteBuffer(g.la));g=r;!b||e.e?(g=this.a.createBuffer(),e.mb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,e.L,this.a.STATIC_DRAW),g=new sg(g,e.count,3),e.e=s):g=this.me.get(c);qf(this.B,0.3);b&&
(f&&f.e)&&(e=this.ld.get(c),e!=r&&this.a.isBuffer(e.la)&&this.a.deleteBuffer(e.la));e=r;f&&(!b||f.e?(f.length!=d.length&&j(Error("Mismatch between points and point colors.")),e=this.a.createBuffer(),f.mb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,f.L,this.a.STATIC_DRAW),e=new sg(e,f.count,3),f.e=s):e=this.ld.get(c));qf(this.B,0.2);b&&(q&&q.e)&&(f=this.vd.get(c),f!=r&&this.a.isBuffer(f.la)&&this.a.deleteBuffer(f.la));f=r;q&&(f=q.Ac,!b||q.e?(f.length!=d.length&&
j(Error("Mismatch between points and scalars.")),d=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),this.a.bufferData(this.a.ARRAY_BUFFER,f,this.a.STATIC_DRAW),f=new sg(d,f.length,3),q.e=s):f=this.vd.get(c));qf(this.B,0.1);b||this.hb.add(a);this.Rc.set(c,m);this.me.set(c,g);this.ld.set(c,e);this.wd.set(c,h);this.vd.set(c,f);this.rd=a.e=s}}else a.e=s}};function Rg(a,b){var c=b.g.kd,c=b.$b.C.Ua(new N(c[0],c[1],c[2])),c=a.r.m.Ua(c),c=Vc(a.r.wa,c);return Math.round(1E3*c)/1E3}
v.Eg=function(a,b){if(this.G.PICKING_ENABLED){this.Hb(p,s);var c=new Uint8Array(4);this.a.readPixels(a,this.H-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
v.Hb=function(a,b){Qg.j.Hb.call(this,a,b);var c=this.hb.u,d=c.length;if(0!=d){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.Ff):this.a.bindFramebuffer(this.a.FRAMEBUFFER,r);this.a.viewport(0,0,this.M,this.H);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var e=this.r.Ef,f=this.r.Nb;this.a.uniformMatrix4fv(this.Oc.get("perspective"),s,e);this.a.uniformMatrix4fv(this.Oc.get("view"),s,f);e=this.l;this.a.uniform3f(this.Oc.get("center"),parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));
f=this.$a.length;for(e=0;e<f;++e){var g=this.$a[e];if(g instanceof M){var h=new N(1,0,0),h=this.r.m.Ua(h),m=Vc(this.r.wa,h),h=new N(-1,0,0),h=this.r.m.Ua(h),l=Vc(this.r.wa,h),h=new N(0,1,0),h=this.r.m.Ua(h),n=Vc(this.r.wa,h),h=new N(0,-1,0),h=this.r.m.Ua(h),q=Vc(this.r.wa,h),h=new N(0,0,1),h=this.r.m.Ua(h),w=Vc(this.r.wa,h),h=new N(0,0,-1),h=this.r.m.Ua(h),h=Vc(this.r.wa,h),u=Math.max(m,n,w,l,q,h);u==m||u==l?te(g,0):u==n||u==q?te(g,1):(u==w||u==h)&&te(g,2)}}if(this.G.ORDERING_ENABLED){m=s;f=this.$a;
g=f.length-1;do if(e=f[g],e instanceof M&&e.Pa){l=e.Gb;m=e.S.d;1==l?m=e.T.d:2==l&&(m=e.ib.d);l=m.length;n=m[0];n.K=Rg(this,n);n.$=e.$;q=m[l-1];q.K=Rg(this,q);q.$=e.$;q=Math.round(1E3*((q.K-n.K)/l))/1E3;for(w=w=1;w<l-1;w++)h=Math.round(1E3*(n.K+w*q))/1E3,m[w].K=h,m[w].$=e.$;m=p}while(g--);f=this.hb.u;g=f.length-1;do if(e=f[g],e.Oa&&!(1==e.$||e instanceof se))e.K=Rg(this,e),m=p;while(g--);m&&this.hb.sort()}if(f=!a&&b!=r&&b&&this.G.STATISTICS_ENABLED)var x=0,z=0,C=0,F=0;var e=this.ae,g=e.get("vertexPosition"),
m=e.get("vertexNormal"),l=e.get("vertexColor"),n=e.get("vertexTexturePos"),q=e.get("vertexScalar"),e=this.Oc,w=e.get("usePicking"),h=e.get("useObjectColor"),u=e.get("objectColor"),y=e.get("useScalars"),B=e.get("scalarsReplaceMode"),H=e.get("scalarsMin"),O=e.get("scalarsMax"),ba=e.get("scalarsMinColor"),Q=e.get("scalarsMaxColor"),R=e.get("scalarsInterpolation"),ga=e.get("scalarsMinThreshold"),da=e.get("scalarsMaxThreshold"),ca=e.get("objectOpacity"),Ua=e.get("labelmapOpacity"),mb=e.get("useTexture"),
na=e.get("useLabelMapTexture"),Wg=e.get("textureSampler"),Xg=e.get("textureSampler2"),Yg=e.get("volumeLowerThreshold"),Zg=e.get("volumeUpperThreshold"),$g=e.get("volumeScalarMin"),ah=e.get("volumeScalarMax"),bh=e.get("volumeWindowLow"),ch=e.get("volumeWindowHigh"),dh=e.get("volumeScalarMinColor"),eh=e.get("volumeScalarMaxColor"),eg=e.get("volumeTexture"),fh=e.get("objectTransform"),gh=e.get("pointSize"),e=d;do{var S=c[d-e];if(S){var V=r;S instanceof se&&S.kb&&(V=S.kb);if(S.Oa&&(!V||V.Oa)){var va=
S.ua,Wa=S.Fc,Ea=this.Rc.get(va),fb=this.me.get(va),Ge=this.ld.get(va),Vb=this.vd.get(va),He=this.wd.get(va);this.a.bindBuffer(this.a.ARRAY_BUFFER,Ea.la);this.a.vertexAttribPointer(g,Ea.vb,this.a.FLOAT,s,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,fb.la);this.a.vertexAttribPointer(m,fb.vb,this.a.FLOAT,s,0,0);a?this.a.uniform1i(w,p):this.a.uniform1i(w,s);Ge&&!a&&!Wa?(this.a.uniform1i(h,s),this.a.bindBuffer(this.a.ARRAY_BUFFER,Ge.la),this.a.vertexAttribPointer(l,Ge.vb,this.a.FLOAT,s,0,0)):(fb=1,Wa&&!a&&
(fb=0),this.a.uniform1i(h,fb),fb=S.Jb,a&&(fb=[Math.floor(va%65025%255)/255,Math.floor(va%65025/255)/255,Math.floor(va/65025)/255]),this.a.uniform3f(u,parseFloat(fb[0]),parseFloat(fb[1]),parseFloat(fb[2])),this.a.vertexAttribPointer(l,Ea.vb,this.a.FLOAT,s,0,0));Vb&&!a&&!Wa?(this.a.uniform1i(y,p),this.a.uniform1i(B,S.t.Hf),va=S.t.zb,Wa=S.t.xb,this.a.uniform3f(ba,parseFloat(va[0]),parseFloat(va[1]),parseFloat(va[2])),this.a.uniform3f(Q,parseFloat(Wa[0]),parseFloat(Wa[1]),parseFloat(Wa[2])),this.a.uniform1f(ga,
parseFloat(S.t.R)),this.a.uniform1f(da,parseFloat(S.t.U)),this.a.uniform1f(H,parseFloat(S.t.Na)),this.a.uniform1f(O,parseFloat(S.t.Ga)),this.a.uniform1i(R,parseInt(S.t.de,10)),this.a.bindBuffer(this.a.ARRAY_BUFFER,Vb.la),this.a.vertexAttribPointer(q,Vb.vb,this.a.FLOAT,s,0,0)):(this.a.uniform1i(y,s),this.a.vertexAttribPointer(q,Ea.vb,this.a.FLOAT,s,0,0));this.a.uniform1f(ca,parseFloat(S.$));S.w&&He&&!a?(this.a.uniform1i(mb,p),this.a.activeTexture(this.a.TEXTURE0),this.a.bindTexture(this.a.TEXTURE_2D,
this.xd.get(S.w.ua)),this.a.uniform1i(Wg,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,He.la),this.a.vertexAttribPointer(n,He.vb,this.a.FLOAT,s,0,0),this.a.uniform1i(eg,s)):(this.a.uniform1i(mb,s),this.a.vertexAttribPointer(n,Ea.vb,this.a.FLOAT,s,0,0));V&&(this.a.uniform1i(eg,p),this.a.uniform1f(Yg,V.R),this.a.uniform1f(Zg,V.U),this.a.uniform1f($g,V.Na),this.a.uniform1f(ah,V.Ga),va=V.zb,Wa=V.xb,this.a.uniform3f(dh,parseFloat(va[0]),parseFloat(va[1]),parseFloat(va[2])),this.a.uniform3f(eh,parseFloat(Wa[0]),
parseFloat(Wa[1]),parseFloat(Wa[2])),this.a.uniform1f(bh,V.W),this.a.uniform1f(ch,V.V),Vb=V.n,this.a.uniform1i(na,s),V.Pa?this.a.uniform1f(ca,parseFloat(V.$)):Vb&&Vb.Oa&&(V=S.n.ua,this.a.uniform1i(na,p),this.a.activeTexture(this.a.TEXTURE1),this.a.bindTexture(this.a.TEXTURE_2D,this.xd.get(V)),this.a.uniform1i(Xg,1),this.a.uniform1f(Ua,Vb.$)));this.a.uniformMatrix4fv(fh,s,S.$b.wf);V=1;"POINTS"==S.ma&&(V=S.Mc);this.a.uniform1f(gh,V);V=-1;S.ma==od?(V=this.a.TRIANGLES,f&&(z+=Ea.ub/3)):"LINES"==S.ma?(this.a.lineWidth(S.oc),
V=this.a.LINES,f&&(C+=Ea.ub/2)):"POINTS"==S.ma?(V=this.a.POINTS,f&&(F+=Ea.ub)):"TRIANGLE_STRIPS"==S.ma?(V=this.a.TRIANGLE_STRIP,f&&(z+=Ea.ub/3)):"POLYGONS"==S.ma&&(V=0==Ea.ub%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(z+=Ea.ub/3));f&&(x+=Ea.ub);this.a.drawArrays(V,0,Ea.ub)}}}while(--e);f&&(c="Objects: "+d+" | "+("Vertices: "+x+" | "),c+="Triangles: "+Math.round(z)+" | ",c+="Lines: "+C+" | ",c+="Points: "+F+" | ",c+="Textures: "+this.xd.ab(),window.console.log(c))}};
v.Gd=function(){this.re=r;delete this.re;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);Qg.j.Gd.call(this)};E("X.renderer3D",Qg);E("X.renderer3D.prototype.init",Qg.prototype.ia);E("X.renderer3D.prototype.add",Qg.prototype.add);E("X.renderer3D.prototype.onShowtime",Qg.prototype.Ag);E("X.renderer3D.prototype.onRender",Qg.prototype.yg);E("X.renderer3D.prototype.get",Qg.prototype.get);E("X.renderer3D.prototype.render",Qg.prototype.hc);E("X.renderer3D.prototype.destroy",Qg.prototype.Gd);
E("X.renderer3D.prototype.resetBoundingBox",Qg.prototype.Oi);E("X.renderer3D.prototype.resetViewAndRender",Qg.prototype.xc);E("X.renderer3D.prototype.pick",Qg.prototype.Eg);function Z(){og.call(this);this.c="renderer2D";this.xf=this.ee=this.uf=this.ce=this.Ab=r;this.ud=this.Wb=this.Xb=this.se=this.te=0;this.V=this.W=this.U=this.R=this.sf=-1}G(Z,og);Z.prototype.ri=aa();Z.prototype.Ai=aa();Z.prototype.$e=function(a){Z.j.$e.call(this,a);var b=this.$a[0];if(b){var c=this.Ab;b["index"+c]=a.J?b["index"+c]+1:b["index"+c]-1;eval("this.onScroll();")}};
Z.prototype.Bi=function(a){var b=this.$a[0];if(b){var c=b.V-b.W,d=c/2,e=parseInt(c+c/15*-a.we,10);a=parseInt(d+d/15*a.je,10);c==e&&e++;d==a&&a++;b.W-=parseInt(d-a,10);b.W-=parseInt(c-e,10);b.W=Math.max(b.W,b.Na);b.V-=parseInt(d-a,10);b.V+=parseInt(c-e,10);b.V=Math.min(b.V,b.Ga);eval("this.onWindowLevel();")}};Z.prototype.__defineGetter__("orientation",t("Ab"));
Z.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase();"X"!=a&&("Y"!=a&&"Z"!=a)&&j(Error("Invalid orientation."));this.Ab=a});v=Z.prototype;v.ia=function(){this.Ab||j(Error("No 2D orientation set."));Z.j.ia.call(this,"2d");this.a.fillStyle="rgba(0,0,0,0)";this.a.fillRect(0,0,this.ka.width,this.ka.height);this.ce=he("canvas");this.ee=he("canvas");K(this.r,Cd,this.Bi.bind(this))};v.rotate=function(){this.ud++};v.Qi=function(){this.ud--};
v.xc=function(){Z.j.xc.call(this);Tg(this);var a=this.$a[0];a&&(a.V=a.Ga,a.W=a.Na)};
v.eb=function(a){Z.j.eb.call(this,a);var b=s;this.get(a.ua)&&(b=p);if(a instanceof M){var c=a.p,d=a.n,e=a.ca;if(d!=r&&d.p!=r&&d.p.e)this.eb(d);else if(e!=r&&e.p!=r&&e.p.e)this.B.load(e,a);else{if(c!=r&&A(c))if(a.ic!=r){if(a.ic.Qd!=c.length||b&&!a.e)return}else{b=0;d=c.length;for(b=0;b<d;b++)this.B.load(c[b],a);return}else if(c!=r&&c.e){this.B.load(a,a);return}var d=c=0,e=a.ea,f=a.I;"X"==this.Ab?(this.Yb=a.S.d,c=e[1],d=e[2],this.Xb=f[1],this.Wb=f[2]):"Y"==this.Ab?(this.Yb=a.T.d,c=e[0],d=e[2],this.Xb=
f[0],this.Wb=f[2]):"Z"==this.Ab&&(this.Yb=a.ib.d,c=e[0],d=e[1],this.Xb=f[0],this.Wb=f[1]);this.te=c;this.se=d;e=this.ce;e.width=c;e.height=d;f=this.ee;f.width=c;f.height=d;this.uf=e.getContext("2d");this.xf=f.getContext("2d");b||(this.hb.add(a),Tg(this))}}};function Tg(a){var b=Math.min(a.M/(a.te*a.Xb),a.H/(a.se*a.Wb));a.r.m.k(2,3,b)}
v.Hb=function(a,b){Z.j.Hb.call(this,a,b);if(0!=this.hb.u.length){var c=this.M,d=this.H,e=this.r.m;this.a.save();this.a.clearRect(-c,-d,2*c,2*d);this.a.restore();var f=1*e.Y(0,3),g=-1*e.Y(1,3),h=Math.max(e.Y(2,3),0.6);this.a.setTransform(h,0,0,h,f,g);var e=this.$a[0],m=e["index"+this.Ab],l=this.Yb[parseInt(m,10)],n=l.w.xa,l=l.n,q=r;l&&(q=l.xa);var w=this.te,u=this.se,x=this.uf,z=this.xf,C=x.getImageData(0,0,w,u),F=z.getImageData(0,0,w,u),y=C.data,B=F.data,H=y.length,O=e.Ga,ba=e.R,Q=e.U,R=e.W/O,ga=
e.V/O;if(this.sf!=m||this.R!=ba||this.U!=Q||this.W!=R||this.V!=ga){var da=0;do{var ca=[0,0,0,0],Ua=[0,0,0,0],mb=n[da]/255*O,na=n[da],na=(na/255-R)/(ga-R),na=255*na;mb>=ba&&mb<=Q&&(ca=new N(e.zb[0],e.zb[1],e.zb[2]),ca=(new N(e.xb[0],e.xb[1],e.xb[2])).scale(na).add(ca.scale(255-na)),ca=[Math.floor(ca.x),Math.floor(ca.y),Math.floor(ca.b),255],l&&(Ua=[q[da],q[da+1],q[da+2],q[da+3]]));na=H-1-da;y[na-3]=ca[0];y[na-2]=ca[1];y[na-1]=ca[2];y[na]=ca[3];B[na-3]=Ua[0];B[na-2]=Ua[1];B[na-1]=Ua[2];B[na]=Ua[3];
da+=4}while(da<H);x.putImageData(C,0,0);z.putImageData(F,0,0);this.sf=m;this.R=ba;this.U=Q;this.W=R;this.V=ga}this.a.globalAlpha=1;this.a.translate(c/2/h,d/2/h);this.a.rotate(0.5*Math.PI*this.ud);switch(this.ud%4){case 1:c=f;f=g;g=-c;break;case 2:f*=-1;g*=-1;break;case 3:c=f,f=-g,g=c}f=-w*this.Xb/2+f;g=-u*this.Wb/2+g;this.a.drawImage(this.ce,f,g,w*this.Xb,u*this.Wb);l&&e.n.Oa&&(this.a.globalAlpha=e.n.$,this.a.drawImage(this.ee,f,g,w*this.Xb,u*this.Wb))}};E("X.renderer2D",Z);
E("X.renderer2D.prototype.init",Z.prototype.ia);E("X.renderer2D.prototype.add",Z.prototype.add);E("X.renderer2D.prototype.onShowtime",Z.prototype.Ag);E("X.renderer2D.prototype.onRender",Z.prototype.yg);E("X.renderer2D.prototype.onScroll",Z.prototype.ri);E("X.renderer2D.prototype.onWindowLevel",Z.prototype.Ai);E("X.renderer2D.prototype.get",Z.prototype.get);E("X.renderer2D.prototype.rotate",Z.prototype.rotate);E("X.renderer2D.prototype.rotateCounter",Z.prototype.Qi);
E("X.renderer2D.prototype.resetViewAndRender",Z.prototype.xc);E("X.renderer2D.prototype.render",Z.prototype.hc);E("X.renderer2D.prototype.destroy",Z.prototype.Gd);function Ug(){T.call(this);this.c="fibers";Ha(this,new Sc)}G(Ug,T);E("X.fibers",Ug);function Vg(){T.call(this);this.c="mesh";Ha(this,new Sc)}G(Vg,T);E("X.mesh",Vg);
